<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>Moo</title>
        <!-- Font Awesome icons (free version)-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" crossorigin="anonymous"></script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet">
        <!-- Fonts CSS-->
        <link rel="stylesheet" href="css/heading.css">
        <link rel="stylesheet" href="css/body.css">
        <link rel="icon" href="assets/gwclogo.png">
    </head>
    <body id="page-top">
        <nav class="navbar navbar-expand-lg bg-secondary fixed-top" id="mainNav">
            <div class="container"><a class="navbar-brand js-scroll-trigger" href="#page-top">Moo</a>
                <button class="navbar-toggler navbar-toggler-right font-weight-bold text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">Menu <i class="fas fa-bars"></i></button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="#lessons">Notes</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <header class="masthead bg-primary text-white text-center">
            <div class="container d-flex align-items-center flex-column">
                <!-- Masthead Heading-->
                <h1 class="masthead-heading mb-0">Moo</h1>
                <!-- Icon Divider-->
                <div class="divider-custom">
                    <div class="divider-custom-line"></div>
                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                    <div class="divider-custom-line"></div>
                </div>
            </div>
        </header>

     
<!-- FOOTER -->

        <footer class="footer text-center">
            <div class="container">
                <div class="row">
                    <!-- Footer Location-->
                    <div class="col-lg-4 mb-5 mb-lg-0">
                        <h4 class="mb-4"></h4>
                        <p class="pre-wrap lead mb-0"></p>
                    </div>
                    <!-- Footer About Text-->
                    <div class="col-lg-4">
                        <h4 class="mb-4"></h4>
                        <p class="pre-wrap lead mb-0"></p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes)-->
        <div class="scroll-to-top d-lg-none position-fixed"><a class="js-scroll-trigger d-block text-center text-white rounded" href="#page-top"><i class="fa fa-chevron-up"></i></a></div>
        <!-- Bootstrap core JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
        <!-- Third party plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
        <!-- Contact form JS-->
        <script src="assets/mail/jqBootstrapValidation.js"></script>
        <script src="assets/mail/contact_me.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>


</body>
</html lang="en">











!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Study Guide</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="d9438285-9d65-4e92-8147-77f38b83b894" class="page sans"><header><img class="page-cover-image" src="https://images.unsplash.com/photo-1573767291321-c0af2eaf5266?ixlib=rb-4.0.3&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb" style="object-position:center 100%"/><h1 class="page-title">Study Guide</h1></header><div class="page-body"><h3 id="06e806b1-96b2-4adc-bbb4-2ffee634d7fc" class="block-color-purple_background">Introductory Research</h3><p id="31ec33b9-3c97-4ca8-bb97-7f64dbe5aed3" class="">To exploit specific software, use <a href="https://www.exploit-db.com/">ExploitDB, </a><a href="https://nvd.nist.gov/vuln/search">NVD, </a><a href="https://cve.mitre.org/">CVE Mitre</a>. (<strong>C</strong>ommon <strong>V</strong>ulnerabilities and <strong>E</strong>xposures) <mark class="highlight-pink"><code>CVE-YEAR-NUMBER</code></mark></p><h3 id="609aa9ff-c6bf-4491-9170-ca3646e429c1" class="block-color-purple_background"><strong>Linux Fundamentals Part 1</strong></h3><div id="7a126144-582d-43b4-9fed-a4bfcba1bbaa" class="column-list"><div id="d897b1da-2a9c-4dc7-872a-e7df3d160631" style="width:81.25%" class="column"><p id="50e8cbc7-b0d0-484b-a358-70be0f238358" class=""><strong>Where is Linux Used?</strong></p><p id="b6193974-84d6-491e-bce9-8b7f5a3418c0" class="">Linux is more lightweight than other Operating Systems; it <strong>powers:</strong> websites, car entertainment/control panels, Point of Sale (PoS) systems: checkout tills and registers, infrastructures: traffic light controllers/industrial sensors. Often there is no <strong>GUI</strong> (Graphical User Interface) - a desktop environment to interact with the machine. &quot;Linux&quot; is an <strong>umbrella term </strong>for multiple OS&#x27;s based on the OS UNIX. <em>Ubuntu Server can run on systems with only 512MB of RAM</em></p></div><div id="79c70397-5f7b-4fd9-8cb9-40503b41a77f" style="width:93.74999999999999%" class="column"><table id="979c4233-9719-41d7-b250-684ceacb407a" class="simple-table"><tbody><tr id="fca62dbe-659e-49ec-a429-69cd84a90130"><td id="{UCl" class="block-color-pink" style="width:82px"><strong>Operator</strong></td><td id="yn[C" class="block-color-pink" style="width:403px"><strong>Description</strong></td></tr><tr id="f95b70e6-d9f5-4db6-b4c8-c155aa8f132f"><td id="{UCl" class="" style="width:82px">&amp;</td><td id="yn[C" class="" style="width:403px">Runs commands in the background of your terminal</td></tr><tr id="ee7b2850-536e-42ec-8309-61cb8ef0c21b"><td id="{UCl" class="" style="width:82px">&amp;&amp;</td><td id="yn[C" class="" style="width:403px">Combines multiple commands in one line, only if firsts work</td></tr><tr id="1bdcfec6-a727-40cf-b7a3-c7a542992e84"><td id="{UCl" class="" style="width:82px">&gt;</td><td id="yn[C" class="" style="width:403px">Output redirector; directs output from command elsewhere</td></tr><tr id="f7cedad4-37f1-4b1c-86d6-5a90443234d2"><td id="{UCl" class="" style="width:82px">&gt;&gt;</td><td id="yn[C" class="" style="width:403px">Same as <mark class="highlight-pink"><code>&gt;</code></mark>  but appends output no replacing/overwriting</td></tr></tbody></table></div></div><h3 id="1bae73b3-6219-4faa-827b-5dc4fdcda1e0" class="block-color-purple_background"><strong>Linux Fundamentals Part 2</strong></h3><div id="9e4e5e42-5e7f-4215-adb6-57944d2bf3d8" class="column-list"><div id="cf106b4e-09f6-4643-8ac3-f66d74e73c28" style="width:31.25%" class="column"><table id="25228a70-b484-4b4a-a161-06cbc22d45f1" class="simple-table"><tbody><tr id="bde7c9dd-17f6-46ee-b4d3-7745c8b5cb91"><td id="dRDD" class="" style="width:94px"><strong><mark class="highlight-pink">Command</mark></strong></td><td id="`ZE:" class="" style="width:163px"><strong><mark class="highlight-pink">Purpose</mark></strong></td></tr><tr id="64e67552-8d34-424a-87b2-b48b8dd757e6"><td id="dRDD" class="" style="width:94px">touch</td><td id="`ZE:" class="" style="width:163px">Create file</td></tr><tr id="7dc0333c-5dc0-453b-9da5-d5846f6890d6"><td id="dRDD" class="" style="width:94px">mkdir</td><td id="`ZE:" class="" style="width:163px">Create folder</td></tr><tr id="da8b5366-9dbe-4512-8d48-c433cbacbc25"><td id="dRDD" class="" style="width:94px">cp</td><td id="`ZE:" class="" style="width:163px">Copy file or folder</td></tr><tr id="cab5700d-876b-41c2-a8c7-270e846baa2f"><td id="dRDD" class="" style="width:94px">mv</td><td id="`ZE:" class="" style="width:163px">Move file or folder</td></tr><tr id="cf7cebe2-7b4f-40e8-a7ae-ba6cb682fdfa"><td id="dRDD" class="" style="width:94px">rm</td><td id="`ZE:" class="" style="width:163px">Remove file, -r folder</td></tr><tr id="a5f1fc2e-7e5d-4a03-bec0-ac977442eeb0"><td id="dRDD" class="" style="width:94px">file</td><td id="`ZE:" class="" style="width:163px">Determine file type</td></tr></tbody></table></div><div id="a2784393-596a-411a-a729-271eebdb4e3f" style="width:68.75%" class="column"><p id="cf968cf4-dbf6-4f8f-93ae-d96fa72465f9" class=""><strong>Common Directories</strong></p><p id="07468fc7-658d-489d-9446-d2c815ac9e91" class=""><span style="border-bottom:0.05em solid"><strong>/etc - </strong></span>of the most important root dirs on system; common location to store system files used by the OS <mark class="highlight-pink"><code>lsshadow passwd sudoers sudoers.d</code></mark></p><p id="ea2a8c9a-16db-43ac-b104-9e97a5f0e7fe" class=""><span style="border-bottom:0.05em solid"><strong>/var - </strong></span>variable data; one main root folders on Linux install; stores data frequently accessed/written by services/applications systems; run <mark class="highlight-pink"><code>ls backups log opt tmp</code></mark></p><p id="110cb41b-82d2-4802-81a2-b2bbcaeb8c70" class="">/<span style="border-bottom:0.05em solid"><strong>root -</strong></span> home &quot;root&quot; system user; the logical presumption is the user would have data in a default directory like &quot;<strong>/home/root</strong>&quot; <mark class="highlight-pink"><code>ls myfile myfolder passwords.xlsx</code></mark></p><p id="8840d0be-b860-4823-9526-396592276526" class=""><span style="border-bottom:0.05em solid"><strong>/tmp - </strong></span>temporary; unique root directory on Linux; volatile and used to store data that only needs to be accessed once or twice  <mark class="highlight-pink"><code>lstodelete trash.txt rubbish.bin</code></mark></p></div></div><h3 id="72d53b5d-84df-4b88-af40-205ffba042c4" class="block-color-purple_background"><strong>Linux Fundamentals Part 3</strong></h3><p id="91afa17f-9381-46b5-845a-2ef6ceff1176" class=""><strong>Terminal Text Editors</strong><div class="indented"><p id="4bb11ef1-b904-48c4-b616-25a2b2e3fcb0" class=""><span style="border-bottom:0.05em solid">Nano</span><span style="border-bottom:0.05em solid"><strong> </strong></span><mark class="highlight-pink"><code>nano filename</code></mark> create and edit a file; Press the &quot;<strong>Ctrl</strong>&quot; key (<mark class="highlight-pink"><code>^</code></mark>)  and corresponding letter for commands</p><p id="0d2c2c35-4f31-4ba1-aee5-ad3bbbb11a75" class=""><span style="border-bottom:0.05em solid">VIM</span><span style="border-bottom:0.05em solid"><strong> - </strong></span>more advanced text editor; Syntax Highlighting for writing or maintaining code, popular for software devs </p></div></p><ul id="36a62536-2d3e-46ac-85ac-50b57f4983c8" class="toggle"><li><details open=""><summary><strong>General/Useful Utilities</strong></summary><p id="1051e44c-ed5e-48c1-bfc8-63e30e38b1c3" class="">Serving Files From Your Host - WEB:<strong> </strong>Ubuntu machines are pre-packaged with python3. Python module called &quot;HTTPServer” - turns your computer into a web server that can serve your files and then download another computing. Run <mark class="highlight-pink"><code>python3 -m  http.server</code></mark> </p><p id="b8025512-6de9-434e-a987-1c76ad922e75" class="">Downloading Files: <code><mark class="highlight-pink">wget link</mark></code> - download files from the web via HTTP</p><p id="efcb1424-a916-4adc-9a4e-e8605979e426" class="">Transferring Files From Your Host - SCP (SSH): Secure copy securely copies files with SSH protocol that provides authentication and encryption using the SOURCE and DESTINATION model to copy files &amp; directories from current system &lt;—&gt; remote system, given usernames/passwords for both users</p><div id="39611fdf-4e7d-4f49-8aa1-08a03593dcd7" class="column-list"><div id="bb0a31f9-d437-4a43-b964-b0a9f04d9d22" style="width:50%" class="column"><table id="4ba9b6c2-c218-4e2a-8a0f-c78e62ddf8d5" class="simple-table"><tbody><tr id="035c265a-60ad-4534-9dcd-3f5872e6ecce"><td id="b?L{" class="" style="width:300.9921875px"><strong><mark class="highlight-pink">Variable</mark></strong></td><td id="ZOOv" class="" style="width:129.99288940429688px"><strong><mark class="highlight-pink">Value</mark></strong></td></tr><tr id="68d10850-611a-44c0-9776-9a0416128d72"><td id="b?L{" class="" style="width:300.9921875px">IP address of the remote system</td><td id="ZOOv" class="" style="width:129.99288940429688px">192.168.1.30</td></tr><tr id="d09cbbba-4c4f-4f4f-ba3c-dbe8cf4c417a"><td id="b?L{" class="" style="width:300.9921875px">User on the remote system</td><td id="ZOOv" class="" style="width:129.99288940429688px">ubuntu</td></tr><tr id="cadf565b-11e9-4cd2-bd3d-810ad30d9fde"><td id="b?L{" class="" style="width:300.9921875px">Name of file on local system</td><td id="ZOOv" class="" style="width:129.99288940429688px">important.txt</td></tr><tr id="ea726e15-415b-45c5-9c87-e32591732442"><td id="b?L{" class="" style="width:300.9921875px">Name to store the file as on remote system</td><td id="ZOOv" class="" style="width:129.99288940429688px">transferred.txt</td></tr></tbody></table><p id="cb015883-9030-435a-a578-08826ff849a4" class=""><mark class="highlight-pink"><code>scp important.txt ubuntu@192.168.1.30:/home/ubuntu/transferred.txt</code></mark></p></div><div id="2017dfd9-86ee-455c-9c8c-e8162128f52c" style="width:50%" class="column"><table id="5bdd16ff-7996-493b-88d2-ef16a81884cf" class="simple-table"><tbody><tr id="75326400-7ff9-4070-8d8b-545b6980d6d9"><td id="&lt;y:?" class="" style="width:286px"><strong><mark class="highlight-pink">Variable</mark></strong></td><td id="FIa|" class=""><strong><mark class="highlight-pink">Value</mark></strong></td></tr><tr id="ef42e5ec-33b7-4bfe-b799-585a68a7af91"><td id="&lt;y:?" class="" style="width:286px">IP address of the remote system</td><td id="FIa|" class="">192.168.1.30</td></tr><tr id="7dd492be-ecd1-4bc0-9ab0-5141ca4f65d8"><td id="&lt;y:?" class="" style="width:286px">User on the remote system</td><td id="FIa|" class="">ubuntu</td></tr><tr id="abb70a95-bcb6-4863-be00-aa9ad0b3bddb"><td id="&lt;y:?" class="" style="width:286px">Name of the file on the remote system</td><td id="FIa|" class="">documents.txt</td></tr><tr id="1ef28390-217a-4d6e-bb3c-4abbd987a95e"><td id="&lt;y:?" class="" style="width:286px">Name  to store the file as on our system</td><td id="FIa|" class="">notes.txt</td></tr></tbody></table><p id="bc700902-f3c7-4104-9595-f4df506a0768" class=""><mark class="highlight-pink"><code>scp ubuntu@192.168.1.30:/home/ubuntu/documents.txt notes.txt</code></mark></p></div></div></details></li></ul><ul id="9698b9f2-0cf0-4ccd-a0be-40687d01eb5e" class="toggle"><li><details open=""><summary><strong>Processes 101</strong></summary><p id="0e5c8e57-e37b-466d-afee-c90ca8639a2b" class="">Processes are programs running on the machine, managed by the kernel, where each process will have an ID associated with it, known as its PID. The PID increments in the order the process starts.</p><p id="4cf4824f-07d7-4f2d-92aa-ece5f5fa61e2" class=""><span style="border-bottom:0.05em solid"><strong>Viewing Processes</strong></span></p><p id="697bd7b6-e009-4e9c-88ba-c5e1a4764220" class=""><mark class="highlight-pink"><code>ps</code></mark> provides a list of running processes on the user&#x27;s session and additional info. To see processes run by other users and those that don&#x27;t run from a session (i.e. system processes), use <mark class="highlight-pink"><code>ps aux</code></mark><mark class="highlight-pink">. </mark>The <mark class="highlight-pink"><code>top</code></mark> command gives real-time statistics about the processes running on your system instead of a one-time view and refreshes every 10 seconds or when you use the arrow keys to browse the rows.</p><p id="08042ff7-b4db-4356-8d09-1ab45551f985" class=""><span style="border-bottom:0.05em solid"><strong>Managing Processes</strong></span></p><p id="b6361435-42f0-4a09-a08a-38f795eb3543" class="">To send signals to terminate processes; a variety of types of signals correlate to how &quot;cleanly&quot; the process is dealt with by the kernel. To kill a command, use the <mark class="highlight-pink"><code>kill</code></mark> command and the PID that we wish to kill; to kill PID 1337 - <mark class="highlight-pink"><code>kill 1337</code></mark><mark class="highlight-pink">. </mark>Signals to send to a process when it is killed: SIGTERM - Kill the process, but allow it to do some cleanup tasks beforehand, SIGKILL - Kill the process, doesn&#x27;t do any cleanup after, SIGSTOP - Stop/suspend a process</p><p id="daf496dd-6ff8-428a-9620-6e4f68ab8c0b" class=""><span style="border-bottom:0.05em solid"><strong>How do Processes Start?</strong></span></p><p id="bfe3cecf-1aa0-4ae8-b890-5dc0a868800f" class="">The OS uses namespaces to divide available computer resources (CPU, RAM, priority) to processes. Processes have access to a certain amount of computing power; a small portion of what is actually available to every process overall. Namespaces are great for security when isolating processes - only those in the same namespace can see each other. The process of ID 0 is a process started when the system boots. This process is the system&#x27;s init on Ubuntu, eg. <strong>systemd</strong>, used to provide a way of managing a user&#x27;s processes and sits between the operating system and the user. eg, once a system boots and initializes, <strong>systemd </strong>is one of the first processes started. Any program or piece of software we want to start will start as a child process of <strong>systems, </strong>meaning it is controlled by <strong>systemd</strong>, but will run as its own process (although sharing resources from <strong>systemd</strong>) to make it easier to identify etc.</p><figure id="b39a9533-816c-4c0a-a6a3-825fc7f153b1" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/process1.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/process1.png"/></a></figure><p id="7f849e9b-7065-4f82-8e2e-2c6d63f8212b" class=""><span style="border-bottom:0.05em solid"><strong>Getting Processes/Services to Start on Boot</strong></span></p><p id="422389fe-72e1-4223-a5a2-f5e4a5cb6bca" class="">Some applications can be started on the boot of the system that we own. eg, web servers, database servers or file transfer servers. The software is often critical and told to start during the boot-up of the system by administrators.</p><p id="80f25674-7800-40b4-8914-59ce2e213080" class="">eg: tell apache web server to start apache manually and then tell the system to launch apache2 on boot, <mark class="highlight-pink"><code>systemctl</code></mark> - allows interaction with the <strong>systemd</strong> process/daemon, formatting: <mark class="highlight-pink"><code>systemctl [option] [service]</code></mark><mark class="highlight-pink"> eg </mark>to tell apache to start up, use <mark class="highlight-pink"><code>systemctl start apache2</code></mark>. To stop apache, replace <mark class="highlight-pink"><code>[option]</code></mark> with stop; Four options of <mark class="highlight-pink"><code>systemctl</code></mark>: Start, Stop, Enable, Disable</p><div id="050c145e-a17b-47cd-961e-603323079a77" class="column-list"><div id="7ced2917-b3ee-4ee5-a17c-77d718c4b400" style="width:106.25%" class="column"><p id="ef12089e-27d9-42ce-a6e2-0fa0227ac94e" class=""><span style="border-bottom:0.05em solid"><strong>An Introduction to Backgrounding and </strong></span><span style="border-bottom:0.05em solid"><strong>Foregrounding</strong></span><span style="border-bottom:0.05em solid"> </span><span style="border-bottom:0.05em solid"><strong>in </strong></span><span style="border-bottom:0.05em solid"><strong>Linux</strong></span></p><p id="078e2840-8c97-43e8-8436-d5a0d347bdd8" class="">Processes can run in two states: the background and the foreground. eg, commands that run in the terminal such as &quot;echo&quot; run in the foreground of your terminal as it is the only command provided that hasn&#x27;t been told to run in the background. The output of echo will return in the foreground, but not in the background. After adding the <mark class="highlight-pink"><code>&amp;</code></mark> operator, it just gives the ID of the echo process -- as it is running in the background. Same when executing things like scripts -- rather than using <code>&amp;</code>, use <mark class="highlight-pink"><code>Ctrl + Z</code></mark> to background a process. It is also an effective way of &quot;pausing&quot; the execution of a script or command.</p><p id="55c41509-070c-4309-ab80-2212da0c4866" class=""><span style="border-bottom:0.05em solid"><strong>Foregrounding a process</strong></span></p><p id="430d1655-432f-4eb3-9f46-1fb4b4203575" class="">Now we have a process in the background, our script &quot;background.sh&quot; can be confirmed by using the <mark class="highlight-pink"><code>ps aux</code></mark> command. Use <mark class="highlight-pink"><code>fg</code></mark> to bring this back to focus and return the output of the script</p><figure id="a01a7ecb-22db-4f0a-9a78-d5b0123bebd7" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg3.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg3.png"/></a></figure><figure id="c5cc3a50-214f-400a-b270-e2c75c028c69" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg4.png"><img style="width:240px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg4.png"/></a></figure></div><div id="09f7ee01-5c75-4888-80d3-5091dd64bc79" style="width:49.999999999999986%" class="column"><figure id="f01328d8-0af1-4ef2-a591-aa897960ceb6" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg1.png"><img style="width:528px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg1.png"/></a></figure><figure id="13e1caf6-fdb0-4dcf-851b-0298f2d99e66" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg2.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg2.png"/></a></figure><figure id="1e003043-7087-4014-89ef-51037755c001" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg5.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg5.png"/></a></figure></div></div></details></li></ul><ul id="8a3aed85-6435-430e-b3f0-9803d6788bf3" class="toggle"><li><details open=""><summary><strong>Maintaining Your System: Automation</strong></summary><div id="0427cbf8-c279-4195-b80d-6b3f9ea74b82" class="column-list"><div id="e208085f-fef0-45eb-bb2d-bc7070934e16" style="width:106.25%" class="column"><p id="2d64a8ff-aaba-4cde-9a7a-14809f6fe83b" class="">To schedule a certain action or task to take place after the system has booted. eg, running commands, backing up files, or launching programs. Crontab is one of the processes that is started during boot and is responsible for facilitating and managing cron jobs. A crontab is a special file with formatting that is recognized by the <mark class="highlight-pink"><code>cron</code></mark> process to execute each line step-by-step. Crontabs require 6 specific values:</p><div id="e20ce653-887c-4cec-89ab-449a99217bcb" class="column-list"><div id="de8f45ee-12aa-43c7-8ed2-4f19c8a04497" style="width:56.25%" class="column"><table id="9cd08695-dc3f-4901-9523-1e0a0f957920" class="simple-table"><tbody><tr id="d8acb41e-c9ba-4b33-bf28-73c6cf5d37c2"><td id="hYc&gt;" class="" style="width:67px"><mark class="highlight-pink"><strong>Value</strong></mark></td><td id="`DKM" class="" style="width:266px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="19d71d17-8e73-4d98-b0b3-5951c5dcf39c"><td id="hYc&gt;" class="" style="width:67px">MIN</td><td id="`DKM" class="" style="width:266px">What minute to execute at</td></tr><tr id="da6a882d-7a18-48e4-8b2f-d380bd3b966d"><td id="hYc&gt;" class="" style="width:67px">HOUR</td><td id="`DKM" class="" style="width:266px">What hour to execute at</td></tr><tr id="3213b82f-944c-4a75-9fc3-0e9588a879ca"><td id="hYc&gt;" class="" style="width:67px">DOM</td><td id="`DKM" class="" style="width:266px">What day of the month to execute at</td></tr><tr id="eb89ba04-f499-46af-82ed-b20eb32bc5cf"><td id="hYc&gt;" class="" style="width:67px">MON</td><td id="`DKM" class="" style="width:266px">What month of the year to execute at</td></tr><tr id="c7be6a57-584c-45db-9989-fbc24555ddb8"><td id="hYc&gt;" class="" style="width:67px">DOW</td><td id="`DKM" class="" style="width:266px">What day of the week to execute at</td></tr><tr id="e296c492-d451-4d1d-94b0-59be5e8d4c98"><td id="hYc&gt;" class="" style="width:67px">CMD</td><td id="`DKM" class="" style="width:266px">The actual command to be executed</td></tr></tbody></table></div><div id="a543b58e-8ebb-43bc-b6bb-52eb826a1940" style="width:43.75%" class="column"><p id="0bef2e1c-efa9-48ec-ae31-b8096186bed4" class="">eg, to backup &quot;cmnatic&quot;&#x27;s  &quot;Documents&quot; every 12 hours, use <mark class="highlight-pink"><code>0 *12 * * * cp -R /home/cmnatic/Documents/var/backups/</code></mark></p></div></div><p id="99d2f9cb-d666-4ca0-8fb9-7e45e6dfc075" class="">Crontabs supports the wildcard or asterisk (<mark class="highlight-pink"><code>*</code></mark>). If we do not wish to provide a value for that specific field, i.e. we don&#x27;t care what month, day, or year it is executed -- only that it is executed every 12 hours, just place an asterisk. Crontabs can be edited using <mark class="highlight-pink"><code>crontab -e</code></mark>, which selects an editor (such as Nano) to edit your crontab.</p></div><div id="1d0c43c8-4c03-44be-aea9-495ffb01b93a" style="width:43.750000000000014%" class="column"><figure id="b363328e-004d-46a4-a289-db448d39a5f2" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron1.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron1.png"/></a></figure><figure id="3eef63eb-7823-41ec-9813-898ff4a5496e" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron3.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron3.png"/></a></figure><figure id="3354b2c5-c4aa-45ba-82e5-af0c7487450a" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron2.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron2.png"/></a></figure></div></div></details></li></ul><ul id="397625a1-0bc8-4370-9b6b-e89c0a2ff0c6" class="toggle"><li><details open=""><summary><strong>Maintaining Your System: Package Management</strong></summary><p id="b4f21c15-19a7-46c2-936b-a0ce33c4a793" class=""><span style="border-bottom:0.05em solid"><strong>Introducing Packages &amp; Software Repos</strong></span></p><div id="209f6853-4e9a-41bc-a5ef-df22b54486bb" class="column-list"><div id="bc09bf69-a29a-42b5-b9f5-212a38393813" style="width:112.5%" class="column"><p id="e6193efa-96c5-4af6-98ea-fb28d5c25379" class="">For developers to submit software to the community, they submit it to an  &quot;apt&quot; repository. If approved, their programs and tools will be released. Two of the most redeeming features of Linux here: User accessibility and the merit of open source tools. When using the <mark class="highlight-pink"><code>ls</code></mark> command on a Ubuntu 20.04 Linux machine, these files serve as the gateway/registry. OS vendors maintain their own repositories and add community repositories to your list, allowing you to extend the capabilities of your OS. </p></div><div id="c21a8e17-4e8f-46af-b535-291638bb07d7" style="width:62.499999999999986%" class="column"><figure id="bd19d0ed-a0d7-4b40-82e8-13cf196f51ae" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt1.png"><img style="width:672px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt1.png"/></a></figure><figure id="c206323a-a05f-49ec-8a75-488ce825c9a4" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt2.png"><img style="width:672px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt2.png"/></a></figure></div></div><p id="354abb7e-48e9-4a47-911c-8f39c9b1d4fc" class=""><span style="border-bottom:0.05em solid"><strong>Managing Your Repositories (Adding and Removing)</strong></span></p><p id="505914c3-090e-4e2e-b515-5a7ad0d121b7" class="">The <mark class="highlight-pink"><code>apt</code></mark> command is part of the package management software also named apt which contains a suite of tools to manage, install, or remove packages and sources of our software. Additional repositories can be added using <mark class="highlight-pink"><code>add-apt-repository</code></mark> command or by listing another provider, eg. , some vendors have a repository closer to their geographical location so you can install software through package installers such as <code><mark class="highlight-pink">dpkg</mark></code>. The benefit of apt is that whenever you update the system, the repository containing the software added also gets checked for updates. When adding software, the integrity is guaranteed by the use of GPG (Gnu Privacy Guard) keys, which are essentially a safety check from the developers. If the keys do not match what your system trusts and the developers used, then the software will not be downloaded.</p><p id="5e1dbecf-a3c4-4861-9f6f-8e19f244a811" class="">Add the text editor Sublime Text to our Ubuntu machine as a repository: add the GPG key for the developers of Sublime Text 3. <mark class="highlight-pink"><code>wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</code></mark><mark class="highlight-pink"> </mark>Add Sublime Text 3&#x27;s repository to our apt sources list. A good practice is to have a separate file for every different community/3rd party repository that we add: create a file named <strong>sublime-text.list </strong>in <strong>/etc/apt/sources.list.d</strong> and enter the repository information: Use a text editor to add &amp; save the Sublime Text 3 repository into this newly created file: /etc/apt/sources.lit.d# touch sublime-text.list &gt;&gt;&gt;&gt;&gt; deb <a href="https://download.sublimetext.com"><mark class="highlight-pink"><code>https://download.sublimetext.com</code></mark></a><code><mark class="highlight-pink">/ apt/stable/</mark></code><mark class="highlight-pink"> </mark>Update apt to recognize the new entry using the <mark class="highlight-pink"><code>apt update</code></mark> command. Install the software using <mark class="highlight-pink"><code>apt install sublime-text</code></mark>Removing packages - <mark class="highlight-pink"><code>add-apt-repository --remove ppa:PPA_Name/ppa</code></mark> or manually delete the file then <mark class="highlight-pink"><code>apt remove [software-name-here]</code></mark> i.e. <mark class="highlight-pink"><code>apt remove sublime-text</code></mark></p></details></li></ul><ul id="28cacb0c-ee49-49b6-a81c-c9746e3ff3ee" class="toggle"><li><details open=""><summary><strong>Maintaining Your System: Logs</strong></summary><div id="c2ef3a9f-5f77-4b18-84cf-a78880a01d39" class="column-list"><div id="0b78e1e1-d182-4539-bbd7-682c4211fe84" style="width:106.25%" class="column"><p id="e55d8ab1-2483-4cb0-a581-83bff84ac459" class="">Located in the /var/log directory, these files and folders contain logging information for applications and services running on your system. The OS automatically manages logs in a process known as &quot;rotating&quot;. Logs from three services running on a Ubuntu machine: Apache2 web server, Logs for the fail2ban service used to monitor attempted brute forces, eg. the UFW service used as a firewall</p><p id="387e3b91-8337-409b-82eb-48f4eb011343" class="">Services and logs are a great way to monitor and protect your system health. Service logs like a web server contain information about every single request - allowing developers or administrators to diagnose performance issues or investigate an intruder&#x27;s activity. Two types of log files of interest: access log, and error log. There are also logs that store information about how the OS runs itself and actions performed by users like authentication attempts.</p></div><div id="becd1f03-f407-404c-892c-ad59e8fdae99" style="width:43.75%" class="column"><figure id="f0cfe799-e8bc-406c-8ce6-064351f89226" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log1.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log1.png"/></a></figure><figure id="3673dae8-8d8b-4b2a-a2b2-b96d9258f0f5" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log2.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log2.png"/></a></figure></div></div></details></li></ul><h3 id="01f3f738-69cc-4fc8-ae2b-1647c476c51b" class="block-color-purple_background"><strong>Linux Modules</strong></h3><ul id="a27df1a4-9eda-4a88-a2d2-c749ddd307c1" class="toggle"><li><details open=""><summary><strong>du (disk usage)</strong></summary><p id="e962d1fb-551e-45f6-8f54-02752f1f742a" class=""><mark class="highlight-pink"><code>du</code></mark> - a linux command that helps identify what files/directories are consuming how much space; du can alternate <code><mark class="highlight-pink">ls</mark></code><mark class="highlight-pink">, i</mark>t won&#x27;t specify user ownership, so use <mark class="highlight-pink"><code>stat</code></mark>command on the file you want to know who is the owner of that particular file</p><table id="c630e537-be30-4cfa-b4f9-8e727dabb5ef" class="simple-table"><tbody><tr id="96c6b09b-8d23-49f3-b3fb-b25f0677829d"><td id="h[|A" class="block-color-default" style="width:74px"><mark class="highlight-pink"><strong>Flag</strong></mark></td><td id="T?[^" class="block-color-default" style="width:744px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="87265d4e-94e8-4d31-bcc2-c3193fb7adce"><td id="h[|A" class="block-color-default" style="width:74px">-a</td><td id="T?[^" class="block-color-default" style="width:744px">Lists files with the folder <mark class="highlight-pink"><code>du -a /home/ | grep user</code></mark> lists any file/directory with name containing string &quot;<em>user</em>&quot; </td></tr><tr id="eeddad74-07f1-4978-90ec-97c8e44c2eed"><td id="h[|A" class="block-color-default" style="width:74px">-h</td><td id="T?[^" class="block-color-default" style="width:744px">Lists the file sizes in human-readable format (B, MB, KB, GB)</td></tr><tr id="7e20c0ba-1836-448c-a1db-c5062404cd58"><td id="h[|A" class="block-color-default" style="width:74px">-c</td><td id="T?[^" class="block-color-default" style="width:744px">Prints the total size at the end</td></tr><tr id="ee85c5e6-70c2-40aa-af37-e89f2f18d13f"><td id="h[|A" class="block-color-default" style="width:74px">-d &lt;#&gt;</td><td id="T?[^" class="block-color-default" style="width:744px">Specifies the depth-ness of a dir <mark class="highlight-pink"><code>du --time -d 1 .</code></mark><mark class="highlight-pink"> </mark></td></tr><tr id="906ca65d-b9eb-4161-b8a2-5bbe87748396"><td id="h[|A" class="block-color-default" style="width:74px">--time</td><td id="T?[^" class="block-color-default" style="width:744px">Returns the results with the time stamp of the last modified</td></tr></tbody></table></details></li></ul><ul id="deaec814-5695-41ef-917f-d0ea7a16a142" class="toggle"><li><details open=""><summary><strong>Grep, Egrep, Fgrep</strong></summary><p id="9bb24525-79ec-47ab-9e92-21eba62f253c" class=""><mark class="highlight-pink"><code>grep</code></mark> - filters output we need; searches a file for a particular pattern of chars; The pattern is searched in regular expression. </p><p id="f87a06fd-ba82-46c5-93e3-3e577f8fb487" class=""><span style="border-bottom:0.05em solid"><strong>The Family Tree</strong></span></p><p id="f4139d86-7c7b-41b7-b89c-9571cb6cb64b" class="">egrep and fgrep are no different from grep (other than 2 flags that can be used with grep to function as both); egrep matches the regular expressions in a string; fgrep searches for a fixed string inside text; grep can do both their jobs by using -E and -F flag, respectively; <mark class="highlight-pink"><code>grep -E</code></mark> functions same as <mark class="highlight-pink"><code>egrep</code></mark> ; <mark class="highlight-pink"><code>grep -F</code></mark> functions same as <mark class="highlight-pink"><code>fgrep</code></mark>.</p><table id="e1b27ad4-a067-4563-9578-a40ad55b11cb" class="simple-table"><tbody><tr id="c997f1ac-379c-4ccb-805d-096cd6a78166"><td id="IB:a" class="block-color-pink" style="width:58px"><strong>Flags</strong></td><td id="}?v`" class="block-color-pink" style="width:670px"><strong>Description</strong></td></tr><tr id="c360f212-da60-4abd-8323-36ebbf1c2700"><td id="IB:a" class="" style="width:58px">-R</td><td id="}?v`" class="" style="width:670px">Does a recursive grep search for the files inside the folders</td></tr><tr id="1711561a-05e5-4516-b04d-e216dbd15af7"><td id="IB:a" class="" style="width:58px">-h</td><td id="}?v`" class="" style="width:670px">If you&#x27;re grepping recursively in a directory, this flag disables the prefixing of filenames in the results</td></tr><tr id="3ccf5988-ce9a-448f-9d46-a8314f597883"><td id="IB:a" class="" style="width:58px">-c</td><td id="}?v`" class="" style="width:670px">Only lists an integer value of how many times the pattern was found in the file/folder //count</td></tr><tr id="882c32d7-7f26-4837-b085-a40862f6a096"><td id="IB:a" class="" style="width:58px">-i</td><td id="}?v`" class="" style="width:670px">Specifies grep to search for the PATTERN while IGNORING the case //prefer</td></tr><tr id="26a6e636-b1eb-4a8b-8162-32eb59a1c65e"><td id="IB:a" class="" style="width:58px">-l</td><td id="}?v`" class="" style="width:670px">Only lists the filename instead of the pattern found in it</td></tr><tr id="c2b235d1-d5a2-4a30-bf7c-35ebbeb5aa29"><td id="IB:a" class="" style="width:58px">-n</td><td id="}?v`" class="" style="width:670px">Lists the lines with their line number in the file containing the pattern</td></tr><tr id="3e9fc548-929b-4d5b-b9d6-df78a45b699e"><td id="IB:a" class="" style="width:58px">-v</td><td id="}?v`" class="" style="width:670px">Prints all the lines that are NOT containing the pattern</td></tr><tr id="3b63d2fa-ebe4-47be-9fdd-34bc0617106d"><td id="IB:a" class="" style="width:58px">-E</td><td id="}?v`" class="" style="width:670px"><mark class="highlight-pink"><code>egrep</code></mark><mark class="highlight-pink"> </mark>Considers the PATTERN as a regular expression to find the matching strings; can specify one single pattern; works on EREs (Extended Regular Expressions); EREs tend to mathc 2+ patterns in a file</td></tr><tr id="66e82068-1ca2-438b-a1e9-ad84cdcde14d"><td id="IB:a" class="" style="width:58px">-e</td><td id="}?v`" class="" style="width:670px">Can be used to specify multiple patterns and lists any string that matches the pattern(s); works on the BREs (Basic Regular Expressions); BREs tend to match a single pattern in a file</td></tr></tbody></table></details></li></ul><ul id="6b617983-5339-4e36-9c1a-5671a2f22d13" class="toggle"><li><details open=""><summary><span style="border-bottom:0.05em solid"><strong>String Manipulations (STRing OPerationS)</strong></span></summary><p id="e8e69f58-9fdf-4d8d-8de6-83e8c180713a" class="">Indexing in arrays, slicing in python, and grepping in terminal are a means of string manipulations. The following tools should be kept for STROPS: tr, ark, sed, xargs, sort, uniq</p><ul id="d08f5c6d-4a81-4aad-8a4e-3d6c512d2f45" class="toggle"><li><details open=""><summary><strong>tr (Translate command)</strong></summary><p id="1fed40a3-dd4f-4bfc-abfd-dab8f22fd02c" class=""><code><mark class="highlight-pink">tr</mark></code><mark class="highlight-pink"> </mark>can help you from changing character cases in a string to replacing characters in a string; Desktop app: emojis use :keyword: so tr can select set with same output <code><mark class="highlight-pink">cat file.txt | tr -s &#x27;[:lower:]&#x27; &#x27;[:upper:]&#x27; </mark></code></p><table id="ee879f85-1c25-4407-b2f6-9fe97ba66f51" class="simple-table"><tbody><tr id="0a01a19e-d87a-4b2a-b506-b032ca6b4b24"><td id="E_~r" class="" style="width:60px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="zbu;" class="" style="width:823px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="48feb4ad-5ea9-4246-8a6e-1b9af8280387"><td id="E_~r" class="" style="width:60px">-d</td><td id="zbu;" class="" style="width:823px">Deletes a given set of characters <code><mark class="highlight-pink">cat file.txt | tr -d &#x27;[a-zA-Z: ]&#x27;</mark></code><mark class="highlight-pink"> </mark>View user creds which are in digits</td></tr><tr id="c0d3e711-4a8a-4dfa-9ebf-6d6a562d2a9d"><td id="E_~r" class="" style="width:60px">-t</td><td id="zbu;" class="" style="width:823px">Concats source set with destination set (destination set comes first; t stands for truncate)</td></tr><tr id="0e0c03e6-2ea5-44d4-864a-fa36514c385f"><td id="E_~r" class="" style="width:60px">-s</td><td id="zbu;" class="" style="width:823px">Replaces source with destination set (squeeze) <code><mark class="highlight-pink">cat file.txt | tr -s &#x27;[a-z]&#x27; &#x27;[A-Z]&#x27;</mark></code><mark class="highlight-pink"> </mark>Convert every letter to upper case</td></tr><tr id="a3793448-899a-47c9-84d0-51bcbfaf9887"><td id="E_~r" class="" style="width:60px">-c</td><td id="zbu;" class="" style="width:823px">REVERSE card; eg. specify -c with -d to delete  the rest of the characters leaving the source set we specified; - complement</td></tr></tbody></table></details></li></ul><ul id="cef16da4-76ef-4d85-80b7-0a5cfa624518" class="toggle"><li><details open=""><summary><strong>awk</strong></summary><p id="7ca6faab-8f74-4c93-8587-73629635c9c3" class=""><em>&quot;Awk is a scripting language used for manipulating data and generating reports. The awk command programming language requires no compiling, and allows the user to use variables, numeric functions, string functions, and logical operators.&quot; </em><strong>Fun fact:</strong> AWK is abbreviated after its creators (Aho, Weinberger, and Kernighan). Syntax: <mark class="highlight-pink"><code>awk [flags] [select pattern/find(sort)/commands] [input file]</code></mark></p><p id="501f5e10-48fa-48a6-a556-cfcaa0f74731" class="">Note: awk does support getting output via piping; you can execute the script commands by using the <mark class="highlight-pink"><code>f</code></mark> flag and specifying the name of the script file; (<mark class="highlight-pink"><code>awk -f script.awk input.txt</code></mark>)</p><p id="bb335e86-f5d9-47d1-9e48-7583ad9ce480" class=""><span style="border-bottom:0.05em solid"><strong>Using AWK - </strong></span>To search for pattern inside file, enclose pattern in forward slashes <mark class="highlight-pink"><code>/pattern/</code></mark>. eg. to know who all plays CTF competitions: <mark class="highlight-pink"><code>awk &#x27;/ctf/&#x27; file.txt</code></mark></p><div id="dc88fd43-6749-4098-a04c-f76beadafb39" class="column-list"><div id="6fdbfec1-6017-42bf-8dba-54c7cd1ba406" style="width:112.5%" class="column"><p id="4070f32c-0759-4571-9bd4-6042a1e8e42e" class=""><span style="border-bottom:0.05em solid"><strong>Built-In variables in AWK</strong></span></p><p id="6ab61d68-1a60-4f43-82d7-8bfc3736149b" class="">Built-in variables include field variables ($1, $2, $3 .. $n). These field variables are used to specify a piece of data (data separated by a delimiter defaulting to space). <mark class="highlight-pink"><code>awk &#x27;{print $1 $3}&#x27; file.txt</code></mark> will list words at 1st and 3rd fields.</p><p id="79212963-b20d-4938-87bb-c374af8fce5d" class="">Let&#x27;s just use a &quot;,&quot; (comma) to bring the space. Note: You may notice the use of {} around the print statement, that&#x27;s where we used a function. To use commands in awk scripts, you need to mention them inside a function.</p></div><div id="b1b00c66-45fb-4a53-9fdf-68bfa0066ffb" style="width:68.74999999999999%" class="column"><figure id="19588ea9-3869-4a8f-a2a3-0d0a899de7cf" class="image"><a href="https://i.imgur.com/v08VQpx.png"><img style="width:624px" src="https://i.imgur.com/v08VQpx.png"/></a></figure><figure id="dc222e8f-7cfd-4229-9890-969bdd855798" class="image"><a href="https://i.imgur.com/j9ap6zd.png"><img style="width:528px" src="https://i.imgur.com/j9ap6zd.png"/></a></figure></div></div><p id="aff6fd85-58e8-42d8-bcf2-088f90b83f11" class="">Note: The $0 variable points to the whole line.  S<em>ingle quotes(&#x27;&#x27;) to specify patterns, awk treats double quotes(&quot;&quot;) as a raw string. To use double quotes make sure that you escape the ($) sign(s) with a backslash (\) each, to make it work properly.</em></p><div id="82665a72-52c2-4e97-935b-c04ca17224ae" class="column-list"><div id="08ac8097-24a4-4213-9a5a-4f65afd93a50" style="width:106.25%" class="column"><p id="99ac8328-bf5a-49e5-9906-8989374dd8bf" class=""><span style="border-bottom:0.05em solid"><strong>More on variables</strong></span></p><p id="70d4db35-b66b-4f8c-b950-05b73ceb0002" class=""><strong>NR </strong>(Number Record): the variable that keeps count of the rows after each line&#x27;s execution. You can use NR command to number the lines (<mark class="highlight-pink"><code>awk &#x27;{print NR,$0}&#x27; file.txt</code></mark>). Note that awk considers rows as records.</p><p id="ad506541-3111-46b1-b56b-1c3be7fa64cb" class=""><strong>FS (</strong>Field Separator): the variable to set in case you want to define the field for input stream. The field separation (default to space) can be altered to whatever you want while specifying the pattern. FS can be defined to another character(s) at the BEGIN{command}.</p><p id="38ad2807-155c-43c6-8c62-d0fbcfff4f74" class=""><strong>BEGIN</strong> is a pattern that we specify and the following is the action on that pattern to be performed at the start</p><p id="a63d48f3-6e0f-43ef-b6d1-c3f12c81851d" class=""><strong>END</strong> is also a pattern that we specify following the action to perform on that pattern used to define<em> actions </em>like Field Separator, Record Separator, etc. that are to be performed at the end of the script, respectively.</p><p id="385f9392-a2c5-4e6c-a682-f4c8e9f61677" class=""><strong>RS </strong>(Record Separator): By default it separate rows with &#x27;\n&#x27;, you can specify something else too. Notice that there has been a new line created wherever &#x27;o&#x27; was used. It also interpreted &#x27;\n&#x27; used in the text file, so there are new lines after end of every number too.</p><p id="ec299a0f-cbcb-406d-9854-c2e2398aa06b" class=""><strong>OFS: </strong>(Output Field Separator): specifies a delimeter while outputing</p><p id="73aea4c4-a456-4b6f-b7a6-89ac7cc86034" class="">I used OFS in both commands, you can see that only in 2nd one the delimiter was used. Note that the output field separator will separate fields using (:) only when the fields are defined with the print statement. With $0 I didn&#x27;t had anything else, if it were to be $0,$0 then the lines would be joining their reflection(non-laterally) with a colon(:).</p><figure id="431fbb48-9437-4410-99a0-3ee3f38413e7" class="image"><a href="https://i.imgur.com/q3Aglyq.png"><img style="width:432px" src="https://i.imgur.com/q3Aglyq.png"/></a></figure><p id="c43ea7a4-86f1-4d80-b389-2fde9553cc11" class=""><strong>ORS:</strong> (Output Record Separator) ; My delimiter was a double new-line character.</p><table id="a4fff576-6d5f-459e-a402-c72f14cb4276" class="simple-table"><tbody><tr id="71289b87-7add-408f-8101-529259046937"><td id="kR?o" class="" style="width:58px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="eSfp" class="" style="width:363px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="310a5afd-2369-4223-8ceb-82662e3ed66e"><td id="kR?o" class="" style="width:58px">-F</td><td id="eSfp" class="" style="width:363px">Specify FIELD SEPARATOR instead of using BEGIN</td></tr><tr id="c4ed4adc-5162-4a07-851a-7125dfe269e5"><td id="kR?o" class="" style="width:58px">-v</td><td id="eSfp" class="" style="width:363px">Specify variables (like in BEGIN{OFS=&quot;:&quot;}</td></tr><tr id="b28e3e28-0120-4ebc-82ea-778aac7e2237"><td id="kR?o" class="" style="width:58px">-D</td><td id="eSfp" class="" style="width:363px">Debug your .awk scripts specifying this flag</td></tr><tr id="8c7933ef-198c-4269-878b-6f9be8a5f890"><td id="kR?o" class="" style="width:58px">-o</td><td id="eSfp" class="" style="width:363px">Specify output file; no name&gt;defaults to awkprof.out</td></tr></tbody></table><p id="3df7a3eb-e4ec-4c2a-b990-8f77dd4bbc54" class="">
</p></div><div id="49c6700c-38d9-4957-93c8-d434e99ea9f4" style="width:68.75000000000001%" class="column"><figure id="425467f6-36c3-49b5-99c9-232c96d0af9d" class="image" style="text-align:right"><a href="https://i.imgur.com/5OhnYAB.png"><img style="width:528px" src="https://i.imgur.com/5OhnYAB.png"/></a></figure><figure id="b45be54d-c9ce-4420-9a1b-bf0b1ca3c4cc" class="image"><a href="https://i.imgur.com/uw9hWVM.png"><img style="width:528px" src="https://i.imgur.com/uw9hWVM.png"/></a></figure><figure id="6056546d-ca84-499c-899f-9e8692c0a70b" class="image"><a href="https://i.imgur.com/npmICXD.png"><img style="width:816px" src="https://i.imgur.com/npmICXD.png"/></a></figure><p id="793c19ce-43ba-46dc-873a-2670aa7a513b" class=""><mark class="highlight-pink"><code>awk &quot;BEGIN {FS=&#x27;o&#x27;} {print $1,$3} END{print &#x27;Total Rows=&#x27;,NR}&quot;</code></mark></p><figure id="2dbc4908-90da-42b4-8ab6-6cf4f8fe39f6" class="image" style="text-align:right"><a href="https://i.imgur.com/dsn9utX.png"><img style="width:480px" src="https://i.imgur.com/dsn9utX.png"/></a></figure><figure id="62039ec0-ae59-4d0d-8d2d-58aeb9b235c0" class="image"><a href="https://i.imgur.com/hwIjE8p.png"><img style="width:432px" src="https://i.imgur.com/hwIjE8p.png"/></a></figure><figure id="1ad6274e-0686-4965-8fb5-afd3dc1ec4f1" class="image"><a href="https://i.imgur.com/5j2f5zy.png"><img src="https://i.imgur.com/5j2f5zy.png"/></a></figure></div></div></details></li></ul><ul id="025b349a-9739-4c44-91d8-e909914ce242" class="toggle"><li><details open=""><summary><strong>sed (Stream EDitor)</strong></summary><p id="ea9b34bc-29c2-4da0-928b-0df7668e4778" class="">sed - a tool to perform a number of string operations: FIND AND REPLACE, searching, insertion, deletion; easily perform operations with sed command by piping input or redirecting (&lt;) input from a file. Syntax: <mark class="highlight-pink"><code>sed [flags] [pattern/script] [input file]</code></mark></p><table id="d70c5580-7858-42cf-a005-d6ef3e83d34a" class="simple-table"><tbody><tr id="c4b8367e-e677-446d-bb29-a683fa825d40"><td id="]^w}" class="block-color-pink"><strong>Flags</strong></td><td id=":NVl" class="block-color-pink" style="width:694px"><strong>Description</strong></td></tr><tr id="3c3205e7-f680-4dd8-893a-2d89a78d8173"><td id="]^w}" class="">-e</td><td id=":NVl" class="" style="width:694px">Add a script/command that needs to be executed with the pattern/script (on searching for pattern)</td></tr><tr id="6bae23dc-f0b6-421c-a4b2-2d3cc473c9c9"><td id="]^w}" class="">-f</td><td id=":NVl" class="" style="width:694px">Specify the file containing the string pattern</td></tr><tr id="18862d60-3eb6-4553-ac60-52fc79c9ba95"><td id="]^w}" class="">-E</td><td id=":NVl" class="" style="width:694px">Use extended regular expressions</td></tr><tr id="4c4dfc41-57bc-403c-8d22-fe378eaaa74e"><td id="]^w}" class="">-n</td><td id=":NVl" class="" style="width:694px">Suppress the automatic printing or pattern spacing</td></tr></tbody></table><p id="8f0ad806-e546-4380-954e-7925bfbb001c" class=""><span style="border-bottom:0.05em solid"><strong>The sed command</strong></span></p><p id="2ec13c2c-ae31-47e8-b805-82d5c2ccd43d" class="">&#x27;[condition(s)(optional)] [command/mode(optional)]/[source/to-be-searched pattern(mandatory)]/[to-be-replaced pattern(depends on command/mode you use)]/[args/flags to operate on the pattern searched(optional)]&#x27;</p><table id="3dc2f006-9053-44ca-a997-4eb2838fd299" class="simple-table"><tbody><tr id="b00a2760-e0c1-4b88-8f71-ad87206b0972"><td id="YgDo" class="" style="width:96px"><strong><mark class="highlight-pink">Commands</mark></strong></td><td id="xjO;" class="" style="width:658px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="cf8adb71-204d-4f42-8fa4-c6de5cf0a91e"><td id="YgDo" class="" style="width:96px">s</td><td id="xjO;" class="" style="width:658px">(Most used)Substitute mode (find and replace mode)</td></tr><tr id="71e377e9-f491-417d-b530-b0c46e247c2a"><td id="YgDo" class="" style="width:96px">y</td><td id="xjO;" class="" style="width:658px">Works same as s; except it works on individual bytes in string; takes no arguments/conditions</td></tr></tbody></table><p id="4d4eb1be-6e02-494b-8c3b-6eadfc534048" class=""><strong>[Update] ﻿I used the word &quot;mode&quot; in the rest of the task just to avoid the confusion of using a command(s/y) within the command(sed). But just to be clear, official documentation list them as commands used in sed.</strong></p><p id="fd2a9ee2-b33c-4d35-b338-fd214247be24" class=""><span style="border-bottom:0.05em solid"><strong>Args</strong></span></p><table id="167da6ac-b0ef-4874-b1f8-147ab934514d" class="simple-table"><tbody><tr id="5ac65fab-7527-4b8d-a64a-d1beb235acf2"><td id="wi}r" class=""><strong><mark class="highlight-pink">Flags/Args</mark></strong></td><td id="LB|t" class="" style="width:771px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="ff512216-d8cb-4e13-8452-2a867baefd3f"><td id="wi}r" class="">/g</td><td id="LB|t" class="" style="width:771px">globally(any pattern change will be affected globally, i.e. throughout the text; generally works with s mode)</td></tr><tr id="e8408620-ddb4-4443-bfdd-82b8d82a74ff"><td id="wi}r" class="">/i</td><td id="LB|t" class="" style="width:771px">Make the pattern search case-insensitive (can be combined with other flags)</td></tr><tr id="edd76f06-80a1-4c25-9132-921d7ccac3fe"><td id="wi}r" class="">/d</td><td id="LB|t" class="" style="width:771px">Delete the pattern found (Deletes the whole line; takes no parameter like conditions/modes/to-be-replaced string)</td></tr><tr id="1ea00763-462f-49f5-a419-b5c2a75bed1d"><td id="wi}r" class="">/p</td><td id="LB|t" class="" style="width:771px">Prints the matching pattern (a duplicate will occur in output if not suppressed with -n flag.)</td></tr><tr id="d40c16dd-2db9-482b-b1ab-6e0561a5dd17"><td id="wi}r" class="">/1,/2,/3../n</td><td id="LB|t" class="" style="width:771px">Perform an operation on an nth occurrence in a line (works with s mode)</td></tr></tbody></table><p id="edf4006e-24b7-4890-96ce-190afd72361c" class=""><span style="border-bottom:0.05em solid"><strong>Explanation</strong></span></p><p id="2675eb07-91a8-473f-a597-bef3ae4c9619" class="">sed &#x27;s/\(<mark class="highlight-red">^\b</mark><mark class="highlight-pink">[[:alpha:] ]*\</mark><mark class="highlight-yellow">)\</mark><mark class="highlight-pink">([[:digit:]]</mark><mark class="highlight-yellow">*\)</mark>/\=\&gt; \1\[\2\]/g&#x27; file.txt</p><ul id="5595c6ff-f040-48ec-a0a4-1d61e1a7ad39" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-red">Opening a group with escape character, ^ to put the cursor at the starting of the line, and then \b represents to search for beginning of a word, </mark><mark class="highlight-pink">and then defines a set of characters to include, following a &quot;*&quot; to specify &#x27;n&#x27; number of characters.</mark> <mark class="highlight-yellow">Then closes the group by escaping the closing brackets. Creating another regex group, using escape sequence, we then initialized another set </mark><mark class="highlight-pink">and specified * at the end of the set to take n characters of that set,</mark> <mark class="highlight-yellow">at last group is closed using escape sequence.</mark></li></ul><ul id="6942002d-706c-4a10-8ad2-fec12c529369" class="bulleted-list"><li style="list-style-type:disc">At the replaced end, we are using escape sequences to make a bullet(it&#x27;s just a good practice to use escape sequence with every symbolic character; even if the output is same), then we have escape characters for the square brackets enclosing a sed variable /2 (after /1 which is coming up).</li></ul><ul id="bb6611f7-3360-4a9b-bb94-f706adc04cc4" class="bulleted-list"><li style="list-style-type:disc">Now its turn for the sed&#x27;s keyword part. We used [:alpha:] in the set defined by regex, which is nothing but another representation of using <mark class="highlight-pink"><code>a-zA-Z</code></mark> in regex, which means to capture any alphabetic characters. sed offers such keywords(calling them &quot;bracket expressions&quot;), which we can use to make the input code look cleaner. Similarly we used the bracket expression for specifying digit as well which we specified using [:digit:].</li></ul><p id="d0cc967f-617c-40de-a39d-a6ead61c0467" class="">Note: There&#x27;s a space after the first bracket expression inside the regex set ([[:alpha:]{space}]). As you see, this space was to indicate the regex set <em>so that * could take multiple words until the digits start occurring in the text(regex logic)</em>.</p><ul id="194e29be-a64b-4109-bf93-d7cf69bf6c7a" class="bulleted-list"><li style="list-style-type:disc">Then there are some in-built variables as we saw in <del>awp</del> awk, that we used in the to-be-replace part of sed. \1 depicted the first group which selected everything until the first character occurred. The second group comprised of a set consisting decimal characters, which were enclosed with [\2] with the use of escseq.</li></ul></details></li></ul><ul id="8080678c-82bd-4b56-a950-686d71ec0026" class="toggle"><li><details open=""><summary><strong>xargs</strong></summary><p id="7d7cc541-d75b-44a5-8228-4e6709e4fe4a" class="">xargs makes passed string a command&#x27;s argument, technically, positional argument; a command line tool used to build and execute command from the standard input</p><table id="2f038ec8-67ed-4d3e-a01f-a3c9b68654f3" class="simple-table"><tbody><tr id="cebacbfc-6c54-4bfa-895c-a0f3e2fff60a"><td id="MMAG" class="block-color-pink" style="width:94px"><strong><mark class="highlight-gray_background">Flags</mark></strong></td><td id="JJhB" class="block-color-pink" style="width:816px"><strong><mark class="highlight-gray_background">Description</mark></strong></td></tr><tr id="79dfca63-b62a-4664-b49d-0c04c4d62b55"><td id="MMAG" class="" style="width:94px">-0</td><td id="JJhB" class="" style="width:816px">Terminate the arguments with null character (helps to handle spaces in the argument)</td></tr><tr id="8fdf1b01-b0df-4461-a3e4-5fe45c3132e6"><td id="MMAG" class="" style="width:94px">-a file</td><td id="JJhB" class="" style="width:816px">Allows xargs to read item from a file</td></tr><tr id="1a38a175-a7ae-46d5-a681-5e0778d4e1f9"><td id="MMAG" class="" style="width:94px">-d delimiter</td><td id="JJhB" class="" style="width:816px">Specifies the delimiter to be used when differentiating arguments in stdin</td></tr><tr id="8be14b41-4623-46fc-88d1-3e2317c16c00"><td id="MMAG" class="" style="width:94px">-L int</td><td id="JJhB" class="" style="width:816px">Specifies the max number of non-blank inputs per command line</td></tr><tr id="3e78f6d7-dd50-4e7d-a611-f59298a04843"><td id="MMAG" class="" style="width:94px">-s int</td><td id="JJhB" class="" style="width:816px">Buffer size you allocate, sets max-chars for command, includes initial args and terminating nulls Default: 128kB </td></tr><tr id="043616e3-6418-40b5-8743-be7d8a270048"><td id="MMAG" class="" style="width:94px">-x</td><td id="JJhB" class="" style="width:816px">Exits the command execution if the size specified is exceeded (For security purposes)</td></tr><tr id="00b1ea55-980b-4ad4-8988-14a81d83639b"><td id="MMAG" class="" style="width:94px">-E str</td><td id="JJhB" class="" style="width:816px">Specifies the end-of-file string (in case you are reading arguments from a file)</td></tr><tr id="fa20b975-633c-4f67-b266-7f2f3d7b01bf"><td id="MMAG" class="" style="width:94px">-I str</td><td id="JJhB" class="" style="width:816px">(Capital i) Replaces str occurrence in arguments with the one passed via stdin (like creating a variable to use later)</td></tr><tr id="7c6d061f-78d7-454c-9df8-f9b1414904f4"><td id="MMAG" class="" style="width:94px">-p</td><td id="JJhB" class="" style="width:816px">Prompt the user before running any command as a token of confirmation</td></tr><tr id="c494cbf8-5690-4558-b30c-19e3dabe5c1e"><td id="MMAG" class="" style="width:94px">-r</td><td id="JJhB" class="" style="width:816px">If the standard input is blank (i.e. no arguments passed) then it won&#x27;t run the command</td></tr><tr id="fceb8f85-7e78-4290-ad0e-65d0fbcea9b1"><td id="MMAG" class="" style="width:94px">-n int</td><td id="JJhB" class="" style="width:816px">Sets max args from command input, after max args limit is reached, loops rest args into new command line with same flags</td></tr><tr id="b8dc509e-6749-4bce-bfed-b5a677cb66ad"><td id="MMAG" class="" style="width:94px">-t</td><td id="JJhB" class="" style="width:816px">verbose; (Print the command before running it), Note: This won&#x27;t ask for a prompt</td></tr></tbody></table><div id="b331f35c-213d-4d1d-9ea7-9fb1dc9c3dc8" class="column-list"><div id="0c3ec275-9a1e-4a70-bdd0-627942ea03c7" style="width:25%" class="column"><ul id="7353b459-cc3a-4674-953d-96bc77364af7" class="bulleted-list"><li style="list-style-type:disc">To run multiple commands with xargs in one line?</li></ul></div><div id="4dfa4964-b598-49af-b46d-71afc60607d6" style="width:100%" class="column"><figure id="dbb8b7aa-da05-44d1-b408-5eb5d948f071" class="image"><a href="https://i.imgur.com/xPuPvIa.png"><img style="width:768px" src="https://i.imgur.com/xPuPvIa.png"/></a></figure></div></div><p id="8466b32a-f21a-4cd9-9bfa-27a1bce362f5" class="">define a variable <em>argVar</em> to use later in the 2 commands I ran with <mark class="highlight-pink"><code>bash -c</code></mark></p><div id="33c94313-7183-4ac9-acec-62e63732c8b1" class="column-list"><div id="9448d1d8-14d5-4c32-a72f-33bc983b4348" style="width:31.25%" class="column"><ul id="daa8a3ed-ab29-495b-918f-2690f784f770" class="bulleted-list"><li style="list-style-type:disc">Use xargs with conjunction to find a command to enhance the search results </li></ul></div><div id="3cba17bc-04d1-4e48-b5e1-e43ad07fa3ae" style="width:93.75%" class="column"><figure id="2aecf50a-7fdb-4e37-aac3-9a90dcb679b7" class="image"><a href="https://i.imgur.com/uHTexik.png"><img style="width:768px" src="https://i.imgur.com/uHTexik.png"/></a></figure></div></div><p id="1ce80e4e-fba9-467e-a269-b19012c0b4de" class="">Note: The find command prints results to standard output by default, so the <mark class="highlight-pink"><code>-print</code></mark> option is normally not needed, but <code>-</code><mark class="highlight-pink"><code>print0</code></mark> separates the filenames with a \0 (NULL) byte so that names containing spaces or newlines can be interpreted correctly</p><div id="e063d462-94d2-4482-bd52-59130b967435" class="column-list"><div id="fbdf6287-6cfd-447e-bb3d-2fdd0b570d2c" style="width:68.75%" class="column"><ul id="65f5fd2f-e8f3-4c31-bbc2-ca13cb25c2f0" class="bulleted-list"><li style="list-style-type:disc">You can use xargs command to grep a text from any file in any directory meeting a specific pattern/criteria.</li></ul><p id="e4ce4790-5d3a-4ffd-b918-50a4d8a0a703" class="">You can see that xargs is used to grep a pattern matching anything starting with r with any bunch of characters [:alnum:] and ending with 0. Which returned me this string. </p></div><div id="b94ac948-0a6f-46a3-955a-ee3efc019339" style="width:68.75%" class="column"><figure id="9ac6e795-4615-47b4-a5f8-5f0e6127fd11" class="image"><a href="https://i.imgur.com/MSx79lO.png"><img src="https://i.imgur.com/MSx79lO.png"/></a></figure></div></div><p id="13b78652-7c0f-401d-ba12-926ab52949ca" class="">Note: If the xargs is having the same flags, that can also be interpreted by the following module, in that case you need not worry, because the flags used after the command are the one&#x27;s that are interpreted. </p><p id="3dfb60f9-c568-4e07-b5f7-66127abb0a1a" class=""><span style="border-bottom:0.05em solid"><strong>A note on XARGS (and almost every command line module in linux/unix system)</strong></span></p><p id="e0588cbf-0553-4ef7-8ba7-54f74cac85b4" class="">Room: <a href="https://tryhackme.com/room/linuxprivesc">Linux PrivEsc | Task 10</a>; Gtfobins said, &quot;tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh&quot;</p><p id="bf792763-2588-44d1-9395-db1d11a7c3ee" class="">The catch in the challenge was, sudo was not given to tar, SUID permissions were given to a file not allowed to be edited by any other user (owner: root). So that script has to run with root privileges. We could make the files in that directory in flag format, which tar could interpret as a flag. In our case, tar would start scanning the directory to get the overview of the files to compress and combine them, it will interpret those flags and give us root shell. The point is, I found difficulty in creating those files (via command line) with -- appended to them. I tried xargs but didn&#x27;t work. I then found an article <a href="https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/">here</a>, which helped me and I solved the challenge. Then when I started with the 5th phase of hacking(Covering Tracks). I couldn&#x27;t seem to delete those earlier created <mark class="highlight-pink"><code>--checkpoint</code></mark> files with <mark class="highlight-pink"><code>rm</code></mark>. I tried for an hour or so, but couldn&#x27;t and left. Well, I didn&#x27;t knew this, until I started reading documentations and man pages. Call it an instinct or just luck that I found a way to <em>escape command line flags as a positional argument</em>. Why all this theory, when I can simply get to this point? Well, I believe that it&#x27;s just a better way of learning, when you can append your learnings with an event that had previously occurred. So later, I was able to remove the files using the following command. <mark class="highlight-pink"><code>rm -- --checkpoint=1</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>rm -- --checkpoint-action=exec=sh</code></mark></p><div id="cc0d4870-1d72-4289-8769-ffb601f41465" class="column-list"><div id="87888c88-6be1-49f2-bee2-18bb1b562b99" style="width:112.5%" class="column"><p id="b88c6444-b077-4e6c-a841-9255c6c4eb9d" class="">Notice something different? I was able to escape the following flags using an empty flag notation. This padding technique works in ALMOST EVERY command line module available for linux, unix systems. </p><p id="4a32afa8-2765-4727-9d5c-10ce93b4a4ab" class="">rm didn&#x27;t interpret the files inside dir as a flag bc of -- padding. </p></div><div id="6f510af5-7c30-4375-979b-4399641bb889" style="width:87.5%" class="column"><figure id="0a944488-f15b-4aba-85c9-2607cc2a6142" class="image"><a href="https://i.imgur.com/EXzCCKT.png"><img src="https://i.imgur.com/EXzCCKT.png"/></a></figure></div></div><figure id="cf8bdaa0-f813-42e1-acaf-0f425a846c06" class="image"><a href="https://i.imgur.com/3ZpKZJi.png"><img src="https://i.imgur.com/3ZpKZJi.png"/></a></figure><p id="722fd62f-1ab4-43a3-930c-a8fe84184232" class="">I gave the padding it still showed me an error. Well even if you specify that padding to escape the flags there are &#x27;/&#x27;s inside this string, which makes <mark class="highlight-pink"><code>touch</code></mark> interpret them as create the file <em>bash</em>, inside <em>bin</em> directory that is inside, some <em>--checkpoint-action=exec=</em> directory. You may try using \/bin\/bash to escape the slashes, but that won&#x27;t work either, because files can&#x27;t contain slashes in their name. We can easily bypass this by just using bash or sh instead of specifying the whole path, but make sure that your path is set to normal. Moving forward...</p><figure id="1fb06653-da18-40e0-99b5-acc160058f66" class="image"><a href="https://i.imgur.com/DiR4uSM.png"><img src="https://i.imgur.com/DiR4uSM.png"/></a></figure><div id="19f98d18-8140-43f5-8e88-b81b6980486e" class="column-list"><div id="cf5adde1-d8d3-48a4-b641-b71596302a88" style="width:118.75%" class="column"><p id="523c0e33-5f7a-47f0-8568-e7ae88099ec1" class="">Focus on -n2 used after xargs. 2 arguments at once, in first loop <mark class="highlight-pink"><code>touch -- --checkpoint=1</code></mark>, then <mark class="highlight-pink"><code>touch -- --checkpoint-action=exec=sh</code></mark>. try running tar.</p><p id="a17a16e9-c146-41be-9721-baf82ce3148a" class="">The 2 flag files created were interpreted as flags and then tar had nothing to compress so let&#x27;s create a testfile...</p><p id="c25e44fa-ac11-4c8a-8c4b-4107c9a9aa55" class="">Bingo, we got a shell (not as root, because that was executed as my user. Could give us root, if ran as it).</p></div><div id="d40ff4c4-25a2-466f-bdcc-dd6edcbb272a" style="width:50%" class="column"><figure id="79371ef5-737b-4c96-978e-3ab678a68854" class="image"><a href="https://i.imgur.com/x4N7au9.png"><img src="https://i.imgur.com/x4N7au9.png"/></a></figure><figure id="75f6c620-a824-470b-b995-ba241a7b566a" class="image"><a href="https://i.imgur.com/lx38MfJ.png"><img src="https://i.imgur.com/lx38MfJ.png"/></a></figure></div></div></details></li></ul><ul id="564b5efb-cd32-4c5a-afc3-48df72847eaa" class="toggle"><li><details open=""><summary><strong>sort and uniq</strong></summary><p id="214b29a1-0075-4ea8-9785-91a0dbb36574" class=""><strong><span style="border-bottom:0.05em solid">uniq command</span></strong></p><div id="16d802d8-60ff-43be-b00a-74ce3f0b7214" class="column-list"><div id="d0e45b9b-4c26-462a-bad4-3929f1e09609" style="width:87.5%" class="column"><p id="c1014936-604a-451f-b824-ac7a56b8244d" class="">Unique command filters the output (from either a file or stdin) to remove any duplicates, returning all unique lines and shorter output to focus on, greatly reducing stress on searching through files with repeated line outputs. <strong><strong><strong><strong><strong><strong><strong><strong><strong>However, </strong></strong></strong></strong></strong></strong></strong></strong></strong>uniq ONLY identifies duplicate lines if they are adjacent to each other. So we need to <mark class="highlight-pink"><code>sort</code></mark> lines first.</p><table id="e2f3ab94-8e96-4dcc-91ff-53e6e5607a9f" class="simple-table"><tbody><tr id="a542508f-662b-4db4-aed1-a02e2c86520d"><td id="&lt;nwi" class="block-color-pink" style="width:57px"><strong>Flags</strong></td><td id="X]IX" class="block-color-pink" style="width:353px"><strong>Description</strong></td></tr><tr id="2e14ac02-3b96-4621-9a83-a9fb10ed9bd6"><td id="&lt;nwi" class="" style="width:57px">-c</td><td id="X]IX" class="" style="width:353px">Counts the occurrences of every line in file or stdin</td></tr><tr id="d75d162d-7902-431d-8e56-9967c8aa10dc"><td id="&lt;nwi" class="" style="width:57px">-d</td><td id="X]IX" class="" style="width:353px">Only prints the lines that are repeated, not unique</td></tr><tr id="482dd207-d119-46a0-a276-188c71803f31"><td id="&lt;nwi" class="" style="width:57px">-u</td><td id="X]IX" class="" style="width:353px">Only prints lines that are already uniq</td></tr><tr id="2815e3f5-6f6b-4561-a937-66409bfc2869"><td id="&lt;nwi" class="" style="width:57px">-i</td><td id="X]IX" class="" style="width:353px">Ignores case (Default is case-sensitive)</td></tr></tbody></table><p id="8969cba0-700e-4123-8ef5-d82de70d8f63" class=""><span style="border-bottom:0.05em solid"><strong>sort command</strong></span></p><p id="24ebb47f-5aa8-4117-800c-70bfd5e7864b" class="">sort command sorts the lines alphabetically and numerically, automatically, only needing you to pipe the stdin into sort command.</p><p id="fe490397-a8f0-435e-87dd-b845e75762d4" class="">To remove any duplicate lines, <mark class="highlight-pink"><code>sort</code></mark> the lines and then use <mark class="highlight-pink"><code>uniq</code></mark> on the output. <mark class="highlight-pink"><code>sort file.txt | uniq</code></mark></p></div><div id="7208eb43-7808-484b-be58-241e8b00399c" style="width:87.49999999999999%" class="column"><figure id="f3c7fda5-779a-411c-8e41-1a55cfaa1775" class="image"><a href="https://i.imgur.com/1qv9dGO.png"><img style="width:624px" src="https://i.imgur.com/1qv9dGO.png"/></a></figure><table id="804ab027-76bc-489f-9c80-685dfe52a8ac" class="simple-table"><tbody><tr id="7441f9a4-9204-4856-8aec-c5ed6169255f"><td id="~Zee" class="block-color-pink" style="width:70px"><strong>Flags</strong></td><td id="~ks{" class="block-color-pink" style="width:340px"><strong>Description</strong></td></tr><tr id="fffd25db-1ec8-4d75-8103-98e7f3231989"><td id="~Zee" class="" style="width:70px">-r</td><td id="~ks{" class="" style="width:340px">Sorts in reverse order</td></tr><tr id="5f57264e-967e-45b1-b661-46a989c9c38f"><td id="~Zee" class="" style="width:70px">-c</td><td id="~ks{" class="" style="width:340px">Checks if file is sorted, else, lists start of disorder</td></tr><tr id="ea3912ab-b469-44eb-b7a8-9c25766fe408"><td id="~Zee" class="" style="width:70px">-u</td><td id="~ks{" class="" style="width:340px">Sorts and removes duplicate lines</td></tr><tr id="4ba1a6b5-9090-40a3-9005-d53cde550874"><td id="~Zee" class="" style="width:70px">-o file</td><td id="~ks{" class="" style="width:340px">Saves into a output file</td></tr></tbody></table></div></div></details></li></ul></details></li></ul><ul id="093d9cba-39bc-41f0-8204-37a8eae7589d" class="toggle"><li><details open=""><summary><strong>cURL (crawl URL)</strong></summary><p id="b606c77c-2ffe-4e96-bc3a-b5e897bd354e" class="">cURL outputs data of URLs webpage in raw format; download pictures from a direct google search with grep and pattern matching iframes; get an offline copy of a webpage/download large files/activate webshells (for a reverse connection) Syntax: <code><mark class="highlight-pink">curl https... </mark></code>curl works on HTTP/HTTPS/FTP protocol <strong>AND</strong> Telnet, POP, IMAP, +. ; use curl as an alternative wget, while transferring privesc scripts from attack box to the host system</p><table id="443fc93a-f1f0-44b2-b586-7638a73ddedd" class="simple-table"><tbody><tr id="260895eb-f8f6-4e56-bc0b-03130540a2c9"><td id="Rm{o" class="" style="width:98px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="`A&gt;z" class="" style="width:836px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="6a2113b5-7212-4524-b3e1-2caee9e5b589"><td id="Rm{o" class="" style="width:98px">-#</td><td id="`A&gt;z" class="" style="width:836px">Displays a progress meter for you to know how much the download has progressed or use --silent flag for a silent crawl</td></tr><tr id="da3a1555-566c-4138-abc4-4ef6409224d7"><td id="Rm{o" class="" style="width:98px">-o</td><td id="`A&gt;z" class="" style="width:836px">Saves the file downloaded with the name given following the flag</td></tr><tr id="ca481438-458d-4c39-b6d1-b1bbfb155546"><td id="Rm{o" class="" style="width:98px">-O</td><td id="`A&gt;z" class="" style="width:836px">Saves the file with the name it was saved on the server</td></tr><tr id="6ba588d7-b704-4284-935b-c5e83a9b2597"><td id="Rm{o" class="" style="width:98px">-C -</td><td id="`A&gt;z" class="" style="width:836px">Resumes your broken download without specifying an offset</td></tr><tr id="1d439a74-f236-43d1-b5e9-1b330371b190"><td id="Rm{o" class="" style="width:98px">--limit-rate</td><td id="`A&gt;z" class="" style="width:836px">Limits the download/upload rate to somewhere near the specified range (Units in 100K,100M,100G)</td></tr><tr id="6839cd67-d7a5-40ed-8cb5-d65ce853d8d7"><td id="Rm{o" class="" style="width:98px">-u</td><td id="`A&gt;z" class="" style="width:836px">Provides user authentication (Format: -u user:password)</td></tr><tr id="ee93f315-48a4-4fe3-8c7d-3e2983a0b34c"><td id="Rm{o" class="" style="width:98px">-T</td><td id="`A&gt;z" class="" style="width:836px">Helps in uploading the file to some server (In our case php-reverse-shell)</td></tr><tr id="812a0c1a-79c3-43d4-b577-fb8e5ceb4013"><td id="Rm{o" class="" style="width:98px">-x</td><td id="`A&gt;z" class="" style="width:836px">Specifies proxy server if you have to view the page through a PROXY (-x <a href="http://proxy.server.com">proxy.server.com</a> user:password (Authentication ))</td></tr><tr id="15995171-7955-40a3-b335-6be1b91699b6"><td id="Rm{o" class="" style="width:98px">-I</td><td id="`A&gt;z" class="" style="width:836px">(Caps i) Queries the header and not the webpage</td></tr><tr id="7e8d4687-7282-4a98-b2b6-302761c8fabc"><td id="Rm{o" class="" style="width:98px">-A</td><td id="`A&gt;z" class="" style="width:836px">Specifies user agent to make request to the server</td></tr><tr id="8949086b-e8d1-42c9-9d75-6f8b6005e169"><td id="Rm{o" class="" style="width:98px">-L</td><td id="`A&gt;z" class="" style="width:836px">Tells curl to follow redirects</td></tr><tr id="9fb4428d-b818-4fc2-8dfa-3fd416412b79"><td id="Rm{o" class="" style="width:98px">-b</td><td id="`A&gt;z" class="" style="width:836px">Allows you to specify cookies while making a curl request (Cookie should be in the format &quot;NAME1=VALUE1;NAME2=VALUE2&quot;)</td></tr><tr id="4419301c-1d37-4990-b362-902fdd88062c"><td id="Rm{o" class="" style="width:98px">-d</td><td id="`A&gt;z" class="" style="width:836px">Used to POST data to the server (generally used for posting form data)</td></tr><tr id="3abaf626-84bb-4de3-8dbe-d7ce4a8fed71"><td id="Rm{o" class="" style="width:98px">-X</td><td id="`A&gt;z" class="" style="width:836px">Specifies the HTTP method on the URL (GET,POST,TRACE,OPTIONS)</td></tr></tbody></table><div id="1a2dc5cb-e37c-4896-95f8-1a750b3167fc" class="column-list"><div id="bd2049f4-dc70-44e1-90a0-2968afd01fba" style="width:25%" class="column"><p id="de45bb0b-a2b2-4b92-a322-3d6796e13b2b" class="">Continuing a download: set the --continue-at &lt;offset&gt; to a - (hyphen; to continue download by automatically identifying the offset)</p><p id="cb507289-69e2-4079-965c-9d4de64ab7eb" class="">Saving the file with the name it was saved on the server.</p></div><div id="4018e5bb-d3dd-4206-a480-d8ac01968093" style="width:100%" class="column"><figure id="5820c7dc-916b-4640-bd6b-82127e24347f" class="image"><a href="https://i.imgur.com/P7mYzir.png"><img style="width:768px" src="https://i.imgur.com/P7mYzir.png"/></a></figure><figure id="14cf0264-5abe-49ed-b97d-f93bf541ec05" class="image"><a href="https://i.imgur.com/msy0Li2.png"><img src="https://i.imgur.com/msy0Li2.png"/></a></figure></div></div></details></li></ul><ul id="daedb31b-79e2-4762-8401-73d602819971" class="toggle"><li><details open=""><summary><strong>wget</strong></summary><p id="32e13b6a-cfb7-4efc-8428-e927e9859b92" class="">the command line way of downloading stuff; Note: wget supports ftp, http and https; Syntax: <mark class="highlight-pink"><code>wget protocol://url.com/</code></mark></p><table id="c53d7e91-f320-4e68-aca7-4e00491033c3" class="simple-table"><tbody><tr id="da290d6e-f246-42eb-bfe7-98b46d0db596"><td id="TjCi" class="" style="width:166px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="Bb`O" class="" style="width:723px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="00dde755-de5b-4a41-882d-2f9c07d8686d"><td id="TjCi" class="" style="width:166px">-b</td><td id="Bb`O" class="" style="width:723px">Background the downloading process</td></tr><tr id="97be1341-c733-4824-a537-1e5adf15a77c"><td id="TjCi" class="" style="width:166px">-c</td><td id="Bb`O" class="" style="width:723px">Continues to/looks for partially downloaded file in the dir and starts appending; takes no argument</td></tr><tr id="4b113dc6-af50-4b37-a7c2-09a90e7d6670"><td id="TjCi" class="" style="width:166px">-t int</td><td id="Bb`O" class="" style="width:723px">Specifies retries to the URL</td></tr><tr id="9ec48c8b-2831-4a56-9e36-26a935180dd0"><td id="TjCi" class="" style="width:166px">-O download.txt</td><td id="Bb`O" class="" style="width:723px">Specifies the output name of downloaded file</td></tr><tr id="5fafef55-8af0-4d32-a8bf-ccc096f52c0b"><td id="TjCi" class="" style="width:166px">-o file</td><td id="Bb`O" class="" style="width:723px">Overwrites the logs into another file</td></tr><tr id="c51c288d-06f5-4cf2-b9d2-870c9dd9703f"><td id="TjCi" class="" style="width:166px">-a file</td><td id="Bb`O" class="" style="width:723px">Append the logs into already existing file without deleting previous contents</td></tr><tr id="6fe215ac-f46a-4684-809a-6e8556e335b3"><td id="TjCi" class="" style="width:166px">-i file</td><td id="Bb`O" class="" style="width:723px">Read the list of URLs from a file</td></tr><tr id="4c13429a-cc1a-4a5e-b547-b0c43d835bba"><td id="TjCi" class="" style="width:166px">--user=username</td><td id="Bb`O" class="" style="width:723px">Give a login username (Use --ftp-user and --http-user if doesn&#x27;t work)</td></tr><tr id="300ae252-78de-4831-893e-27017c29a65f"><td id="TjCi" class="" style="width:166px">--password=password</td><td id="Bb`O" class="" style="width:723px">Give a login password ( Use --ftp-password and --http-password if doesn&#x27;t work)</td></tr><tr id="28b4c16d-b495-4015-a110-fa9bbaf0e4c1"><td id="TjCi" class="" style="width:166px">--ask-password</td><td id="Bb`O" class="" style="width:723px">Ask for password prompt if login is necessary</td></tr><tr id="def4e1e5-ea05-4893-87e7-2d2d88a4eba5"><td id="TjCi" class="" style="width:166px">--limit-rate=10k</td><td id="Bb`O" class="" style="width:723px">Similar to curl (supports k and m notation for kB and mB respectively)</td></tr><tr id="84824320-03ec-4164-aec1-927ec4c6dce7"><td id="TjCi" class="" style="width:166px">-w=&lt;int&gt;</td><td id="Bb`O" class="" style="width:723px">Specifies the waiting time before the retrieval from a URL (Takes time in seconds)</td></tr><tr id="68b14505-f60e-43bb-a25e-a62eace7e426"><td id="TjCi" class="" style="width:166px">-T=&lt;int&gt;</td><td id="Bb`O" class="" style="width:723px">Timeout the retrieval after a specified amount of time (Takes time in seconds)</td></tr><tr id="aab16d40-96d0-4bd6-8725-d598e7ea2436"><td id="TjCi" class="" style="width:166px">-N</td><td id="Bb`O" class="" style="width:723px">Enables timestamping</td></tr><tr id="4446550f-4a2e-40c6-8fa7-1751c2402bfe"><td id="TjCi" class="" style="width:166px">-U</td><td id="Bb`O" class="" style="width:723px">Specifies the user-agent while downloading the file</td></tr></tbody></table></details></li></ul><ul id="1a09ecde-23bb-451c-a34c-cf1bcb2525f1" class="toggle"><li><details open=""><summary><strong>xxd</strong></summary><p id="25db2567-6934-400a-bda2-9f318955f6d7" class="">known for hexdumps or reverse; helps handle hex strings and hex digits; takes file input or passes input through piping/redirection</p><table id="eae299bf-d7d9-474e-af26-99d1eeafd185" class="simple-table"><tbody><tr id="6f58d513-c63a-4c4b-938c-988c06b92c43"><td id="fuV:" class="" style="width:78px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="DKyd" class="" style="width:858px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="e385a924-c15f-4ffc-b756-6c565493bf96"><td id="fuV:" class="" style="width:78px">-b</td><td id="DKyd" class="" style="width:858px">Gives binary representation instead of hexdump</td></tr><tr id="a585bf74-61f7-4941-9c6d-c64d84639a2a"><td id="fuV:" class="" style="width:78px">-E</td><td id="DKyd" class="" style="width:858px">Changes character encoding in the right-hand column from ASCII to EBCDIC (Extended Binary Coded Decimal Interchange)</td></tr><tr id="b880be1c-6c35-4cc0-b052-5b86393e213c"><td id="fuV:" class="" style="width:78px">-c int</td><td id="DKyd" class="" style="width:858px">Sets the number of bytes to be represented in one row (i.e. setting the column size in bytes; Default to 16)</td></tr><tr id="57c2760e-1476-4d5f-b77d-60e508ab7844"><td id="fuV:" class="" style="width:78px">-g</td><td id="DKyd" class="" style="width:858px">Sets how many bytes/octets should be in group i.e. separated by whitespace (default to 2 bytes; Set -g0 if no space is needed).</td></tr><tr id="69318280-579d-41fc-95f2-f8e432338a86"><td id="fuV:" class="" style="width:78px">-i</td><td id="DKyd" class="" style="width:858px">Output the hexdump in C include format (&#x27;0xff&#x27; integers)</td></tr><tr id="607f8937-8ad8-44f6-badc-39670be7e4ae"><td id="fuV:" class="" style="width:78px">-l</td><td id="DKyd" class="" style="width:858px">Specify the length of output (if the string is bigger than the length specified, hex of the rest of the string will not be printed)</td></tr><tr id="c4a917ca-8d4c-466c-a5aa-b48b684bdf89"><td id="fuV:" class="" style="width:78px">-p</td><td id="DKyd" class="" style="width:858px">Second most used flag; Converts the string passed into plain hexdump style(continuous string of hex bytes)</td></tr><tr id="3015bb1c-581d-4eef-b3e2-f13d2e466178"><td id="fuV:" class="" style="width:78px">-r</td><td id="DKyd" class="" style="width:858px">Most used flag, reverts the hexdump to binary(Interpreted as plain text).</td></tr><tr id="9a796488-ab83-4678-bdeb-156763a39bc5"><td id="fuV:" class="" style="width:78px">-u</td><td id="DKyd" class="" style="width:858px">Uses uppercase hex letters (default is lower case)</td></tr><tr id="767e6961-b436-4fce-9e81-32a001309a52"><td id="fuV:" class="" style="width:78px">-s</td><td id="DKyd" class="" style="width:858px">Seeks at offset </td></tr></tbody></table><div id="afbf5ba1-6366-4ae3-a54b-36f1115b85d6" class="column-list"><div id="158207fb-6321-41c3-9972-6275f2f63372" style="width:100%" class="column"><p id="9f2264fb-0a9e-4259-bd6d-0d7111c373fc" class="">Use of -E flag (For curious minds)</p><p id="9b81d9fd-75ed-4448-b849-646a77392d9e" class="">Seeking at offset from the end of the file.</p><p id="78066698-01f0-49f8-8698-f4b0f449c4cb" class="">By appending the offset&#x27;s value with a hyphen the command starts dumping from the end of the file. There is a difference between <mark class="highlight-pink"><code>-s +offset</code></mark> and <mark class="highlight-pink"><code>-s offset</code></mark> while seeking through stdin. If there is error while seeking offset through stdin, try redirecting stdin to a file and then perform hexdump with xxd </p></div><div id="f43a4bbc-94c3-4b54-b4d5-7748d79a2da2" style="width:100%" class="column"><figure id="f2660906-114a-4eb1-96fb-c1a362da26a7" class="image"><a href="https://i.imgur.com/qHNfVRk.png"><img src="https://i.imgur.com/qHNfVRk.png"/></a></figure><figure id="afc53f27-bce5-4876-94cd-f8acf63ee415" class="image"><a href="https://i.imgur.com/4iDbGqm.png"><img src="https://i.imgur.com/4iDbGqm.png"/></a></figure></div></div></details></li></ul><ul id="56156507-b813-4297-bf69-c2e4683012cc" class="toggle"><li><details open=""><summary><strong>Other Modules</strong></summary><p id="6ae8510b-68d0-41bb-bfc2-c742d4e0f089" class=""><strong>gpg command</strong> - <em>Sidenote: GPG(Gnu Privacy Guard) and PGP(Pretty Good Privacy) are 2 different types of encryption. PGP is based on RSA encryption, whereas GPG(open-source) is a re-write of PGP and by default uses AES encryption.</em></p><p id="aa7a23d7-3a78-4e5c-b22e-05db5266aaa6" class=""><strong>tar command</strong> - Whether it is a gzip archive or a bzip archive, encrypting and decrypting can be easily done by this tool. </p><p id="7b6369c3-7faa-4960-a4ac-479f75d79139" class=""><strong>id/pwd/uname commands</strong> </p><p id="41459715-d77b-4f06-ac0f-bac332c555bd" class=""><strong>ps/kill commands - </strong>List processes, and kill processes with PID. To know more about ps command you can find some help <a href="https://man7.org/linux/man-pages/man1/ps.1.html">here</a>.</p><p id="945f092c-403f-4f0a-9acd-88c11c658ccb" class=""><strong>netstat command - </strong>lists any network activity on the current system. Any ports that are open/listening/not-established, connections alternates to netstat command: i.e. <mark class="highlight-pink"><code>ss</code></mark> (socket statistics) command (lists port activity in real time).</p><p id="00bee60a-1319-470a-ad48-2465db0415b7" class=""><strong>less/more commands - </strong>alternate to open and read the file. more is an old command and less was built to better the more command. More has limited backward scrolling, less has forward and backward navigation including better search options (/); one more command to improve <mark class="highlight-pink"><code>less</code></mark> features, not installed by default on some linux distros, install with <mark class="highlight-pink"><code>sudo apt install most</code></mark></p><p id="9fe2be5d-2e20-40bb-a68d-754ebd59f21e" class=""><strong>diff command - </strong>compares chars byte-by-byte to find the difference between 2 files. Though ONLY 2 files at a time; alternate: comm compares 2 sorted files line by line; more focused on commonalities in between 2 files. </p><p id="fd639645-de46-453f-9b65-6a1cac07f6f0" class=""><strong>base64 command - </strong>encodes binary strings into text representations using the base64 encoding format</p><p id="23461441-edad-4731-a108-36c22f5d57c4" class=""><strong>tee command - </strong>reads from stdin and writes to the stdout and files as well.</p><p id="993341ba-44b0-4f36-ab20-7fb075fa240c" class=""><strong>file/stat commands - </strong>reads the file headers and tells you what the file actually is</p><p id="f10dae17-f4e4-4cbf-a75b-3a05371e500b" class=""><strong>export command - </strong>used to set the environment variables</p><p id="8ae0d6ca-52f9-4b92-8bc8-fa2c2f3e98cb" class=""><strong>reset command - </strong>if your terminal is not working properly but you can&#x27;t close the shell, <mark class="highlight-pink"><code>reset</code></mark> to get your shell back to normal.</p><p id="3a1093c8-8612-40a5-b484-5044b39766e0" class=""><strong>systemctl/service command -</strong><mark class="highlight-pink"><code>service</code></mark> command is a normal command to initialize services present in /etc/init.d, without making an admin worry about permanent system changes, <mark class="highlight-pink"><code>systemctl</code></mark> is a heavy command which can hinder with the default settings. </p></details></li></ul><h3 id="5c3ba8f2-41cc-42b7-8cc8-e8f41bae6295" class="block-color-purple_background"><mark class="highlight-purple_background">Nmap</mark></h3><ul id="610212d5-2857-4a77-be8c-678328cf1287" class="toggle"><li><details open=""><summary><strong>Intro</strong></summary><div id="b2518e4f-6e43-42b7-a4d9-25398cbf01a7" class="column-list"><div id="5c53680a-e74c-4701-9657-6c82445fe269" style="width:100%" class="column"><p id="4fac79fb-f48c-448a-a916-32a717617759" class="">To perform a security audit on an ip address: first, get an idea of the “landscape” we are attacking and establish which services are running on the targets. The first stage in establishing this “map” is called port scanning: A computer runs a network service by opening a networking construct called a “port” to receive the connection. Ports are necessary for making multiple network requests or having multiple services available. -eg when you load several webpages at once in a browser, the program must be able to determine which tab loads which web page. This is done by establishing connections to the remote webservers using different ports on your local machine. If you want a server to be able to run more than one service, you need a way to direct traffic to the appropriate service using ports. Network connections are made between two ports – an open port listening on the server and a randomly selected port on your own computer. The diagram shows when you connect to numerous websites at the same time, your computer opens up a different, high-numbered port (at random) for all its communications with the remote server.</p></div><div id="4ab80a63-687e-445d-8bcb-9ff181dad93d" style="width:100%" class="column"><figure id="7d6c49f8-1b66-4cf8-a709-8abf186c076e" class="image"><a href="https://i.imgur.com/3XAfRpI.png"><img style="width:432px" src="https://i.imgur.com/3XAfRpI.png"/></a></figure></div></div><p id="74d4c46a-ac6d-48e1-8653-00fb9dc61763" class="">Every computer has a total of 65535 available ports; however, many are registered as standard ports. eg, HTTP Webservice - nearly always port 80, HTTPS Webservice - port 443, Windows NetBIOS -port 139, and SMB - port 445. ImpNote: however, especially in a CTF setting, it’s possible for standard ports to be altered. If we do not know which of these ports a server has open, then we do not have hopes of successfully attacking the target; thus, it is crucial that we begin any attack with a port scan. This can be accomplished in a variety of ways – usually using the Nmap tool. Nmap can perform many different kinds of port scans – nmap will connect to each port of the target in turn. Depending on how the port responds, it can be determined as being open, closed, or filtered (usually by a firewall). Once we know which ports are open, we can then look at enumerating which services are running on each port – either manually, or more commonly using nmap. nmap is the industry standard: no other port scanning tool comes close to its functionality, It is extremely powerful – even more powerful with its scripting engine that scans for vulnerabilities, and in some cases performs the exploit directly</p><p id="ca9c98a3-68c3-451c-9213-8e882fd0fa02" class=""><strong>Nmap Switches - </strong>nmap is run from the terminal; can be accessed by typing <mark class="highlight-pink"><code>nmap</code></mark> into the terminal, followed by some &quot;switches&quot; </p></details></li></ul><ul id="82b32b52-b93b-4d00-84ac-d2915f33d1b8" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> Overview</summary><p id="ad153a11-f650-4102-be2d-4f9c53221477" class="">When port scanning with Nmap, three <strong>basic</strong> scan types: TCP Connect Scans (<mark class="highlight-pink"><code>-sT</code></mark>), SYN &quot;Half-open&quot; Scans (<mark class="highlight-pink"><code>-sS</code></mark>), UDP Scans (<mark class="highlight-pink"><code>-sU</code></mark>) <strong>Less common</strong> port scan types: TCP Null Scans (<mark class="highlight-pink"><code>-sN</code></mark>), TCP FIN Scans (<mark class="highlight-pink"><code>-sF</code></mark>), TCP Xmas Scans (<mark class="highlight-pink"><code>-sX</code></mark>)</p></details></li></ul><ul id="c3ca3826-2db7-4096-bea8-e9edd4846c80" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> TCP Connect Scans</summary><div id="02b1cb90-d4e4-4026-8569-44d8623596a5" class="column-list"><div id="5b26bc90-e7d8-4c01-8acf-035250dd7d0a" style="width:118.75%" class="column"><p id="deedf440-cad3-4e88-b1fb-c9c7dc9cc0f5" class="">TCP Connect scans (<mark class="highlight-pink"><code>-sT</code></mark>), be comfortable with the <em>TCP three-way handshake</em>. The three-way handshake consists of three stages. First, the connecting terminal (attacking machine, in this case) sends a TCP request to the target server with the SYN flag set. The server then acknowledges this packet with a TCP response containing the SYN flag, as well as the ACK flag. Finally, our terminal completes the handshake by sending a TCP request with the ACK flag set.</p><p id="e2c4ce00-3275-43d3-b912-8e5c2399702e" class="">A TCP Connect scan performs a three-way handshake with each target port in turn. Nmap tries to connect to each specified TCP port, and determines whether the service is open by the response it receives.</p></div><div id="7af9511d-f368-4e3d-ae17-958c58893117" style="width:81.24999999999999%" class="column"><figure id="a34ae5cb-73c5-45f8-9c27-cdd37c37bfa6" class="image"><a href="https://muirlandoracle.co.uk/wp-content/uploads/2020/03/image-2.png"><img src="https://muirlandoracle.co.uk/wp-content/uploads/2020/03/image-2.png"/></a></figure></div></div><figure id="db0891fb-b8b6-47a6-b001-eea7dbf85a52" class="image"><a href="https://i.imgur.com/ngzBWID.png"><img src="https://i.imgur.com/ngzBWID.png"/></a></figure><div id="7a866bfa-09eb-41e8-a008-baadf8d9d7b2" class="column-list"><div id="a4a997c3-9dcc-423c-8cc0-3ba88c7f1691" style="width:118.75%" class="column"><p id="ee942c1a-94f1-47a6-87c5-8e12a57b13d0" class="">eg, if a port is closed, <a href="https://tools.ietf.org/html/rfc793">RFC 793</a> states that:</p><p id="26e05f70-01f9-43a2-ae61-fc0a77c3004a" class=""><em>&quot;... If the connection does not exist (CLOSED) then a reset is sent in response to any incoming segment except another reset.  In particular, SYNs addressed to a non-existent connection are rejected by this means.&quot; </em>If Nmap sends a TCP request with the <em>SYN</em> flag set to a <em><strong>closed</strong></em> port, the target server will respond with a TCP packet with the <em>RST</em> (Reset) flag set. By this response, Nmap can establish that the port is closed. If the request is sent to an <em>open</em> port, the target will respond with a TCP packet with the SYN/ACK flags set. Nmap marks this port as being <em>open</em> (and completes the handshake by sending back a TCP packet with ACK set).</p><p id="2d62a470-a3b2-4034-a624-45df8dd240b7" class="">What if the port is open, but hidden behind a firewall?</p></div><div id="0bcdc8e5-f15a-4d1c-84ed-01222c221252" style="width:43.75000000000001%" class="column"><figure id="32305993-011d-4443-92d0-fee3cc09326f" class="image"><a href="https://i.imgur.com/vUQL9SK.png"><img src="https://i.imgur.com/vUQL9SK.png"/></a></figure></div></div><p id="63ce066a-fcb6-4559-9efc-bde5d7c7410e" class="">Many firewalls are configured to <strong>drop</strong> incoming packets. Nmap sends a TCP SYN request, and receives nothing back: the port is being protected by a firewall and thus the port is considered to be <em>filtered</em>. That said, it is easy to configure a firewall to respond with a RST TCP packet, making it extremely difficult/impossible to get an accurate reading of the target(s). eg, in IPtables for Linux, a version of the command:<code><mark class="highlight-pink">iptables -I INPUT -p tcp --dport &lt;port&gt; -j REJECT --reject-with tcp-reset </mark></code></p></details></li></ul><ul id="eef93f0f-cc35-44c5-bf94-4666e2a4d849" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> SYN Scans</summary><div id="d521b537-012f-44ea-a174-ffd23ecd1542" class="column-list"><div id="f6b20197-97ce-4a69-afaf-b02b0b87620b" style="width:75%" class="column"><p id="e4628e80-ad66-4fae-905e-4233b1969fa7" class="">Like TCP scans, SYN scans (<mark class="highlight-pink"><code>-sS</code></mark>) are used to scan the TCP port range of a target(s), however, they handle open ports differently. SYN scans are referred to as &quot;<em>Half-open&quot; </em>scans, or <em>&quot;Stealth&quot; </em>scans. Where TCP scans perform a full three-way handshake with the target, SYN scans send back a RST TCP packet after receiving a SYN/ACK from the server (this prevents the server from repeatedly trying to make the request). The sequence for scanning an <strong>open</strong> port looks like this:</p><figure id="a5638eed-58b7-43c7-9700-c74eebbb3ed9" class="image"><a href="https://i.imgur.com/bcgeZmI.png"><img src="https://i.imgur.com/bcgeZmI.png"/></a></figure><p id="b6a85c8d-fb94-47bb-ada8-ce9f3b7d3786" class="">Advantages for hackers: It can bypass old Intrusion Detection systems that look for a full three-way handshake, SYN scans are often not logged by applications listening on open ports; standard practice is to log a connection once it&#x27;s been fully established, Without having to complete (and disconnect from) a three-way handshake for every port, SYN scans are faster than a standard TCP Connect scan</p></div><div id="bbf69faa-1ee0-40fe-aec4-953beda0a465" style="width:56.249999999999986%" class="column"><figure id="71bd25cb-6b1e-4194-80ea-3905b183a901" class="image"><a href="https://i.imgur.com/cPzF0kU.png"><img src="https://i.imgur.com/cPzF0kU.png"/></a></figure></div></div><p id="2e2e91c5-6a25-41f5-a8fc-a367a83c7dff" class="">Disadvantages to SYN scans: require sudo permissions for Linux because SYN scans require creating raw packets only the root user can, Unstable services are sometimes brought down by SYN scans; problematic if a client has a production environment for the test.</p><p id="17807dac-d932-4bdf-8fbd-3a443e660079" class="">pros outweigh cons: Nmap defaults to SYN scans if run with sudo permissions<em>; </em><strong>without</strong> sudo, Nmap defaults to TCP Connect scan. When using a SYN scan to identify closed and filtered ports, the exact same rules as with a TCP Connect scan apply. If a port is closed, the server responds with a RST TCP packet. If the port is filtered by a firewall then the TCP SYN packet is either dropped, or spoofed with a TCP reset. SYN scans can also be made to work by giving Nmap the CAP_NET_RAW, CAP_NET_ADMIN and CAP_NET_BIND_SERVICE capabilities; however, this may not allow many of the NSE scripts to run properly.</p></details></li></ul><ul id="bf6098c7-962c-494d-9fdd-9555f49672de" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> UDP Scans</summary><p id="091e73fe-57dd-4cad-a7f5-f9925bd5a813" class="">Unlike TCP, UDP connections are <em>stateless</em>. Rather than initiating a back-and-forth &quot;handshake&quot; connection, UDP connections rely on sending packets to a target port and hoping that they make it. This makes UDP superb for connections relying on speed over quality, but the lack of acknowledgment makes UDP more difficult and slower to scan. The switch for a Nmap UDP scan is (<mark class="highlight-pink"><code>-sU</code></mark>)</p><p id="9f26bf33-6037-46c0-ae8f-b74fa251f55b" class="">When a packet is sent to an open UDP port, there should be no response. Nmap refers to the port as being <mark class="highlight-pink"><code>open|filtered</code></mark>. It suspects the port is open, but it could be firewalled. If it gets a UDP response (unusual), the port is marked as <em>open</em>. More commonly there is no response, in which case the request is sent a second time as a double-check. If there is still no response the port is marked <mark class="highlight-pink"><code>open|filtered</code></mark> and Nmap moves on. When a packet is sent to a closed UDP port, the target should respond with an ICMP (ping) packet containing a message that the port is unreachable. This identifies closed ports, which Nmap marks as such and moves on.</p><p id="23e279d1-d440-4819-aea9-bb39d11fece8" class="">Due to difficulty in identifying whether a UDP port is actually open, UDP scans tend to be incredibly slow in comparison to the various TCP scans (about 20 minutes to scan the first 1000 ports with a good connection). It&#x27;s a good practice to run an Nmap scan with <mark class="highlight-pink"><code>--top-ports &lt;number&gt;</code></mark> enabled. eg, scanning <code><mark class="highlight-pink">nmap -sU --top-ports 20 &lt;target&gt;</mark></code><mark class="highlight-pink"> </mark>will scan the top 20 most commonly used UDP ports, resulting in a much more acceptable scan time.</p><p id="33e3c592-ee70-4ec0-95c9-4b948672358c" class="">When scanning UDP ports, Nmap usually sends completely empty requests -- just raw UDP packets. That said, for ports which are usually occupied by well-known services, it will instead send a protocol-specific payload which is more likely to elicit a response from which a more accurate result can be drawn.</p></details></li></ul><ul id="83dfdc43-3a2f-4aa3-8aab-01de45d6eca4" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> NULL, FIN and Xmas</summary><p id="a35c4aee-3d2c-42d6-a319-5de369ab8c63" class="">NULL, FIN and Xmas TCP port scans are less commonly used are interlinked and tend to be even stealthier than a SYN scan. All expect the target host to respond with a RST if the port is closed.</p><div id="d6560bc9-922d-444b-8f99-22f71f86fc02" class="column-list"><div id="92576eaa-1748-4ef6-b4d4-e95b1f748e36" style="width:100%" class="column"><p id="309862e9-1b68-4936-8abb-12d27c42d8e0" class="">NULL scans (<mark class="highlight-pink"><code>sN</code></mark>) send TCP requests with no flags set</p><p id="716389d1-4670-4a52-b0e9-4f836519fb9c" class="">FIN scans (<mark class="highlight-pink"><code>sF</code></mark>) work in an almost identically; instead of sending a completely empty packet, a request is sent with the FIN flag (usually to gracefully close an active connection)</p><p id="f83cddac-1446-4287-bef4-4b00b0f45d8a" class="">Xmas scans (<mark class="highlight-pink"><code>sX</code></mark>) send a malformed TCP packet; the flags set (PSH, URG, FIN) give it the appearance of a blinking christmas tree when viewed as a packet capture in Wireshark.</p><figure id="83c9c468-ef36-473d-90eb-2b214376d2e8" class="image"><a href="https://i.imgur.com/gKVkGug.png"><img src="https://i.imgur.com/gKVkGug.png"/></a></figure></div><div id="82a22e8e-b4fc-4743-b2de-d8651d149363" style="width:100%" class="column"><figure id="83031aa3-ef50-4977-9aeb-6d637226c7b7" class="image"><a href="https://i.imgur.com/ABCxAwf.png"><img src="https://i.imgur.com/ABCxAwf.png"/></a></figure><figure id="a3607b26-9923-4e30-abbc-84ad3eadc0ec" class="image"><a href="https://i.imgur.com/gIzKbEk.png"><img src="https://i.imgur.com/gIzKbEk.png"/></a></figure></div></div><p id="f1aecd2f-25d7-4b3a-82af-7fbd6d6e1625" class="">The expected response for <em>open</em> ports with these scans is also identical and similar to a UDP scan. If the port is open, there is no response to the malformed packet. Unfortunately (as with open UDP ports), that is also<em> </em>an expected behavior if the port is protected by a firewall, so NULL, FIN, and Xmas scans will only identify ports as being <em>open|filtered</em>, <em>closed</em>, or <em>filtered</em>. If a port is identified as filtered with one of these scans, usually the target has responded with an ICMP unreachable packet. While RFC 793 mandates network hosts respond to malformed packets with an RST TCP packet for closed ports and don&#x27;t respond for open ports; this is not always the case. In particular, Microsoft Windows (and many Cisco network devices) are known to respond with an RST to any malformed TCP packet regardless of whether the port is open or not, resulting in all ports showing up as closed.</p><p id="8a480370-6400-47aa-a1d0-c9ca68a5d6b5" class="">The goal is firewall evasion. Many firewalls are configured to drop incoming TCP packets to blocked ports that have the SYN flag set thus blocking new connection initiation requests. By sending requests that without the SYN flag, we bypass this kind of firewall. Most IDS solutions are savvy to these scans, so don&#x27;t rely on them to be 100% effective when dealing with modern systems.</p></details></li></ul><ul id="762d4235-1fbc-40bc-b8c5-187e43d64cf5" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> ICMP Network Scanning</summary><p id="cba1de73-dab2-431c-8920-a3b2e6221299" class="">On first connection to a target network in a black box assignment, our first objective is to obtain a map of the network structure; we want to see which IP addresses contain active hosts and which do not. One way to do this is by using Nmap to perform a ping sweep. Nmap sends an ICMP packet to each possible IP address for the specified network. When it receives a response, it marks the IP address that responded as alive. This is not always accurate; however, it can provide something of a baseline. To perform a ping sweep, we use <code><mark class="highlight-pink">-sn</mark></code> in conjunction with IP ranges specified with either a hyphen (<mark class="highlight-pink"><code>-</code></mark>) or CIDR notation. i.e. scan the <mark class="highlight-pink"><code>192.168.0.x</code></mark><mark class="highlight-pink"> </mark>network: <mark class="highlight-pink"><code>nmap -sn 192.168.0.1-254</code></mark><mark class="highlight-pink"> </mark>or <mark class="highlight-pink"><code>nmap -sn 192.168.0.0/24</code></mark><mark class="highlight-pink"> </mark>The <mark class="highlight-pink"><code>-sn</code></mark> tells Nmap not to scan any ports, forcing it to rely primarily on ICMP echo packets (or ARP requests on a local network, if run with sudo or directly as the root user) to identify targets. In addition to the ICMP echo requests, the <mark class="highlight-pink"><code>-sn</code></mark> switch will also cause nmap to send a TCP SYN packet to port 443 of the target, as well as a TCP ACK (or TCP SYN if not run as root) packet to port 80.</p></details></li></ul><ul id="86b9cdcc-3646-4b44-9bc7-7784e09f9629" class="toggle"><li><details open=""><summary><strong>SE Scripts</strong> Overview</summary><p id="785f9d26-f8fb-4f57-a8a4-1abc75ca1b62" class="">The <strong>N</strong>map <strong>S</strong>cripting <strong>E</strong>ngine (NSE) is an incredibly powerful addition to Nmap, extending its functionality quite considerably. NSE Scripts are written in the <em>Lua </em>programming language: scans for vulnerabilities, automates exploits for them. The NSE is particularly useful for reconnaisance, with extensive categories in the script library:<mark class="highlight-pink"><code>safe</code></mark> Won&#x27;t affect the target <mark class="highlight-pink"><code>intrusive</code></mark><mark class="highlight-pink"> </mark>Not safe; likely to affect the target <code><mark class="highlight-pink">vuln</mark></code><mark class="highlight-pink"> </mark>Scan for vulnerabilities <mark class="highlight-pink"><code>exploit</code></mark> Attempt to exploit a vulnerability <mark class="highlight-pink"><code>auth</code></mark> Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously) <mark class="highlight-pink"><code>brute</code></mark> Attempt to bruteforce credentials for running services <mark class="highlight-pink"><code>discovery</code></mark> Attempt to query running services for further information about the network (e.g. query an SNMP server).</p></details></li></ul><ul id="66473a73-7cfd-4fa5-a525-8de55df58274" class="toggle"><li><details open=""><summary><strong>NSE Scripts</strong> Working with the NSE</summary><p id="df1bef33-d110-48d0-8659-147b19d63087" class=""><mark class="highlight-pink"><code>--script</code></mark> activates NSE scripts from the <mark class="highlight-pink"><code>vuln</code></mark> category using <mark class="highlight-pink"><code>--script=vuln</code></mark>. The other categories work the same. If <mark class="highlight-pink"><code>--script=safe</code></mark> is run, any applicable safe scripts will run against the target; only activates scripts that target an active service. To run a specific script, we would use <mark class="highlight-pink"><code>--script=&lt;script-name&gt;</code></mark>, e.g. <mark class="highlight-pink"><code>--script=http-fileupload-exploiter</code></mark>. Multiple scripts can be run simultaneously in this fashion by separating them by a comma. eg, <mark class="highlight-pink"><code>--script=smb-enum-users,smb-enum-shares</code></mark><mark class="highlight-pink">. </mark>Some scripts require arguments; eg, credentials: if they&#x27;re exploiting an authenticated vulnerability. These can be given with <mark class="highlight-pink"><code>--script-args</code></mark>. eg, <mark class="highlight-pink"><code>http-put</code></mark> script (used to upload files using the PUT method): takes two arguments, the URL to upload the file to, and the file&#x27;s location on disk: <code><mark class="highlight-pink">nmap -p 80 --script http-put --script-args http-put.url=&#x27;/dav/shell.php&#x27;,http-put.file=&#x27;./shell.php&#x27; </mark></code>Note that args are separated by commas, and connected to the corresponding script with periods; <mark class="highlight-pink"><code>&lt;script-name&gt;.&lt;argument&gt;</code></mark></p></details></li></ul><ul id="6d64009e-31c2-4471-91d7-7597289fde54" class="toggle"><li><details open=""><summary><strong>NSE Scripts</strong> Searching for Scripts</summary><div id="b0df9164-11ca-4e6d-898d-3dc1e0390125" class="column-list"><div id="136b23a3-961f-4f52-9439-d89f40e527c0" style="width:87.5%" class="column"><p id="8313fea3-f3b8-4eb6-af92-3e738eb82c8e" class="">Two options to find Nmap scripts which should ideally be used in conjunction with each other: The first is the page on the <a href="https://nmap.org/nsedoc/">Nmap website</a> containing a list of all official scripts. The second is the local storage on your attacking machine. Nmap stores its scripts on Linux at <code><mark class="highlight-pink">/usr/share/nmap/scripts</mark></code><mark class="highlight-pink">. </mark>All NSE scripts are stored in this directory by default; this is where Nmap looks for scripts when you specify them. Two ways to search for installed scripts: One is by using the <code><mark class="highlight-pink">/scripts/script.db</mark></code><mark class="highlight-pink"> </mark>file. Despite the extension, this isn&#x27;t actually a database so much as a formatted text file containing filenames and categories for each available script. Nmap uses this file to keep track of and utilize scripts for the scripting engine; however, we can also <em>grep </em>through it to look for scripts. eg, <mark class="highlight-pink"><code>grep &quot;ftp&quot; /usr/share/nmap/scripts/script.db</code></mark>.</p><p id="594b03b0-14dc-4eef-be85-1931519488db" class="">The second way to search for scripts is to use the <mark class="highlight-pink"><code>ls</code></mark> command. eg, we could get the same results as in the previous screenshot by using <mark class="highlight-pink"><code>ls -l /usr/share/nmap/scripts/*ftp*</code></mark>: Note the use of asterisks (<mark class="highlight-pink"><code>*</code></mark>) on either side of the search term. The same techniques can also be used to search for categories of script. eg,<mark class="highlight-pink"><code>grep &quot;safe&quot; /usr/share/nmap/scripts/script.db</code></mark></p></div><div id="91bc7acc-eb76-4c4b-aa22-93c15ad199af" style="width:93.74999999999999%" class="column"><figure id="4c3eb7e3-c228-4260-b102-9ba1aff06048" class="image"><a href="https://i.imgur.com/aJdVSAP.png"><img src="https://i.imgur.com/aJdVSAP.png"/></a></figure><figure id="bc920978-9b2f-4579-a8c5-a0d06dbce1ab" class="image"><a href="https://i.imgur.com/ijAhZsy.png"><img src="https://i.imgur.com/ijAhZsy.png"/></a></figure><figure id="f6daeb04-24dd-45f5-a476-8ceefe609e7a" class="image"><a href="https://i.imgur.com/7GV9Wzi.png"><img src="https://i.imgur.com/7GV9Wzi.png"/></a></figure><figure id="83a84474-1802-46c7-9fc5-77962f97f82d" class="image"><a href="https://i.imgur.com/352GgTj.png"><img src="https://i.imgur.com/352GgTj.png"/></a></figure></div></div><p id="53a9bd75-ed51-44f3-ac40-51c97490adfc" class=""><strong><span style="border-bottom:0.05em solid">Installing New Scripts</span></strong></p><p id="283db68d-533f-4962-94cf-b1d8b8e09800" class="">If a script is missing in the <mark class="highlight-pink"><code>scripts</code></mark> dir locally: a standard <mark class="highlight-pink"><code>sudo apt update &amp;&amp; sudo apt install nmap</code></mark> should fix this; however, it&#x27;s possible to install the scripts manually by downloading the script from Nmap <mark class="highlight-pink"><code>sudo wget -O /usr/share/nmap/scripts/&lt;script-name&gt;.nse https://svn.nmap.org/nmap/scripts/&lt;script-name&gt;.nse</code></mark>. Followed by <mark class="highlight-pink"><code>nmap --script-updatedb</code></mark>, which updates the <mark class="highlight-pink"><code>script.db</code></mark> file to contain the newly downloaded script. Note that you would require the same &quot;updatedb&quot; command if you were to make your own NSE script and add it into Nmap; a more than manageable task with some basic knowledge of Lua.</p></details></li></ul><ul id="0146b156-d527-422e-a7a3-9be6104b276d" class="toggle"><li><details open=""><summary><strong>Firewall Evasion</strong></summary><p id="89c7f512-b381-4cd6-9dd7-f3378afb699c" class="">Another common firewall configuration that is imperative to know how to bypass: A typical Windows host will, with its default firewall, block all ICMP packets. Ping is often used to manually establish the activity of a target and Nmap does the same by default, meaning Nmap registers a host with this firewall configuration as dead and does not bother scanning it at all. We need to get around this configuration. Nmap provides <mark class="highlight-pink"><code>-Pn</code></mark>, which tells Nmap to not bother pinging the host before scanning it, meaning Nmap will always treat the target host(s) as alive, effectively bypassing the ICMP block; however, it can potentially take a long time to complete the scan (if the host really is dead then Nmap will still be checking and double checking every specified port). Note: if already directly on the local network, Nmap can also use ARP requests to determine host activity.</p><ul id="0366692a-44b4-4eaf-9b36-0e5e2277dd5b" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>f</code></mark>: fragments packets (split into smaller pieces) making it less likely for the packets to be detected by a firewall or IDS.</li></ul><ul id="d7ec5945-4781-47b2-9e66-57f3e35fbb1a" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>-mtu &lt;number&gt;</code></mark>: Alternative to <mark class="highlight-pink"><code>f</code></mark>, provides more control over size of packets, accepts a maximum transmission unit size to use for the packets sent, which <em>must</em> be a multiple of 8.</li></ul><ul id="5e832f7d-a339-4cf3-8f40-64747b4543e7" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>-scan-delay &lt;time&gt;ms</code></mark>: adds a delay between packets sent, useful when network is unstable and for evading any time-based firewall/IDS triggers in place.</li></ul><ul id="6dad8e80-7118-4955-a25c-ea523f782b35" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>-badsum</code></mark>: used to generate an invalid checksum for packets; any real TCP/IP stack would drop this packet, but firewalls may potentially respond automatically, without bothering to check the checksum of the packet; this switch can determine the presence of a firewall/IDS.</li></ul></details></li></ul><h3 id="22b5acf5-c637-4368-a04a-05fec7fdb564" class="block-color-purple_background"><mark class="highlight-purple_background"><strong><strong>Extending Your Network</strong></strong></mark></h3><ul id="d0375061-5743-4189-8adc-33458287e34b" class="toggle"><li><details open=""><summary><strong>Introduction to Port Forwarding</strong></summary><div id="efbd6003-817f-4459-906b-0e14f834b867" class="column-list"><div id="1427ead8-47c0-4e46-9aac-da930c05595f" style="width:87.5%" class="column"><p id="e67882f0-b29b-49f2-87e9-636058302eed" class="">Port forwarding is essential in connecting applications and services to the Internet. Without port forwarding, applications and services are only available to devices within the same direct network. Within this network, the server with an IP address of &quot;192.168.1.10&quot; runs a web server on port 80. Only the two other computers on this network will be able to access it (intranet). If the administrator wanted the website to be accessible to the public using the Internet, they would have to implement port forwarding:</p><figure id="9b6bd633-8d12-4a2e-8598-c89b4f2999b2" class="image"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding.png"/></a></figure></div><div id="b4148775-c880-40fd-8502-678e1eb832bb" style="width:56.25%" class="column"><figure id="1cc4c1d9-08c2-404a-9705-da5e73f76416" class="image" style="text-align:right"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding-int.png"><img style="width:240px" src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding-int.png"/></a></figure><p id="6aa440cb-31ea-426e-9f9c-ae9173653cb3" class="">Network #2 can access the webserver running on Network #1 using the public IP address of Network #1 (82.62.51.70). Port forwarding opens specific ports. Firewalls determine if traffic can travel across these ports even if these ports are open by port forwarding. Port forwarding is configured at the router of a network.</p></div></div></details></li></ul><ul id="c06e32ae-d6e4-4524-9fba-0255616bb882" class="toggle"><li><details open=""><summary><strong>Firewalls 101</strong></summary><p id="a495b52b-cb2d-4f18-92e9-6c4307fe320d" class="">A firewall is a device within a network responsible for determining what traffic is allowed to enter and exit like border security for a network. An administrator can configure a firewall to <strong>permit</strong> or <strong>deny</strong> traffic from entering or exiting a network based on numerous factors such as: Where the traffic is coming from (has the firewall been told to accept/deny traffic from a specific network?), Where is the traffic going to (has the firewall been told to accept/deny traffic destined for a specific network?), What port is the traffic for (has the firewall been told to accept/deny traffic destined for port 80 only?), What protocol is the traffic using (has the firewall been told to accept/deny traffic that is UDP, TCP or both?)</p><p id="7524f6e9-172c-4478-a011-320e4e4adcd5" class="">Firewalls perform packet inspection to determine the answers to these questions. Firewalls come in all shapes and sizes. From dedicated pieces of hardware often found in large networks like businesses that can handle a magnitude of data to residential routers or software, firewalls can be categorized into 2 to 5 categories. Two primary categories of firewalls in the table below:</p><p id="00b8e0e2-89f4-40e3-b983-040e9ccd0625" class=""><span style="border-bottom:0.05em solid">Stateful</span>: uses the entire information from a connection; rather than inspecting an individual packet, it determines the behavior of a device based on the entire connection; it consumes many resources compared to stateless firewalls as the decision-making is dynamic. eg, a firewall could allow the first parts of a TCP handshake that would later fail. If a connection from a host is bad, it will block the entire device.</p><p id="a5156688-b295-41d2-b2b2-2c25c74a8d6e" class=""><span style="border-bottom:0.05em solid">Stateless</span>: uses a static set of rules to determine whether or not individual packets<strong> </strong>are acceptable. eg, a device sending a bad packet will not necessarily mean the entire device is blocked. These firewalls use fewer resources than alternatives but are much dumber. eg, these firewalls are only effective as the rules that are defined within them. If a rule is not exactly matched, it is effectively useless. However, these firewalls are great when receiving large amounts of traffic from a set of hosts (such as a Distributed Denial-of-Service attack)</p></details></li></ul><ul id="4b886bd9-2acf-43b7-bf74-f1cd6e66b416" class="toggle"><li><details open=""><summary><strong>VPN Basics</strong></summary><div id="5fc7302b-6104-49dd-9614-c513300d91dd" class="column-list"><div id="b7ba5782-841f-4328-9256-9a48fb2df02a" style="width:87.5%" class="column"><p id="f1aeaeb4-0e02-4841-b0de-7bbda372b00c" class="">A <strong>V</strong>irtual <strong>P</strong>rivate <strong>N</strong>etwork (<strong>VPN</strong>) is a technology that allows devices on separate networks to communicate securely by creating a dedicated path between each other over the Internet (tunnel). Devices connected in this tunnel form their own private network. eg, only devices within the same network (such as within a business) can directly communicate. However, a VPN allows two offices to be connected. Let&#x27;s take the diagram below, where there are three networks: Network #1 (Office #1); Network #2 (Office #2); Network #3 (Two devices connected via a VPN); The devices connected on Network #3 are still a part of Network #1 and Network #2 but also form together to create a private network, Network #3, that only devices that are connected via this VPN can communicate over.</p></div><div id="f3181306-2361-4299-99a5-386e620613b9" style="width:112.5%" class="column"><figure id="81cf4a9c-16ff-417c-9daa-71b584f8166b" class="image"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vpn1.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vpn1.png"/></a></figure><p id="ddc31f0c-b425-43c4-a84b-f721511c5bdd" class="">
</p></div></div><p id="448847b5-89c1-478f-aa0d-fe7b7e5cd638" class="">Other benefits: Allows networks in different geographical locations to be connected. eg. a business with multiple offices be benefitted by having access to resources like servers/infrastructure from another office. Offers privacy - VPNs use encryption to protect data meaning it can only be understood between devices it was being sent from and is destined for. Offers anonymity - Journalists and activists depend upon VPNs to safely report on global issues in countries where freedom of speech is controlled. Usually, your traffic can be viewed by your ISP and other intermediaries and can be tracked. The level of anonymity a VPN provides is only as much as how other devices on the network respect privacy. eg, a VPN that logs all of your data/history is essentially the same as not using a VPN in this regard.</p><p id="2a162827-817a-46b6-8d2d-4a258781e437" class="">Existing VPN technologies: <strong>PPP</strong> - used by PPTP to allow authentication and provide encryption of data. VPNs work by using a private key and public certificate like <strong>SSH</strong>. The key &amp; certificate must match for you to connect. This technology is not capable of leaving a network by itself (non-routable). <strong>PPTP</strong> - <strong>P</strong>oint-to-<strong>P</strong>oint <strong>T</strong>unneling <strong>P</strong>rotocol allows data from PPP to travel and leave a network. PPTP is very easy to set up and is supported by most devices, but it is weakly encrypted. <strong>IPSec - </strong>Internet Protocol Security encrypts data using the existing <strong>I</strong>nternet <strong>P</strong>rotocol (<strong>IP</strong>) framework. IPSec is difficult to set up, but if successful, it jas strong encryption and is supported on many devices.</p></details></li></ul><ul id="b6e5b7aa-2575-466e-b739-effcf6d20685" class="toggle"><li><details open=""><summary><strong>LAN Networking Devices</strong></summary><div id="4bdab86d-ee8f-465a-85a0-87d04bcc044b" class="column-list"><div id="4fdece1e-a000-46e9-966c-169d23e4a450" style="width:81.25%" class="column"><p id="eea06b7c-3f37-438b-9ee5-3080dc8819fb" class=""><span style="border-bottom:0.05em solid"><strong>What is a Router?</strong></span><strong> - </strong>A router connects networks and passes data between them using routing. Routing is the label given to the process of data traveling across networks. It involves creating a path between networks so data can be successfully delivered. Routers operate at Layer 3 of the OSI model and often feature an interactive interface like a website or console that allows an administrator to configure various rules such as port forwarding or firewalling. Routing is useful when devices are connected by many paths, like in the diagram, where the most optimal path is taken: Routers are dedicated devices and do not perform the same functions as switches.</p></div><div id="f945efc3-4bb5-4aeb-be1e-49997a6588d3" style="width:106.25%" class="column"><figure id="58465da3-607e-4e15-a30c-da1025df5302" class="image"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/intro-to-networking/what-is-the-internet/routing2.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/intro-to-networking/what-is-the-internet/routing2.png"/></a></figure><p id="8d5e8655-0f70-4841-8975-05bd4fdc1ef8" class="">Computer A&#x27;s network is connected to Computer B’s network by two routers in the middle. The question is: what path will be taken? Different protocols will decide what path should be taken, but factors include: which is the shortest? which is the most reliable? Which has the faster medium (e.g. copper or fibre)?</p></div></div><div id="49d94ee6-f3c0-4a90-becb-4eeeea7b99bd" class="column-list"><div id="d842c147-2c0a-4098-9828-9a8b93b90c30" style="width:93.75%" class="column"><p id="068805ac-1f02-4b97-95c3-8f1258e9894d" class=""><span style="border-bottom:0.05em solid"><strong>What is a Switch?</strong></span></p><p id="18316afc-7b9b-41f6-a8d5-69dda5771fbd" class="">A switch is a dedicated networking device responsible for providing a means of connecting to multiple devices. Switches can facilitate many devices (from 3 to 63) using Ethernet cables. They can operate at both layer 2 and layer 3 of the OSI model. However, these are exclusive in the sense that Layer 2 switches cannot operate at Layer 3. eg, Layer 2 switch in the diagram below: These switches will forward frames, these are no longer packets as the IP protocol has been stripped, onto the connected devices using their MAC address. These switches are solely responsible for sending frames to the correct device.</p><p id="ae982cd0-0756-4f0e-8141-936c5188d58e" class="">Layer 3 switches are more sophisticated than layer 2, as they can perform some responsibilities of a router. These switches will send frames to devices like layer 2 and route packets to other devices using the IP protocol.</p><p id="800aa467-08dd-4e0f-903b-168dce0f03db" class="">The diagram of a layer 3 switch in action has two IP addresses: 192.168.1.1, 192.168.2.1</p><p id="cd9217d4-d228-4189-8911-6532178a4a5a" class="">A technology called <strong>VLAN</strong> (<strong>V</strong>irtual <strong>L</strong>ocal <strong>A</strong>rea <strong>N</strong>etwork) allows specific devices within a network to be virtually split up. This split means they can all benefit from things such as an Internet connection but are treated separately. This network separation provides security because it means the rules in place determine how specific devices communicate with each other.</p><p id="fe181db2-bd34-41ae-852a-43fcb22f3244" class="">The &quot;Sales Department&quot; and &quot;Accounting Department&quot; will be able to access the Internet, but not able to communicate with each other (although they are connected to the same switch).</p></div><div id="c0f3b56f-d1d6-4c1e-90a0-05240ad9fb00" style="width:43.74999999999999%" class="column"><figure id="12da7f06-6a62-458e-8a25-5c36155fc4c4" class="image" style="text-align:right"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/layer2switch.png"><img style="width:240px" src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/layer2switch.png"/></a></figure><figure id="a30f35b8-6a71-479c-b3cd-093abd09eedf" class="image" style="text-align:right"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vlans.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vlans.png"/></a></figure></div></div></details></li></ul><h3 id="9e5ce8f3-53c3-4b16-a2d8-f26ea52e8c0d" class="block-color-purple_background"><strong>Web Enumeration</strong></h3><p id="581f194c-c997-42b9-b830-a4aafbc6e6a2" class=""><strong>1. Introduction to Gobuster</strong><div class="indented"><div id="835b356b-e3fd-47d7-8e6d-8b1a85619392" class="column-list"><div id="11d9ceaf-235a-42d7-bcb9-dd35106215e2" style="width:50%" class="column"><p id="4a69f58a-e364-4b86-9e2d-228fa5828ddc" class="">Gobuster is written in <a href="https://golang.org/">Go</a>, an open-source, low-level language developed by a team at Google and other contributors. </p><p id="27d6d19a-a104-4949-b426-d1789b24cab4" class="">Change the number of threads to 64 to increase scan speeds else Gobuster can be a little slow.</p></div><div id="e6805262-5593-4ce4-a810-016ef385b9d6" style="width:118.75%" class="column"><table id="dad2dba8-cd5d-48a3-9cb1-c1eee04c0d83" class="simple-table"><tbody><tr id="680037e7-28a4-4bcb-a7b1-782273092675"><td id="Gse`" class="" style="width:55px"><mark class="highlight-pink"><strong>Flag</strong></mark></td><td id="lqH_" class=""><mark class="highlight-pink"><strong>Long Flag</strong></mark></td><td id="bd^q" class="" style="width:311px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="ed3de388-ff35-40b3-8004-7b140a446dea"><td id="Gse`" class="" style="width:55px">-t</td><td id="lqH_" class="">--threads</td><td id="bd^q" class="" style="width:311px">Number of concurrent threads (default 10)</td></tr><tr id="6059741e-242e-4a7c-a33d-6548476242ce"><td id="Gse`" class="" style="width:55px">-v</td><td id="lqH_" class="">--verbose</td><td id="bd^q" class="" style="width:311px">Verbose output</td></tr><tr id="ebad9a1a-30f1-4702-9279-cea36048c429"><td id="Gse`" class="" style="width:55px">-z</td><td id="lqH_" class="">--no-progress</td><td id="bd^q" class="" style="width:311px">Don&#x27;t display progress</td></tr><tr id="6030ee0f-e2b4-4d9d-9b92-d89d814c9992"><td id="Gse`" class="" style="width:55px">-q</td><td id="lqH_" class="">--quiet</td><td id="bd^q" class="" style="width:311px">Don&#x27;t print the banner and other noise</td></tr><tr id="18c9528b-80db-4bf3-b837-6644dfa31fac"><td id="Gse`" class="" style="width:55px">-o</td><td id="lqH_" class="">--output</td><td id="bd^q" class="" style="width:311px">Output file to write results to</td></tr></tbody></table></div></div></div></p><ul id="1c3f4913-c7b6-4c15-9f45-7202bdb50d5e" class="toggle"><li><details open=""><summary><strong>1.1. Gobuster Modes</strong></summary><p id="fb55050d-be16-4eca-ab66-c8e71852fe4f" class="">Dirbuster has a <strong>dir mode</strong> allowing users to enumerate website directories, useful for penetration tests to see website directory structures. Often, directory structures of websites and web apps follow a certain convention, making them susceptible to bruteforcing using wordlists. <span style="border-bottom:0.05em solid"><strong>Gobuster </strong></span>allows you to scan websites and returns status codes which immediately lets outside users know if they can request the directory or not. Additional functionality of Gobuster is that it lets you search for files with the addition of a simple flag. To use &quot;dir&quot; mode, use <mark class="highlight-pink"><code>gobuster dir</code></mark><mark class="highlight-pink"> </mark>which tells Gobuster to perform a directory search. It has to be written like this else Gobuster will complain. After that, add the URL and wordlist using the <mark class="highlight-pink"><span style="border-bottom:0.05em solid"><code>-u</code></span></mark> and <mark class="highlight-pink"><code>-w</code></mark>: <mark class="highlight-pink"><code>gobuster dir -u http://10.10.10.10 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></mark></p><p id="18beae80-48a6-4faf-8859-eef27756056c" class="">Note: The URL is going to be the base path where Gobuster starts looking from. So the URL uses the root web directory. eg, in a Linux Apache installation, this is<em> /var/www/html</em>. If you have a &quot;<strong>products</strong>&quot; directory and you want to enumerate that directory, you&#x27;d set the URL as <em>http://10.10.10.10/</em><em><strong>products</strong></em>. Or think like <em>http://example.com/path/to/folder</em>. Notice I specified the protocol of HTTP. This is important and required. This is a very common, simple, and straightforward command for Gobuster.</p><div id="003a65be-6d69-42b7-8712-dc1d3a330620" class="column-list"><div id="befd7c27-048f-4dd5-95f5-41d2d3c879ab" style="width:56.25%" class="column"><table id="ec151b5d-68d0-4c95-a919-12dedc6ba7d4" class="simple-table"><tbody><tr id="357ba9c6-63ca-4054-9d18-48e7689947af"><td id="YG`&lt;" class="" style="width:53px"><mark class="highlight-pink"><strong>Flag</strong></mark></td><td id="_JHq" class="" style="width:139.28125px"><mark class="highlight-pink"><strong>Long Flag</strong></mark></td><td id="}ajE" class="" style="width:264.96875px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="8a3461e8-176c-441c-b650-d706455e6e6f"><td id="YG`&lt;" class="" style="width:53px">-c</td><td id="_JHq" class="" style="width:139.28125px">--cookies</td><td id="}ajE" class="" style="width:264.96875px">Cookies to use for requests</td></tr><tr id="b32c9596-75ba-456b-b131-c872b62e69b7"><td id="YG`&lt;" class="" style="width:53px">-x</td><td id="_JHq" class="" style="width:139.28125px">--extensions</td><td id="}ajE" class="" style="width:264.96875px">File extension(s) to search for</td></tr><tr id="bcf3ea72-d865-4109-9c8a-92f0d13e5eb4"><td id="YG`&lt;" class="" style="width:53px">-H</td><td id="_JHq" class="" style="width:139.28125px">--headers</td><td id="}ajE" class="" style="width:264.96875px">Specify HTTP headers, -H &#x27;Header1: val1&#x27; -H &#x27;Header2: val2&#x27;</td></tr><tr id="3f71b30e-130b-41b1-930f-c1732913af59"><td id="YG`&lt;" class="" style="width:53px">-k</td><td id="_JHq" class="" style="width:139.28125px">--no-tls-validation</td><td id="}ajE" class="" style="width:264.96875px">Skip TLS certificate verification</td></tr><tr id="6156af20-c855-47f9-8a33-821aea3db8d8"><td id="YG`&lt;" class="" style="width:53px">-n</td><td id="_JHq" class="" style="width:139.28125px">--no-status</td><td id="}ajE" class="" style="width:264.96875px">Don&#x27;t print status codes</td></tr><tr id="e77d68d2-7e88-437c-a8fb-5263091335fb"><td id="YG`&lt;" class="" style="width:53px">-P</td><td id="_JHq" class="" style="width:139.28125px">--password</td><td id="}ajE" class="" style="width:264.96875px">Password for Basic Auth</td></tr><tr id="c56c6810-86bc-41b8-bf30-6dafa25a610b"><td id="YG`&lt;" class="" style="width:53px">-s</td><td id="_JHq" class="" style="width:139.28125px">--status-codes</td><td id="}ajE" class="" style="width:264.96875px">Positive status codes</td></tr><tr id="e84f014a-8244-4a3a-b6ec-799e84277225"><td id="YG`&lt;" class="" style="width:53px">-b</td><td id="_JHq" class="" style="width:139.28125px">--status-codes-blacklist</td><td id="}ajE" class="" style="width:264.96875px">Negative status codes</td></tr><tr id="96ca0dc5-5a76-4611-8257-9f2f0993fc17"><td id="YG`&lt;" class="" style="width:53px">-U</td><td id="_JHq" class="" style="width:139.28125px">--username</td><td id="}ajE" class="" style="width:264.96875px">Username for Basic Auth</td></tr></tbody></table></div><div id="fd2b1c62-5c3f-432c-aea2-83876ee641e9" style="width:43.75%" class="column"><p id="3cacd352-fc6d-4ac8-9802-442b73684527" class=""><mark class="highlight-pink"><code>-x</code></mark> or <mark class="highlight-pink"><code>--extensions</code></mark> is commonly used to search for the contents of directories that you have already enumerated by providing a list of file extensions. File extensions are generally representative of the data they may contain. eg, <strong>.conf</strong> or <strong>.config</strong> files usually contain configurations for the application, including sensitive info such as database credentials. Other files to search for are .txt files or other web application pages like <strong>.html</strong> or <strong>.php</strong>. To search the &quot;myfolder&quot; directory on a webserver for the following three files: html, js, CSS: <mark class="highlight-pink"><code>gobuster dir -u http://10.10.252.123/myfolder -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x.html,.css,.js</code></mark></p></div></div><div id="de28d9fc-3980-4da3-8a17-4471e5a78df8" class="column-list"><div id="6529e13c-193d-4edb-8374-0bfa4f217c8c" style="width:112.5%" class="column"><p id="01f2c05f-abf5-43e2-a9be-4c42d62bbf06" class=""><mark class="highlight-pink"><code>-k</code></mark> is special and important during penetration tests and capture the flag events. If HTTPS is enabled, you will most likely encounter an invalid cert error. In instances like this, if you try to run Gobuster against this without <mark class="highlight-pink"><code>-k</code></mark>, it won&#x27;t return anything and will most likely error out with something gross and will leave you sad. Just add <code><mark class="highlight-pink">-k</mark></code><mark class="highlight-pink"> </mark>to your scan and it will bypass this invalid certification and continue scanning. Note: This flag can be used with &quot;dir&quot; mode and &quot;vhost&quot; modes</p></div><div id="eab916cb-c085-43f0-86e7-00a9e4769228" style="width:87.5%" class="column"><figure id="c67c67ca-eb5b-4e3c-812c-a6f13484191b" class="image" style="text-align:right"><a href="https://comodosslstore.com/resources/wp-content/uploads/2018/08/NET-ERR_CERT_DATE_INVALID.png"><img style="width:336px" src="https://comodosslstore.com/resources/wp-content/uploads/2018/08/NET-ERR_CERT_DATE_INVALID.png"/></a></figure></div></div><p id="ace54c53-1d40-4ef9-bae3-43e8c82064b6" class=""><span style="border-bottom:0.05em solid"><strong>dns Mode </strong></span>- allows Gobuster to brute-force subdomains. During a penetration test, it&#x27;s important to check the sub-domains of your target&#x27;s top domain. Just because something is patched in the regular domain, does not mean it is patched in the sub-domain. There may be a vulnerability for you to exploit in one of these sub-domains. eg, if State Farm owns statefarm.com and mobile.statefarm.com, there may be a hole in mobile.statefarm.com that is not present in statefarm.com. To use &quot;dns&quot; mode, use <mark class="highlight-pink"><code>gobuster dns</code></mark>. which tells Gobuster to perform a sub-domain brute force, it has to be written like this or else Gobuster will complain. After that, add the domain and wordlist using <code><mark class="highlight-pink">-d</mark></code> and <mark class="highlight-pink">-w</mark>:<mark class="highlight-pink"><code>gobuster dns -d mydomain.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></mark><mark class="highlight-pink"> </mark>This tells Gobuster to do a sub-domain scan on the domain &quot;mydomain.thm&quot;. If there are any sub-domains available, Gobuster will find them and report them to you in the terminal.</p><table id="75c73707-7843-46c3-af9f-699610f2d476" class="simple-table"><tbody><tr id="d72871b4-f9c5-44ea-8e35-15d0a1aa9979"><td id="oC&gt;g" class="" style="width:50px"><strong><mark class="highlight-pink">Flag</mark></strong></td><td id="XKmf" class="" style="width:117px"><strong><mark class="highlight-pink">Long Flag</mark></strong></td><td id="x;^n" class="" style="width:395px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="bba02ca3-dd3a-4eca-90ca-ae9f0ca290d5"><td id="oC&gt;g" class="" style="width:50px">-c</td><td id="XKmf" class="" style="width:117px">--show-cname</td><td id="x;^n" class="" style="width:395px">Show CNAME Records (cannot be used with &#x27;-i&#x27; option)</td></tr><tr id="7dd99149-1c5c-432f-820c-01a156e8f238"><td id="oC&gt;g" class="" style="width:50px">-i</td><td id="XKmf" class="" style="width:117px">--show-ips</td><td id="x;^n" class="" style="width:395px">Show IP Addresses</td></tr><tr id="d96135a4-3c4d-48ee-ad15-6baf3fca646a"><td id="oC&gt;g" class="" style="width:50px">-r</td><td id="XKmf" class="" style="width:117px">--resolver</td><td id="x;^n" class="" style="width:395px">Use custom DNS server (format server.com or server.com:port)</td></tr></tbody></table><p id="f11ddecb-81e1-4dbc-ad4c-821f282455ae" class=""><strong>vhost mode</strong> - allows Gobuster to brute-force virtual hosts. Virtual hosts are different websites on the same machine. In some instances, they can appear to look like sub-domains, but they are IP based and run on the same server. This is not usually apparent to the end-user.It may be worthwhile to just run Gobuster in this mode to see if it comes up with anything. To use &quot;vhost&quot; mode, use <mark class="highlight-pink"><code>gobuster vhost</code></mark> which tells Gobuster that you want to perform a virtual host brute force. It has to be written like this or else Gobuster will complain. After that, add the domain and wordlist using <mark class="highlight-pink"><code>-u</code></mark> and <mark class="highlight-pink"><code>-w</code></mark>: <mark class="highlight-pink"><code>gobuster vhost -u http://example.com -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></mark>This will tell Gobuster to do a virtual host scan <a href="http://example.com/">http://example.com</a> using the selected wordlist.</p></details></li></ul><h3 id="0cfe5c78-2a69-4228-8595-b90c455abac2" class="block-color-purple_background"><strong><strong>John The Ripper</strong></strong></h3><ul id="97b89147-c824-42ff-b921-75ff7f40339c" class="toggle"><li><details open=""><summary><strong>John who?</strong></summary><p id="ae3a0263-fbd8-4b5a-87ee-49efb8944e57" class="">John the Ripper combines a fast cracking speed, with an extraordinary range of compatible hash types. </p><p id="418c32ba-88e6-4a8c-92f5-eca4ad85c24e" class=""><span style="border-bottom:0.05em solid"><strong>What are Hashes? </strong></span>- A hash is a way of taking a piece of data of any length and  representing it in another form that is a fixed length to mask the original value of the data. This is done by running the original data through a hashing algorithm.</p><p id="5a919ec1-837f-44fd-bc27-742b328914dd" class=""><span style="border-bottom:0.05em solid"><strong>What makes Hashes secure?</strong></span> - Hashing algorithms are designed so they only operate one way, meaning a calculated hash cannot be reversed using just the output given. This ties back to a fundamental mathematical problem known as the <a href="https://en.wikipedia.org/wiki/P_versus_NP_problem">P vs NP relationship</a>, which abstractly means the algorithm to hash the value will be &quot;NP&quot; and can be calculated reasonably, but an unhashing algorithm would be &quot;P&quot; and intractable to solve, meaning it cannot be computed in a reasonable time using standard computers.</p><p id="b8b79fb2-1390-4652-b44a-23d9c62351f8" class=""><span style="border-bottom:0.05em solid"><strong>Where John Comes in</strong></span> - If you have the hashed version of a password and you know the hashing algorithm, use the hashing algorithm to hash a large number of words, called a dictionary. Then compare the hashes to the one you&#x27;re trying to crack, to see if any of them match. If they do, you now know what word corresponds to that hash. This process is called a <strong>dictionary attack </strong>and John the Ripper, or John, is a tool to allow you to conduct fast brute-force attacks on a large array of different hash types.</p></details></li></ul><ul id="01680c65-56fd-44e7-9891-fa622e5206ec" class="toggle"><li><details open=""><summary><strong>Cracking Basic Hashes</strong></summary><p id="de6c918d-91f3-4cac-8079-2bcb20d00e38" class=""><span style="border-bottom:0.05em solid"><strong>John Basic Syntax</strong></span> - <mark class="highlight-pink"><code>john [options] [path to file]</code></mark><mark class="highlight-pink"> </mark><code>[path to file]</code> contains the hash you&#x27;re trying to crack</p><p id="21229c17-5a26-496c-b7b2-7105d419a59a" class=""><span style="border-bottom:0.05em solid"><strong>Automatic Cracking</strong></span> - John has built-in features to detect what type of hash it&#x27;s being given, and to select appropriate rules and formats to crack it for you, it can be unreliable,  it can be a good option: <mark class="highlight-pink"><code>john --wordlist=[path to wordlist] [path to file]</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>-wordlist=</code></mark> Specifies using wordlist mode, reading from the file that you supply in the<mark class="highlight-pink"><code>[path to wordlist]</code></mark> </p><p id="74a53c3b-a540-4e85-8242-4a7e6719c006" class=""><span style="border-bottom:0.05em solid"><strong>Identifying Hashes</strong></span> - Sometimes John won&#x27;t automatically recognize and load hashes so use other tools to identify the hash, and then set John to use a specific format: use an online hash identifier like <a href="https://hashes.com/en/tools/hash_identifier">this</a> one, or <a href="https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master">hash-identifier</a>, a Python tool that is easy to use and will tell you what different types of hashes the one you enter is likely to be. To use hash-identifier, you can just pull the python file from gitlab using: <mark class="highlight-pink"><code>wget https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py</code></mark>. Then launch it with <mark class="highlight-pink"><code>python3 hash-id.py</code></mark> and enter the hash you&#x27;re trying to identify.</p><p id="bcb9f292-d60a-450a-8568-929935caa070" class=""><span style="border-bottom:0.05em solid"><strong>Format-Specific Cracking</strong></span> - Once you have identified the hash that you&#x27;re dealing with, tell john to use it while cracking the provided hash: <mark class="highlight-pink"><code>john --format=[format] --wordlist=[path to wordlist] [path to file]</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>-format=</code></mark> tells John it is a hash of a specific format, and to use <mark class="highlight-pink"><code>[format]</code></mark> to crack it</p><p id="e0dddb0c-c358-4eb4-9c1e-eee079df2619" class=""><span style="border-bottom:0.05em solid"><strong>A Note on Formats:</strong></span> When telling john to use formats, if you&#x27;re dealing with a standard hash type, e.g. md5, prefix it with<mark class="highlight-pink"><code>raw-</code></mark> to tell John it’s just dealing with a standard hash type. To check if you need to add the prefix or not, list all of John&#x27;s formats using <mark class="highlight-pink"><code>john --list=formats</code></mark> and check manually, or grep for your hash type using something like <mark class="highlight-pink"><code>john --list=formats | grep -iF &quot;md5&quot;</code></mark>.</p></details></li></ul><ul id="865bb63a-a7eb-47e8-9eae-09c441971c80" class="toggle"><li><details open=""><summary><strong>Cracking Windows Authentication Hashes</strong></summary><p id="7f4942c4-3bc1-40df-8408-f84e98267ef5" class=""><span style="border-bottom:0.05em solid"><strong>Cracking Windows Hashes - </strong></span>Authentication hashes are the hashed versions of passwords that are stored by operating systems, it is sometimes possible to crack them using the brute-force methods that we&#x27;re using. To get your hands on these hashes, you must often already be a privileged user.</p><p id="09442249-d5b0-41eb-8842-f1f569c9075d" class=""><span style="border-bottom:0.05em solid"><strong>NTHash / NTLM</strong></span> - NThash is the hash format that modern Windows OS machines will store user and service passwords in. It&#x27;s commonly referred to as &quot;NTLM&quot; which references the previous version of Windows format for hashing passwords &quot;LM&quot;, thus &quot;NT/LM&quot;. The NT designation for Windows products originally meant &quot;New Technology&quot;, and was used, starting with <a href="https://en.wikipedia.org/wiki/Windows_NT">Windows NT</a>, to denote products that were not built up from the MS-DOS Operating System. Eventually, the &quot;NT&quot; line became the standard OS type to be released by Microsoft and the name was dropped, but it still used in some Microsoft technologies. To acquire NTHash/NTLM hashes, dump the SAM database on a Windows machine, by using a tool like Mimikatz or from the Active Directory database: NTDS.dit. </p></details></li></ul><ul id="384a970e-b93a-4eb0-999f-0b3bf34890e5" class="toggle"><li><details open=""><summary><strong>Cracking /etc/shadow Hashes</strong></summary><p id="b0c72282-fd3c-45de-a1b0-4f42c52aba6a" class=""><span style="border-bottom:0.05em solid"><strong>Cracking Hashes from /etc/shadow</strong></span> - The /etc/shadow file is where password hashes are stored on linux. It also stores info like the date of last password change and password expiration information. It contains one entry per line for each user or user account of the system. This file is usually only accessible by the root user-.</p><p id="bfce36a1-885b-4b80-bef2-4130cfc648ec" class=""><span style="border-bottom:0.05em solid"><strong>Unshadowing</strong></span> - John can be very particular about the formats it needs data in to be able to work with it, in order to crack /etc/shadow passwords, you must combine it with the /etc/passwd file in order for John to understand the data it&#x27;s being given. Use a tool built in John suite tool called unshadow: <mark class="highlight-pink"><code>unshadow [path to passed] &gt; [path to shadow]</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>[path to passwd]</code></mark> contains the copy of the /etc/passwd file taken from the target machine <mark class="highlight-pink"><code>[path to shadow]</code></mark> contains the copy of the /etc/shadow file taken from the target machine</p><p id="e73d7179-814d-44cf-a75d-821c7d722e7b" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - Feed the output from unshadow; you should not need to specify a mode if the input is made specifically for John; in some cases you will need to specify the format using: <mark class="highlight-pink"><code>--format=sha512crypt</code></mark><mark class="highlight-pink"> eg. </mark><mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt</code></mark></p></details></li></ul><ul id="e541706f-67e7-4cee-bf82-9a80af89feae" class="toggle"><li><details open=""><summary><strong>Single Crack Mode</strong></summary><p id="262efcbb-cc4e-41dc-9c16-84d3e1a9d4a8" class=""><span style="border-bottom:0.05em solid"><strong>Single Crack Mode</strong></span> - John has a mode, called Single Crack mode, where John uses only the information provided in the username to try and work out possible passwords heuristically, by slightly changing the letters and numbers contained within the username.</p><p id="2a7db9d7-5ff1-4ae2-8293-d6ab39443efe" class=""><span style="border-bottom:0.05em solid"><strong>Word Mangling</strong></span> - eg, username: Markus possible passwords: Markus1, MArkus, Markus!, etc. This technique is called word mangling. John is building its own dictionary based on the information that it has been fed and uses a set of &quot;mangling rules&quot; to define how it mutates the word it started with to generate a wordlist based on relevant factors for the target you&#x27;re trying to crack. This exploits how poor passwords can be based off of information about the username, or the service they&#x27;re logging into.</p><p id="2ca494e2-2192-4add-9e6b-712d07afb5f0" class=""><span style="border-bottom:0.05em solid"><strong>GECOS</strong></span> - John&#x27;s implementation of word mangling features compatibility with the Gecos fields of UNIX OSs. In the last task, we looked at entries of both /etc/shadow and /etc/passwd where each field is separated by a colon. Each of the fields these records are split into are called Gecos fields. John can take information stored in records, like full name and home directory name to add to the generated wordlist when cracking hashes with single crack mode.</p><p id="7fb1caf1-6ceb-47a3-96e9-19b5f7d203f8" class="">To use single crack mode: <mark class="highlight-pink"><code>john --single --format=[format] [path to file]</code></mark> <mark class="highlight-pink"><code>single</code></mark> tells john to use single hash cracking mode</p><p id="d04db53a-a8da-4f77-bbda-ef2b9dce0c28" class=""><strong>A Note on File Formats in Single Crack Mode:</strong></p><p id="c25244fc-c2e8-4ac7-8ae1-ae918699c23c" class="">If you&#x27;re cracking hashes in single crack mode, change the file format you&#x27;re feeding John for it to understand what data to create a wordlist from. You do this by prepending the hash with the username that the hash belongs to. <strong>From: </strong>1efee… <strong>To: </strong>mike:1efee…</p></details></li></ul><ul id="cc46126d-d2f2-4c9b-8e8f-defe2e66403a" class="toggle"><li><details open=""><summary><strong>Custom Rules</strong></summary><p id="3450f4d9-8304-4fa8-a74d-92c8361437ab" class="">You may have ideas about what good mangling patterns or patterns your passwords often use that could be replicated with a certain mangling pattern. You can define your own sets of rules for John to dynamically create passwords. </p><p id="9be86ccd-b873-4334-86a5-c69959a07c7a" class=""><span style="border-bottom:0.05em solid"><strong>Common Custom Rules</strong></span> - Many organizations require a certain level of password complexity to try and combat dictionary attacks. This is good, but we can exploit the fact that most users will be predictable in the location of these symbols. A password with the capital letter first, and a number and symbol at the end. The pattern of the familiar password, appended and prepended by modifiers is a memorable pattern people use, and reuse for passwords. This pattern lets us exploit password complexity predictability as an attacker; we know the likely position of added elements and can create dynamic passwords from our wordlists.</p><p id="6b516a36-9a56-42a9-83a5-d0c16c4ea2be" class=""><span style="border-bottom:0.05em solid"><strong>How to create Custom Rules</strong></span> - Custom rules are defined in the <mark class="highlight-pink"><code>john.conf</code></mark> file, usually located in <mark class="highlight-pink"><code>/etc/john/john.conf</code></mark></p><p id="1c2059c8-a485-4343-934c-7cda93f6adbc" class="">Syntax of these custom rules, Note: there is a massive level of granular control to define in these rules</p><p id="800c94d0-210a-465c-8136-21f892c3e1a6" class="">The first line: <mark class="highlight-pink"><code>[List.Rules:THMRules]</code></mark> is used to define the name of your rule and what you will use to call your custom rule as a John argument. Then use a regex pattern match to define where the word will be modified:</p><p id="07106625-bf18-4af5-81a6-4e7ab33ef748" class=""><mark class="highlight-pink"><code>Az</code></mark> - Appends the word with the characters you define</p><p id="be1055cc-0fdd-4445-838b-c7e6cecca474" class=""><mark class="highlight-pink"><code>A0</code></mark> - Prepends the word with the characters you define</p><p id="5511b876-02e9-420d-a36e-4eea4745f04f" class=""><mark class="highlight-pink"><code>c</code></mark> - Capitalizes the character positionally</p><p id="1afc7e6c-6ac3-41d0-abbf-1ad09db1c8e7" class="">Lastly, define what characters to append, prepend, or include by adding character sets in square brackets <mark class="highlight-pink"><code>[ ]</code></mark> in the order they should be used. These directly follow the modifier patterns inside of double quotes <mark class="highlight-pink"><code>&quot; &quot;</code></mark>:</p><p id="9f0d0876-95f6-4731-aa31-2742f4498f8b" class=""><mark class="highlight-pink"><code>[0-9]</code></mark> - Includes numbers 0-9</p><p id="62a66472-9cd6-49b7-8d87-c87d1040266a" class=""><mark class="highlight-pink"><code>[0]</code></mark> - Only includes number 0</p><p id="31e3832c-cf8c-43c1-a55a-4c38fc54a2d3" class=""><mark class="highlight-pink"><code>[A-z]</code></mark> - Includes both upper and lowercase</p><p id="d32143b6-4b24-4d0f-9c3f-020a9f31a2c2" class=""><mark class="highlight-pink"><code>[A-Z]</code></mark> - Only includes uppercase letters</p><p id="7bc30601-ea9e-4045-b0ab-dc7c2accf866" class=""><mark class="highlight-pink"><code>[a-z]</code></mark> - Only includes lowercase letters</p><p id="7ea6d9c1-2bcd-4ff3-b4f1-7f19b1d8e25f" class=""><mark class="highlight-pink"><code>[a]</code></mark> - Only includes a</p><p id="0233b126-fe11-4061-9482-3ef210a3d293" class=""><mark class="highlight-pink"><code>[!£$%@]</code></mark> - Includes the symbols !£$%@</p><p id="455cc03f-4890-41a2-b02a-d528b84b355c" class="">To generate a wordlist for the example password &quot;Polopassword1!&quot; (assuming it was in our wordlist):<mark class="highlight-pink"><code>[List.Rules:PoloPassword]</code></mark> <mark class="highlight-pink"><code>cAz&quot;[0-9] [!£$%@]&quot;</code></mark></p><p id="0e620de6-6eea-4a38-b839-1116b5fe8c55" class=""><span style="border-bottom:0.05em solid"><strong>To use Custom Rules</strong></span> - call the custom rule as a John argument using <mark class="highlight-pink"><code>--rule=PoloPassword</code></mark>  <mark class="highlight-pink"><code>john --wordlist=[path to wordlist] --rule=PoloPassword [path to file]</code></mark></p></details></li></ul><ul id="9c1787d1-760f-4d82-8323-045cc5306e31" class="toggle"><li><details open=""><summary><strong>Cracking Password-Protected Zip Files, RAR Archives, and SSH Keys with John</strong></summary><p id="1252b9c2-f0d2-418c-baba-027a80bf756f" class="">John can crack passwords on password-protected <strong>ZIP</strong> files using a separate part of the John suite of tools to convert the zip file into a format that John understands.</p><p id="add583b7-86e7-4c98-bbbf-a90c4891efc6" class=""><span style="border-bottom:0.05em solid"><strong>Zip2John</strong></span> - converts zip files into a hash format that John can understand, and hopefully crack: <mark class="highlight-pink"><code>zip2john [options] [zip file] &gt; [output file]</code></mark> <mark class="highlight-pink"><code>[options]</code></mark> - passes specific checksum options to zip2john</p><p id="08b9768e-ebc9-4d37-9b24-5df5dedef493" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - take the file output from zip2john and feed it to John: <mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt</code></mark></p><p id="414f171b-fc65-4092-b7d0-abe79123ddc7" class="">A similar process obtains passwords for <strong>RAR</strong> archives, which like zip files, are compressed files created by the WinRAR archive manager.</p><p id="12054d6c-ebed-4cb4-b7ee-1da7a4f8dd46" class=""><span style="border-bottom:0.05em solid"><strong>Rar2John</strong></span> - Identical to zip2john, rar2john converts RAR files into a hash format John understands: <mark class="highlight-pink"><code>rar2john [rar file] &gt; [output]</code></mark></p><p id="d268afa3-35d1-40c5-8d85-3ae25109bdc1" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - take the file output from rar2john and feed it to John: <mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt</code></mark></p><p id="b310288f-8e2c-4fee-bdbd-1540b729335e" class=""><strong>SSH</strong> private key password of id_rsa files. Unless configured otherwise, you authenticate your SSH login using a password, but you can configure key-based authentication, which lets you use your private key, id_rsa, as an authentication key to log in to a remote machine over SSH, doing so will often require a password; use John to crack this password to allow authentication over SSH using the key.</p><p id="7229230b-ec8c-483c-bd8c-1aafdef84a66" class=""><span style="border-bottom:0.05em solid"><strong>SSH2John</strong></span> - converts the id_rsa private key that you use to login to the SSH session into a hash format that John can work with: </p><p id="a6ccff3f-6e90-4676-ab96-6873a08e3589" class=""><mark class="highlight-pink"><code>ssh2john [id_rsa private key file] &gt; [output file]</code></mark></p><p id="0df4c9dc-db35-4795-9fd4-66718867c8d9" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - feed the file output from ssh2john to John: <mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_hash.txt</code></mark></p></details></li></ul><h3 id="71fbec5a-a585-42dd-b6ae-ae6bcef4c6ba" class="block-color-purple_background"><strong><strong>Crack The Hash Level 2</strong></strong></h3><ul id="f1258ba1-25c4-4089-954b-c1adad368ade" class="toggle"><li><details open=""><summary><strong>Walkthrough</strong> Cracking tools, modes &amp; rules</summary><p id="511f631b-ddd8-4002-a09b-a3f6eb76df46" class=""><span style="border-bottom:0.05em solid"><strong>modes of cracking</strong></span>: <strong>Wordlist mode -</strong> try all words in a dictionary. eg, common passwords, usernames, etc. <strong>Incremental mode</strong> <strong>-</strong> try all possible character combinations as passwords <strong>Rule mode</strong> - use wordlist mode by adding pattern or mangling the string. eg, adding current year, appending a common special character.</p><p id="9aeaebae-c4f8-4779-9d7e-2bc4730b3621" class=""><span style="border-bottom:0.05em solid"><strong>performing a rule based bruteforce</strong></span>:</p><ol type="1" id="f594ac72-3046-4ffe-b016-bf789808414c" class="numbered-list" start="1"><li>Generating a custom wordlist and using the classic wordlist mode with it.</li></ol><ol type="1" id="d1331f00-90e7-42eb-81c4-ffe572207e0d" class="numbered-list" start="2"><li>Using a common wordlist and telling the cracking tool to apply some custom mangling rules on it. - more powerful, wont waste gigabytes by storing tons of wordlists and waste time generating ones you will use only one time</li></ol><p id="c2395208-66dc-4f4b-b61c-4857ed51589a" class=""><strong>Border mutation</strong> - commonly used combinations of digits and special symbols added at the end, beginning, or both</p><p id="ef902d2b-8d95-4e9d-ac5e-38b51273bb65" class=""><strong>Freak mutation</strong> - letters replaced with similar looking special symbols</p><p id="3b14d582-485e-402d-80c8-3784eae913db" class=""><strong>Case mutation</strong> - all variations of uppercase/lowercase letters for any character</p><p id="93bf03d8-683d-4544-bc2a-b35a290b5a2c" class=""><strong>Order mutation</strong> - character order reversed</p><p id="356ef051-ac7d-417a-80e8-e1d979c5dd22" class=""><strong>Repetition mutation</strong> - the same group of characters repeated several times</p><p id="0182cc19-4243-49eb-850d-a0af47c450d6" class=""><strong>Vowels mutation</strong> - vowels omitted or capitalized</p><p id="9ead9ac2-3ced-42f1-9c29-1e5453daf635" class=""><strong>Strip mutation</strong> - one or several characters removed</p><p id="c7952a54-5ed5-4b27-89d4-e71a7bced4e1" class=""><strong>Swap mutation</strong> - some characters swapped and change places</p><p id="ad848cd7-4114-47ff-bae8-6000d1a9cc39" class=""><strong>Duplicate mutation</strong> - some characters duplicated</p><p id="5a164f55-fc67-49eb-9b44-2a215b43e53e" class=""><strong>Delimiter mutation</strong> - delimiters added between characters</p></details></li></ul><h3 id="806fa4a8-d452-4d61-94a2-7b253d5f55dd" class="">Hydra</h3><ul id="91092db7-1c40-43ee-b8e8-291031fcbc99" class="toggle"><li><details open=""><summary><strong>What is Hydra?</strong></summary><p id="65e09cce-5059-4495-85ed-f20cea128a96" class="">Hydra is a brute force online password cracking program, a quick system login password “hacking” tool. Hydra supports/has the ability to brute force the following protocols: “Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, TeamSpeak (TS2), Telnet, VMware-Auth, VNC and XMPP.”</p></details></li></ul><ul id="5fbfea1c-f2ec-426e-aeaa-706ec8346101" class="toggle"><li><details open=""><summary><strong>Hydra Commands</strong></summary><p id="05a5b65f-6f46-4b2e-8bcf-4fa80bc6576d" class="">The options we pass into Hydra depend on which service (protocol) we’re attacking. eg, to brute force FTP with the username being <code>user</code> and a password list being <code>passlist.txt</code>, we’d use the following command:</p><p id="bbf0dc41-d895-46b6-a522-1fad64243d7f" class=""><code>hydra -l user -P passlist.txt ftp://MACHINE_IP</code></p><p id="8d6bee33-0d52-4b1d-a408-4a13c660f6e4" class="">For this deployed machine, here are the commands to use Hydra on SSH and a web form (POST method).</p><h3 id="c9cad488-358d-4e6b-a166-9fac9073e5dc" class=""><strong>SSH</strong></h3><p id="e5a7e076-d562-48d7-90ff-7624746a8b5d" class=""><code>hydra -l &lt;username&gt; -P &lt;full path to pass&gt; MACHINE_IP -t 4 ssh</code></p><table id="6663b27c-5b7a-483e-ad99-b91d3fe95eab" class="simple-table"><tbody><tr id="58ba7e75-9c77-420d-8d1e-d3d0133fb8cf"><td id="Y{^Y" class="">Option</td><td id="cpx}" class="">Description</td></tr><tr id="524d796f-5eaf-4ebb-b90c-3276bc112bbd"><td id="Y{^Y" class=""><code>-l</code></td><td id="cpx}" class="">specifies the (SSH) username for login</td></tr><tr id="bfb352c1-9e28-4a10-a6fd-4d22a8e7bfa0"><td id="Y{^Y" class=""><code>-P</code></td><td id="cpx}" class="">indicates a list of passwords</td></tr><tr id="8f51deeb-74d0-41b7-8577-c275b68e04bf"><td id="Y{^Y" class=""><code>-t</code></td><td id="cpx}" class="">sets the number of threads to spawn</td></tr></tbody></table><p id="b115c5ba-98eb-42ee-b51e-cb26153f3ad3" class="">For example, <code>hydra -l root -P passwords.txt MACHINE_IP -t 4 ssh</code> will run with the following arguments:</p><ul id="ab3854b7-f4fe-4bba-966f-a2cd558ec105" class="bulleted-list"><li style="list-style-type:disc">Hydra will use <code>root</code> as the username for <code>ssh</code></li></ul><ul id="18967c3a-78d7-424b-8d77-ead823c43b1a" class="bulleted-list"><li style="list-style-type:disc">It will try the passwords in the <code>passwords.txt</code> file</li></ul><ul id="ba8654d2-db84-41cc-ac4b-9d9fb69e54fb" class="bulleted-list"><li style="list-style-type:disc">There will be four threads running in parallel as indicated by <code>t 4</code></li></ul><h3 id="4eb95a08-d215-4bf7-9387-6c71662166fd" class=""><strong>Post Web Form</strong></h3><p id="5588ace7-2fc3-42a4-8e2e-1518bee019ff" class="">We can use Hydra to brute force web forms too. You must know which type of request it is making; GET or POST methods are commonly used. You can use your browser’s network tab (in developer tools) to see the request types or view the source code.</p><p id="9195f5ca-5e94-4731-8b65-5599a77f0f9e" class=""><code>sudo hydra &lt;username&gt; &lt;wordlist&gt; MACHINE_IP http-post-form &quot;&lt;path&gt;:&lt;login_credentials&gt;:&lt;invalid_response&gt;&quot;</code></p><table id="7943d09d-4a1c-4e49-85b4-2514517a5b3d" class="simple-table"><tbody><tr id="02e1f826-caaf-4a65-a3a0-a3191ed307fa"><td id="_WCJ" class="">Option</td><td id="eZdS" class="">Description</td></tr><tr id="85ca59de-07b1-43ca-b98c-97a259a6a41b"><td id="_WCJ" class=""><code>-l</code></td><td id="eZdS" class="">the username for (web form) login</td></tr><tr id="0b816359-2522-479f-9c59-cd9e765d9f0f"><td id="_WCJ" class=""><code>-P</code></td><td id="eZdS" class="">the password list to use</td></tr><tr id="dcc99fdf-421e-4861-b3d3-433aca119535"><td id="_WCJ" class=""><code>http-post-form</code></td><td id="eZdS" class="">the type of the form is POST</td></tr><tr id="e5ba064a-05b0-42a0-ba42-1d85d0e2fdf9"><td id="_WCJ" class=""><code>&lt;path&gt;</code></td><td id="eZdS" class="">the login page URL, for example, <code>login.php</code></td></tr><tr id="a35070a5-a5f2-4548-b3b9-7a3e35ee4898"><td id="_WCJ" class=""><code>&lt;login_credentials&gt;</code></td><td id="eZdS" class="">the username and password used to log in, for example, <code>username=^USER^&amp;password=^PASS^</code></td></tr><tr id="86c5b28c-cff9-48a0-823e-0ac5a27715d8"><td id="_WCJ" class=""><code>&lt;invalid_response&gt;</code></td><td id="eZdS" class="">part of the response when the login fails</td></tr><tr id="df190367-a2c3-49ce-a818-2b524e317334"><td id="_WCJ" class=""><code>-V</code></td><td id="eZdS" class="">verbose output for every attempt</td></tr></tbody></table><p id="613dd2e3-f0d9-4ab8-8612-dfad1783e5ab" class="">Below is a more concrete example Hydra command to brute force a POST login form:</p><p id="c562acb4-a20c-4efa-993c-29c826f6f86b" class=""><code>hydra -l &lt;username&gt; -P &lt;wordlist&gt; MACHINE_IP http-post-form &quot;/:username=^USER^&amp;password=^PASS^:F=incorrect&quot; -V</code></p><ul id="d9b338ab-2e89-45d2-b6ad-e575f7d821b5" class="bulleted-list"><li style="list-style-type:disc">The login page is only <code>/</code>, i.e., the main IP address.</li></ul><ul id="77eeb5e5-1357-4085-a6ac-e0137f91ae50" class="bulleted-list"><li style="list-style-type:disc">The <code>username</code> is the form field where the username is entered</li></ul><ul id="168d8274-7228-43da-b555-34c8d72d71ba" class="bulleted-list"><li style="list-style-type:disc">The specified username(s) will replace <code>^USER^</code></li></ul><ul id="38a2a963-6711-4af4-b4c1-c6c3c2c9cd94" class="bulleted-list"><li style="list-style-type:disc">The <code>password</code> is the form field where the password is entered</li></ul><ul id="a456549c-58ad-496a-8756-d520b160d611" class="bulleted-list"><li style="list-style-type:disc">The provided passwords will be replacing <code>^PASS^</code></li></ul><ul id="e806d87a-8ff0-4144-bf6f-f291727ca610" class="bulleted-list"><li style="list-style-type:disc">Finally, <code>F=incorrect</code> is a string that appears in the server reply when the login fails</li></ul><p id="07a35f38-a757-470d-a3b0-93301d69d685" class="">You should now have enough information to put this to practice and brute force your credentials to the deployed machine!</p></details></li></ul><h3 id="dc28b302-4773-416e-8aa8-2ee7b72dcd55" class="block-color-purple_background">Tmux</h3><p id="78e70b07-0537-4e37-bb7c-74b6c240ee0d" class=""><a href="https://imgur.com/bL9Dn3U">https://imgur.com/bL9Dn3</a>U</p><figure id="549ad439-8b64-468b-8370-bde5d9410225" class="image"><a href="Study%20Guide%20d94382859d654e92814777f38b83b894/Untitled.png"><img style="width:384px" src="Study%20Guide%20d94382859d654e92814777f38b83b894/Untitled.png"/></a></figure><h3 id="9d084b19-7f55-420c-885f-c24ff4ec6a76" class="block-color-purple_background"><strong><strong>Linux Privilege Escalation</strong></strong></h3><ul id="25fa5fb5-0143-4ff3-a9d4-49d5e8f3c0d7" class="toggle"><li><details open=""><summary>What does &quot;privilege escalation&quot; mean?</summary><p id="a48c52fd-6ab0-411c-82f8-ffefe38cd1c0" class="">At it&#x27;s core, Privilege Escalation usually involves going from a lower permission account to a higher permission one. More technically, it&#x27;s the exploitation of a vulnerability, design flaw, or configuration oversight in an operating system or application to gain unauthorized access to resources that are usually restricted from the users.</p><p id="f466beba-ddfb-4dca-83c0-374f0c58593b" class="">Why is it important?</p><p id="623028f7-46d6-4303-98e3-325ae27b6e3b" class="">It&#x27;s rare when performing a real-world penetration test to be able to gain a foothold (initial access) that gives you direct administrative access. Privilege escalation is crucial because it lets you gain system administrator levels of access, which allows you to perform actions such as:</p><ul id="37f84310-82b8-44f9-b487-fe7b0f1ae165" class="bulleted-list"><li style="list-style-type:disc">Resetting passwords</li></ul><ul id="f4618768-f88d-4096-a58b-2962f1ad0c8c" class="bulleted-list"><li style="list-style-type:disc">Bypassing access controls to compromise protected data</li></ul><ul id="8283d098-10c8-41fc-8f76-ca761d4bdc60" class="bulleted-list"><li style="list-style-type:disc">Editing software configurations</li></ul><ul id="e89bb62a-5061-4a0b-aca8-a62a6b8ee1a4" class="bulleted-list"><li style="list-style-type:disc">Enabling persistence</li></ul><ul id="b8b88598-d50b-46ff-9ce1-00f0f4af6b75" class="bulleted-list"><li style="list-style-type:disc">Changing the privilege of existing (or new) users</li></ul><ul id="c09bc447-6add-4837-994d-c6675dc40bdf" class="bulleted-list"><li style="list-style-type:disc">Execute any administrative command</li></ul></details></li></ul><ul id="e7c89dee-9138-46bc-a4a4-216df291aa20" class="toggle"><li><details open=""><summary>Enumeration</summary><p id="7407b4d9-84de-4c1c-b638-f8796131299a" class="">Enumeration is the first step you have to take once you gain access to any system. You may have accessed the system by exploiting a critical vulnerability that resulted in root-level access or just found a way to send commands using a low privileged account. Penetration testing engagements, unlike CTF machines, don&#x27;t end once you gain access to a specific system or user privilege level. As you will see, enumeration is as important during the post-compromise phase as it is before.</p><h3 id="ac99949a-9cd3-4e0f-a1a6-bb9bf6e94ce7" class="">hostname</h3><p id="4e8897df-135f-48ff-b73b-3728f425aca3" class="">The <code>hostname</code> command will return the hostname of the target machine. Although this value can easily be changed or have a relatively meaningless string (e.g. Ubuntu-3487340239), in some cases, it can provide information about the target system’s role within the corporate network (e.g. SQL-PROD-01 for a production SQL server).</p><h3 id="7b541877-7f38-4064-bdfb-9b14b2a84a69" class="">uname -a</h3><p id="2ea4af93-a09b-44b6-8e0b-d60ff97ba2ae" class="">Will print system information giving us additional detail about the kernel used by the system. This will be useful when searching for any potential kernel vulnerabilities that could lead to privilege escalation.</p><h3 id="6fa769d3-47e9-407c-8958-07a4acd476ed" class="">/proc/version</h3><p id="62aab1c1-84a2-4462-9fce-3af0b79aacf1" class="">The proc filesystem (procfs) provides information about the target system processes. You will find proc on many different Linux flavours, making it an essential tool to have in your arsenal.</p><p id="6d395163-ffcf-4f2c-ae5e-e40c6839db58" class="">Looking at <code>/proc/version</code> may give you information on the kernel version and additional data such as whether a compiler (e.g. GCC) is installed.</p><h3 id="baa6ec60-520e-4fd7-aa7a-7b63c9a8628d" class="">/etc/issue</h3><p id="2de605c7-9d64-4752-b67a-beef3960dc7f" class="">Systems can also be identified by looking at the <code>/etc/issue</code> file. This file usually contains some information about the operating system but can easily be customized or changed. While on the subject, any file containing system information can be customized or changed. For a clearer understanding of the system, it is always good to look at all of these.</p><h3 id="5b1735dd-03f2-452e-9c26-53a7895be13c" class="">ps Command</h3><p id="7508221c-6cba-476b-b3c7-ec83204adaae" class="">The <code>ps</code> command is an effective way to see the running processes on a Linux system. Typing <code>ps</code> on your terminal will show processes for the current shell.</p><p id="a0ada902-5e0a-4583-adc5-da22899ae4ee" class="">The output of the <code>ps</code> (Process Status) will show the following;</p><ul id="9385648d-11e8-429d-8bc2-34968d016a25" class="bulleted-list"><li style="list-style-type:disc">PID: The process ID (unique to the process)</li></ul><ul id="a3804afe-6267-4546-a711-c5641f53d865" class="bulleted-list"><li style="list-style-type:disc">TTY: Terminal type used by the user</li></ul><ul id="c95c9d5c-54c1-44e2-9bf7-ed10d0d42f62" class="bulleted-list"><li style="list-style-type:disc">Time: Amount of CPU time used by the process (this is NOT the time this process has been running for)</li></ul><ul id="4ac94a83-ed6f-4fd0-8f73-b0cdb1c6e787" class="bulleted-list"><li style="list-style-type:disc">CMD: The command or executable running (will NOT display any command line parameter)</li></ul><p id="00524965-4f1a-4fd9-ab93-3009ceb0b7b1" class="">The “ps” command provides a few useful options.</p><ul id="e60619b9-0a62-492c-9558-46a826e6e697" class="bulleted-list"><li style="list-style-type:disc"><code>ps -A</code>: View all running processes</li></ul><ul id="5248d545-3ce8-4386-80c4-058b0c7aef74" class="bulleted-list"><li style="list-style-type:disc"><code>ps axjf</code>: View process tree (see the tree formation until <code>ps axjf</code> is run below)</li></ul><figure id="5c4f21b1-abe1-4de2-a34c-190e8ef37951" class="image"><a href="https://i.imgur.com/xsbohSd.png"><img style="width:1056px" src="https://i.imgur.com/xsbohSd.png"/></a></figure><ul id="1de08fd8-b511-41d2-9ea1-aa5d082adf1f" class="bulleted-list"><li style="list-style-type:disc"><code>ps aux</code>: The <code>aux</code> option will show processes for all users (a), display the user that launched the process (u), and show processes that are not attached to a terminal (x). Looking at the ps aux command output, we can have a better understanding of the system and potential vulnerabilities.</li></ul><h3 id="a95a4c40-2af0-42d9-a157-cc309ee7e470" class="">env</h3><p id="ea3070e6-90f3-49b3-9897-dd6c898aa173" class="">The <code>env</code> command will show environmental variables.</p><figure id="a7648ec6-a45f-491e-ae9e-8e50c77fb9cd" class="image"><a href="https://i.imgur.com/LWdJ8Fw.png"><img style="width:720px" src="https://i.imgur.com/LWdJ8Fw.png"/></a></figure><p id="b97ca368-cd84-4c77-b257-81f5ff3f3cfb" class="">The PATH variable may have a compiler or a scripting language (e.g. Python) that could be used to run code on the target system or leveraged for privilege escalation.</p><h3 id="b9dda5d5-e5d0-4b3b-b9e7-49735767ea3e" class="">sudo -l</h3><p id="0b7c618c-64ca-432a-bc4f-676abbf4ac9c" class="">The target system may be configured to allow users to run some (or all) commands with root privileges. The <code>sudo -l</code> command can be used to list all commands your user can run using <code>sudo</code>.</p><h1 id="025d63c2-08fb-48b6-902b-3bda5b956f7e" class="">ls</h1><p id="53ddf12d-314b-4745-89af-af266cf805d3" class="">One of the common commands used in Linux is probably <code>ls</code>.</p><p id="a485d2ea-1d3b-4fab-a33b-5133e91c5013" class="">While looking for potential privilege escalation vectors, please remember to always use the <code>ls</code> command with the <code>-la</code> parameter. The example below shows how the “secret.txt” file can easily be missed using the <code>ls</code> or <code>ls -l</code> commands.</p><figure id="6bbbae62-21f4-45af-9370-f8e290993692" class="image"><a href="https://i.imgur.com/2jOtOat.png"><img style="width:480px" src="https://i.imgur.com/2jOtOat.png"/></a></figure><h3 id="b02d2a88-7296-48e9-8c5b-0989d12928e2" class="">Id</h3><p id="b38dd0c1-484f-49bd-9a03-3e3e53342cef" class="">The <code>id</code> command will provide a general overview of the user’s privilege level and group memberships.</p><p id="1c94c539-1617-422d-b7e7-ac51c5ba2150" class="">It is worth remembering that the <code>id</code> command can also be used to obtain the same information for another user as seen below.</p><figure id="23f47dad-ea1b-48b1-b935-0937de462645" class="image"><a href="https://i.imgur.com/YzfJliG.png"><img style="width:1056px" src="https://i.imgur.com/YzfJliG.png"/></a></figure><h3 id="c32d6261-400a-4229-9b7d-5615e4c37a86" class="">/etc/passwd</h3><p id="51e8a190-67cb-40fd-ac96-a79359388047" class="">Reading the <code>/etc/passwd</code> file can be an easy way to discover users on the system.</p><figure id="781dc1d2-14d6-43d6-8e03-7db3aa149348" class="image"><a href="https://i.imgur.com/r6oYOEi.png"><img style="width:528px" src="https://i.imgur.com/r6oYOEi.png"/></a></figure><p id="1dcc1945-0e36-42ee-9875-52dbba842dac" class="">While the output can be long and a bit intimidating, it can easily be cut and converted to a useful list for brute-force attacks.</p><figure id="c86d71f1-f0e1-4f86-a1cc-8206d4a0ede8" class="image"><a href="https://i.imgur.com/cpS2U93.png"><img style="width:528px" src="https://i.imgur.com/cpS2U93.png"/></a></figure><p id="1b2d91b2-cbce-48bd-8a0b-6b6f53a6b849" class="">Remember that this will return all users, some of which are system or service users that would not be very useful. Another approach could be to grep for “home” as real users will most likely have their folders under the “home” directory.</p><figure id="6c1bfa3e-0e5b-4440-a106-e3f386a6fbe3" class="image"><a href="https://i.imgur.com/psxE6V4.png"><img style="width:1056px" src="https://i.imgur.com/psxE6V4.png"/></a></figure><h3 id="2585d821-7e73-48e4-9d7c-79c074550fd0" class="">history</h3><p id="d76c44a8-efae-484f-a593-5b8ade1f1a2c" class="">Looking at earlier commands with the <code>history</code> command can give us some idea about the target system and, albeit rarely, have stored information such as passwords or usernames.</p><h3 id="74838bfb-d363-4cad-ba32-3bd57d8598c3" class="">ifconfig</h3><p id="61f1d2ed-de65-4707-94b1-231cc90fc1f6" class="">The target system may be a pivoting point to another network. The <code>ifconfig</code> command will give us information about the network interfaces of the system. The example below shows the target system has three interfaces (eth0, tun0, and tun1). Our attacking machine can reach the eth0 interface but can not directly access the two other networks.</p><figure id="25e33cb0-9a2f-4481-975f-cb0e42a63c70" class="image"><a href="https://i.imgur.com/hcdZnwK.png"><img style="width:672px" src="https://i.imgur.com/hcdZnwK.png"/></a></figure><p id="d0606cd0-6075-4737-865d-f8bfd1f4fc1c" class="">This can be confirmed using the <code>ip route</code> command to see which network routes exist.</p><figure id="9681ae94-8b24-4b98-bc48-da7bbfdb47af" class="image"><a href="https://i.imgur.com/PSrmz5O.png"><img style="width:1056px" src="https://i.imgur.com/PSrmz5O.png"/></a></figure><h3 id="f48ee417-39f2-409d-925f-72ec966898e8" class="">netstat</h3><p id="0e9e9039-b375-47e6-9708-24049138b7fb" class="">Following an initial check for existing interfaces and network routes, it is worth looking into existing communications. The <code>netstat</code> command can be used with several different options to gather information on existing connections.</p><ul id="63464705-1d60-4d85-b92a-0376bdee2c18" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -a</code>: shows all listening ports and established connections.</li></ul><ul id="1d4d2cbc-8ae3-4425-8a7c-69396e5814c4" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -at</code> or <code>netstat -au</code> can also be used to list TCP or UDP protocols respectively.</li></ul><ul id="d28d97ce-2444-4c47-9bfd-60b0ee109315" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -l</code>: list ports in “listening” mode. These ports are open and ready to accept incoming connections. This can be used with the “t” option to list only ports that are listening using the TCP protocol (below)</li></ul><figure id="17f96b1b-e8e3-47ef-bf5c-b95f62533551" class="image"><a href="https://i.imgur.com/BbLdyrr.png"><img style="width:1056px" src="https://i.imgur.com/BbLdyrr.png"/></a></figure><ul id="8ac1bfbf-3144-488d-a2d5-86e3dc99c2fe" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -s</code>: list network usage statistics by protocol (below) This can also be used with the <code>t</code> or <code>u</code> options to limit the output to a specific protocol.</li></ul><figure id="e7310414-fcb8-474b-8e8a-b69926063f43" class="image"><a href="https://i.imgur.com/mc8OWP0.png"><img style="width:480px" src="https://i.imgur.com/mc8OWP0.png"/></a></figure><ul id="34828429-0fb5-41f8-87e4-ef1dd9b490b2" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -tp</code>: list connections with the service name and PID information.</li></ul><figure id="db62364f-c489-463d-bf3f-5d2c7ec4e565" class="image"><a href="https://i.imgur.com/fDYQwbW.png"><img style="width:1056px" src="https://i.imgur.com/fDYQwbW.png"/></a></figure><p id="5395fcfe-d6fe-4199-8d12-52b16557256d" class="">This can also be used with the <code>-l</code> option to list listening ports (below)</p><figure id="ce94eb9e-6398-486e-bd5f-f412cad3e445" class="image"><a href="https://i.imgur.com/JK7DNv0.png"><img style="width:1056px" src="https://i.imgur.com/JK7DNv0.png"/></a></figure><p id="409991fc-62f1-4e22-8368-be9bfa919880" class="">We can see the “PID/Program name” column is empty as this process is owned by another user.</p><p id="a56a0549-e826-4024-a160-5bc633d28e17" class="">Below is the same command run with root privileges and reveals this information as 2641/nc (netcat)</p><figure id="9b36a118-4394-4fa3-bc73-16fc5f9fa04e" class="image"><a href="https://i.imgur.com/FjZHqlY.png"><img style="width:1056px" src="https://i.imgur.com/FjZHqlY.png"/></a></figure><ul id="4b7959fb-8146-4fa7-b4c2-e0b5f7f2dc85" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -i</code>: Shows interface statistics. We see below that “eth0” and “tun0” are more active than “tun1”.</li></ul><figure id="5560e2e1-07b6-4826-bd17-5cb051aa4023" class="image"><a href="https://i.imgur.com/r6IjpmZ.png"><img style="width:1056px" src="https://i.imgur.com/r6IjpmZ.png"/></a></figure><p id="d4435162-7c4b-4cf7-89f4-7661b8809309" class="">The <code>netstat</code> usage you will probably see most often in blog posts, write-ups, and courses is <code>netstat -ano</code> which could be broken down as follows;</p><ul id="5bc59dd3-4c0b-4fc8-ad58-060a2fb7cb58" class="bulleted-list"><li style="list-style-type:disc"><code>a</code>: Display all sockets</li></ul><ul id="7669239f-94f7-4b0b-b4ce-a07c10fc497a" class="bulleted-list"><li style="list-style-type:disc"><code>n</code>: Do not resolve names</li></ul><ul id="6790976e-88af-4f11-8d5c-5c3f6f196c96" class="bulleted-list"><li style="list-style-type:disc"><code>o</code>: Display timers</li></ul><figure id="80b99a90-f80e-47dd-96c6-5035cf73a810" class="image"><a href="https://i.imgur.com/UxzLBRw.png"><img style="width:1056px" src="https://i.imgur.com/UxzLBRw.png"/></a></figure><h3 id="5fba708d-c27a-4e77-8e96-9e0e6d26d0d5" class=""><strong>find Command</strong></h3><p id="c2b9ca5a-ab88-472d-8a99-3aa88f2e0c9e" class="">Searching the target system for important information and potential privilege escalation vectors can be fruitful. The built-in “find” command is useful and worth keeping in your arsenal.</p><p id="394d00ba-078d-430c-91b4-5154ff22b263" class="">Below are some useful examples for the “find” command.</p><p id="efdca2f3-5365-489f-b704-d02eabb34e36" class=""><strong>Find files:</strong></p><ul id="1bfb80b0-db38-4914-b8ae-d4a1f4b13b52" class="bulleted-list"><li style="list-style-type:disc"><code>find . -name flag1.txt</code>: find the file named “flag1.txt” in the current directory</li></ul><ul id="0bda4009-d1db-4ca6-8559-1a6c1fd4322f" class="bulleted-list"><li style="list-style-type:disc"><code>find /home -name flag1.txt</code>: find the file names “flag1.txt” in the /home directory</li></ul><ul id="04b14c7b-7596-49aa-aa6c-de4605b68320" class="bulleted-list"><li style="list-style-type:disc"><code>find / -type d -name config</code>: find the directory named config under “/”</li></ul><ul id="4b887b44-cdf3-4de8-8a1c-2613a6f9c000" class="bulleted-list"><li style="list-style-type:disc"><code>find / -type f -perm 0777</code>: find files with the 777 permissions (files readable, writable, and executable by all users)</li></ul><ul id="1b4c1dee-dc88-4528-9461-c5d6060035ca" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm a=x</code>: find executable files</li></ul><ul id="3561ccde-dc2f-4752-8130-45c2f3b11abc" class="bulleted-list"><li style="list-style-type:disc"><code>find /home -user frank</code>: find all files for user “frank” under “/home”</li></ul><ul id="300c88b3-5ba9-4401-831b-08b0f1c8b3bc" class="bulleted-list"><li style="list-style-type:disc"><code>find / -mtime 10</code>: find files that were modified in the last 10 days</li></ul><ul id="7295df80-53c2-4449-b99c-c9beaccb4f45" class="bulleted-list"><li style="list-style-type:disc"><code>find / -atime 10</code>: find files that were accessed in the last 10 day</li></ul><ul id="06b6ea48-d096-4251-9008-7c252ea6990a" class="bulleted-list"><li style="list-style-type:disc"><code>find / -cmin -60</code>: find files changed within the last hour (60 minutes)</li></ul><ul id="b2cecd97-1abf-4863-972f-e427efd58013" class="bulleted-list"><li style="list-style-type:disc"><code>find / -amin -60</code>: find files accesses within the last hour (60 minutes)</li></ul><ul id="9e4f695f-d967-468d-b2c3-5958c94d2bff" class="bulleted-list"><li style="list-style-type:disc"><code>find / -size 50M</code>: find files with a 50 MB size</li></ul><p id="8ee2f392-aedc-4b3e-88f2-e8ad66584978" class="">This command can also be used with (+) and (-) signs to specify a file that is larger or smaller than the given size.</p><figure id="1578960f-d757-40fc-a415-507c76376f09" class="image"><a href="https://i.imgur.com/pSMfoz4.png"><img style="width:1056px" src="https://i.imgur.com/pSMfoz4.png"/></a></figure><p id="9ce03247-5c25-4b8c-9791-529ea15cf1d6" class="">The example above returns files that are larger than 100 MB. It is important to note that the “find” command tends to generate errors which sometimes makes the output hard to read. This is why it would be wise to use the “find” command with “-type f 2&gt;/dev/null” to redirect errors to “/dev/null” and have a cleaner output (below).</p><figure id="574db842-ffe9-4dca-bf3c-2548f0bc532a" class="image"><a href="https://i.imgur.com/UKYSdE3.png"><img style="width:1056px" src="https://i.imgur.com/UKYSdE3.png"/></a></figure><p id="eb6e264f-14eb-4a6c-95aa-4d61e7820101" class="">Folders and files that can be written to or executed from:</p><ul id="3752c15b-dc7e-4b0f-a4ac-56b34cd75872" class="bulleted-list"><li style="list-style-type:disc"><code>find / -writable -type d 2&gt;/dev/null</code> : Find world-writeable folders</li></ul><ul id="21a42c4d-4f4f-413d-9f74-0cd83f3bbde6" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -222 -type d 2&gt;/dev/null</code>: Find world-writeable folders</li></ul><ul id="52441839-9845-4da3-aedc-d4a4da134a8f" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -o w -type d 2&gt;/dev/null</code>: Find world-writeable folders</li></ul><p id="b7e590ff-310a-450d-8194-dd96a97708e0" class="">The reason we see three different “find” commands that could potentially lead to the same result can be seen in the manual document. As you can see below, the perm parameter affects the way “find” works.</p><figure id="c2284188-1b40-4f90-92b7-6777ad613498" class="image"><a href="https://i.imgur.com/qb0klHH.png"><img style="width:1056px" src="https://i.imgur.com/qb0klHH.png"/></a></figure><ul id="42d965b3-a48d-4a34-b745-c0284283f95a" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -o x -type d 2&gt;/dev/null</code> : Find world-executable folders</li></ul><p id="5abab248-ff60-4918-8627-f4d43609999d" class="">Find development tools and supported languages:</p><ul id="f84d080b-b32c-476e-95d4-a50c9b71a79b" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name perl*</code></li></ul><ul id="4b760374-9522-49c6-8b92-ba71f133df6e" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name python*</code></li></ul><ul id="5ba39bfd-7f63-437b-acc8-e37e912a2b1f" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name gcc*</code></li></ul><p id="d9e82ac5-3efc-48be-bb2c-8e993766fffb" class="">Find specific file permissions:</p><p id="46082dd8-598d-46c0-ac4a-9e3b8ceb3c73" class="">Below is a short example used to find files that have the SUID bit set. The SUID bit allows the file to run with the privilege level of the account that owns it, rather than the account which runs it. This allows for an interesting privilege escalation path,we will see in more details on task 6. The example below is given to complete the subject on the “find” command.</p><ul id="38f5da8d-31d2-4841-a89b-28e3482b814d" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -u=s -type f 2&gt;/dev/null</code>: Find files with the SUID bit, which allows us to run the file with a higher privilege level than the current user.</li></ul><h3 id="39598694-488a-431d-9357-b425f2d95cdc" class=""><strong>General Linux Commands</strong></h3><p id="41d85ca1-3188-4d06-a561-8df545691503" class="">As we are in the Linux realm, familiarity with Linux commands, in general, will be very useful. Please spend some time getting comfortable with commands such as <code>find</code>, <code>locate</code>, <code>grep</code>, <code>cut</code>, <code>sort</code>, etc.</p></details></li></ul><ul id="0f5be45a-f4ec-40e7-afe6-a55174b801d9" class="toggle"><li><details open=""><summary>Automated Enumeration Tools</summary><p id="b440b184-fb3d-4133-8f92-4e06baf732c1" class="">Several tools can help you save time during the enumeration process. These tools should only be used to save time knowing they may miss some privilege escalation vectors. Below is a list of popular Linux enumeration tools with links to their respective Github repositories.</p><p id="5a27b362-1e12-43f9-879f-32090c4fdd93" class="">The target system’s environment will influence the tool you will be able to use. For example, you will not be able to run a tool written in Python if it is not installed on the target system. This is why it would be better to be familiar with a few rather than having a single go-to tool.</p><ul id="1ef8e1f6-d8ad-4315-a4d4-36ace6c8eb3c" class="bulleted-list"><li style="list-style-type:disc"><strong>LinPeas</strong>: <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</a></li></ul><ul id="f84a917a-8846-4ecc-a02c-3adc3ce30f72" class="bulleted-list"><li style="list-style-type:disc"><strong>LinEnum: </strong><a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></li></ul><ul id="f200ec9b-db36-44df-b7a1-866d6eae20cc" class="bulleted-list"><li style="list-style-type:disc"><strong>LES (</strong><strong>Linux</strong><strong> Exploit Suggester): </strong><a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a></li></ul><ul id="38560203-20d8-4469-88e3-c1178afa4eee" class="bulleted-list"><li style="list-style-type:disc"><strong>Linux</strong><strong> Smart Enumeration: </strong><a href="https://github.com/diego-treitos/linux-smart-enumeration">https://github.com/diego-treitos/linux-smart-enumeration</a></li></ul><ul id="a0d0ddf5-2260-4220-8266-8860d78bdda2" class="bulleted-list"><li style="list-style-type:disc"><strong>Linux</strong><strong> Priv Checker:</strong> <a href="https://github.com/linted/linuxprivchecker">https://github.com/linted/linuxprivchecker</a></li></ul></details></li></ul><ul id="c9c2e722-6079-4dfe-bfb2-e7d9ad75a197" class="toggle"><li><details open=""><summary>Privilege Escalation: Kernel Exploits</summary><p id="ea916c44-b372-4549-ad17-54e1764cb68f" class="">Privilege escalation ideally leads to root privileges. This can sometimes be achieved simply by exploiting an existing vulnerability, or in some cases by accessing another user account that has more privileges, information, or access.</p><p id="35aa807e-4f0c-4704-beb3-8618407faeda" class="">Unless a single vulnerability leads to a root shell, the privilege escalation process will rely on misconfigurations and lax permissions.</p><p id="0e48525e-485b-463e-a2f8-e7b1de1b8453" class="">The kernel on Linux systems manages the communication between components such as the memory on the system and applications. This critical function requires the kernel to have specific privileges; thus, a successful exploit will potentially lead to root privileges.</p><p id="cd36e766-e80a-40ff-adb4-855bd4540700" class="">The Kernel exploit methodology is simple;</p><ol type="1" id="364a16ab-576f-4d70-b014-253f673da8a4" class="numbered-list" start="1"><li>Identify the kernel version</li></ol><ol type="1" id="b35b24cf-6c34-4944-9374-48dd37c872a8" class="numbered-list" start="2"><li>Search and find an exploit code for the kernel version of the target system</li></ol><ol type="1" id="5ada1064-3f23-42d4-ba0d-4abb07a68203" class="numbered-list" start="3"><li>Run the exploit</li></ol><p id="89a0afaa-241b-4168-84ce-1f29c1e56f68" class="">Although it looks simple, please remember that a failed kernel exploit can lead to a system crash. Make sure this potential outcome is acceptable within the scope of your penetration testing engagement before attempting a kernel exploit.</p><p id="2807d0f1-a2d1-4ed0-ad66-0a887c1d9630" class=""><strong>Research sources:</strong></p><ol type="1" id="4bc0609c-1176-40a5-95da-624718fc4e2b" class="numbered-list" start="1"><li>Based on your findings, you can use Google to search for an existing exploit code.</li></ol><ol type="1" id="4521e2f0-6df2-447b-a5cb-11b371e90a90" class="numbered-list" start="2"><li>Sources such as <a href="https://www.linuxkernelcves.com/cves">https://www.linuxkernelcves.com/cves</a> can also be useful.</li></ol><ol type="1" id="e94fe6ef-eea5-473f-afa4-4ac9877f38f9" class="numbered-list" start="3"><li>Another alternative would be to use a script like LES (Linux Exploit Suggester) but remember that these tools can generate false positives (report a kernel vulnerability that does not affect the target system) or false negatives (not report any kernel vulnerabilities although the kernel is vulnerable).</li></ol><p id="49483bf9-34b8-498f-a98d-1e6a8a6e65c8" class=""><strong>Hints/Notes:</strong></p><ol type="1" id="ea088fc3-3862-436a-a9a6-02aec08e9f50" class="numbered-list" start="1"><li>Being too specific about the kernel version when searching for exploits on Google, Exploit-db, or searchsploit</li></ol><ol type="1" id="adb3b8d4-1f75-4dfd-a3cf-b20b47202a93" class="numbered-list" start="2"><li>Be sure you understand how the exploit code works BEFORE you launch it. Some exploit codes can make changes on the operating system that would make them unsecured in further use or make irreversible changes to the system, creating problems later. Of course, these may not be great concerns within a lab or CTF environment, but these are absolute no-nos during a real penetration testing engagement.</li></ol><ol type="1" id="2334fdca-cde0-48e4-9a27-a0408368300f" class="numbered-list" start="3"><li>Some exploits may require further interaction once they are run. Read all comments and instructions provided with the exploit code.</li></ol><ol type="1" id="b2058e7d-6fa2-43b0-b3cc-7ef3e2f3274b" class="numbered-list" start="4"><li>You can transfer the exploit code from your machine to the target system using the <code>SimpleHTTPServer</code> Python module and <code>wget</code> respectively.</li></ol></details></li></ul><ul id="18f1cead-ce8b-43d6-ab69-2fcdd0cfb7d3" class="toggle"><li><details open=""><summary>Privilege Escalation: Sudo</summary><p id="1fa2c7a2-4e8d-40b0-9d82-f4dd98c5cf5e" class="">The sudo command, by default, allows you to run a program with root privileges. Under some conditions, system administrators may need to give regular users some flexibility on their privileges. For example, a junior SOC analyst may need to use Nmap regularly but would not be cleared for full root access. In this situation, the system administrator can allow this user to only run Nmap with root privileges while keeping its regular privilege level throughout the rest of the system.</p><p id="d107bea5-0fc6-4339-a28e-f3a15dcfea88" class="">Any user can check its current situation related to root privileges using the <code>sudo -l</code> command.</p><p id="7866da11-8b13-4fd1-934f-d50584c2e725" class=""><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a> is a valuable source that provides information on how any program, on which you may have sudo rights, can be used.</p><p id="bcbeb9f4-167f-456a-ad08-cf61e83706a3" class=""><strong>Leverage application functions</strong></p><p id="fed8852c-cd9b-403d-972d-91b004b3047e" class="">Some applications will not have a known exploit within this context. Such an application you may see is the Apache2 server.</p><p id="065e9304-b663-4472-82d4-c2b8095ac05d" class="">In this case, we can use a &quot;hack&quot; to leak information leveraging a function of the application. As you can see below, Apache2 has an option that supports loading alternative configuration files (<code>-f</code> : specify an alternate ServerConfigFile).</p><figure id="ab235dd3-f498-48e0-b693-7fd7b3967998" class="image"><a href="https://i.imgur.com/rNpbbL8.png"><img src="https://i.imgur.com/rNpbbL8.png"/></a></figure><p id="3d3c9752-cd31-4d75-bdb6-c6c920959f58" class="">Loading the <code>/etc/shadow</code> file using this option will result in an error message that includes the first line of the <code>/etc/shadow</code> file.</p><p id="38360294-dfea-4b2b-b60c-6a36eeff77e6" class=""><strong>Leverage LD_PRELOAD</strong></p><p id="9343580b-7ca2-42ea-86f5-299e45ef77fe" class="">On some systems, you may see the LD_PRELOAD environment option.</p><figure id="6f0cb976-c1ca-4344-b17a-19ca09106003" class="image"><a href="https://i.imgur.com/gGstS69.png"><img src="https://i.imgur.com/gGstS69.png"/></a></figure><p id="2c468db9-9568-4117-8795-a98d2624b450" class="">LD_PRELOAD is a function that allows any program to use shared libraries. This <a href="https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/">blog post</a> will give you an idea about the capabilities of LD_PRELOAD. If the &quot;env_keep&quot; option is enabled we can generate a shared library which will be loaded and executed before the program is run. Please note the LD_PRELOAD option will be ignored if the real user ID is different from the effective user ID.</p><p id="bae13daa-7bd4-4200-93ce-1d6d346acd46" class="">The steps of this privilege escalation vector can be summarized as follows;</p><ol type="1" id="159eefbf-dde6-49d3-a448-1a70bc26c987" class="numbered-list" start="1"><li>Check for LD_PRELOAD (with the env_keep option)</li></ol><ol type="1" id="d477f765-4dbc-4af5-ad73-aa838abcb8d6" class="numbered-list" start="2"><li>Write a simple C code compiled as a share object (.so extension) file</li></ol><ol type="1" id="5a7ce8df-6551-47e2-8f3d-8c3a5c644c66" class="numbered-list" start="3"><li>Run the program with sudo rights and the LD_PRELOAD option pointing to our .so file</li></ol><p id="ee808469-7106-4a1f-a7d5-c8cd8ada2d9e" class="">The C code will simply spawn a root shell and can be written as follows;</p><p id="1c3e3abf-d9fd-4bb2-94f3-2ae75557e83b" class="">#include &lt;stdio.h&gt;</p><p id="a8bc67cc-6443-48b4-858e-2a20171d9a28" class="">#include &lt;sys/types.h&gt;</p><p id="38fb4cd4-797e-4851-99ee-0b996f159746" class="">#include &lt;stdlib.h&gt;</p><p id="f50c5277-ad83-4cfe-a2d4-b6b2428f4edf" class="">void _init() {</p><p id="4dc88a43-f9e1-466c-b7ea-0b83c012e801" class="">unsetenv(&quot;LD_PRELOAD&quot;);</p><p id="aacb073d-8113-4889-9b51-d8b07876dd62" class="">setgid(0);</p><p id="1c805dac-2b12-4e16-a23f-81fe23287248" class="">setuid(0);</p><p id="110adc36-ef94-4de8-8f48-a8348f4a1583" class="">system(&quot;/bin/bash&quot;);</p><p id="511252eb-dfba-456d-905f-99356b5c6878" class="">}</p><p id="47b6a489-7f77-4433-b097-7607c69ac36c" class="">We can save this code as shell.c and compile it using gcc into a shared object file using the following parameters;</p><p id="abc98ebb-bb7d-4b92-a72f-dae061b8ad7e" class=""><code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code></p><figure id="f5799145-a15e-4a2f-8941-52f82bdbd413" class="image"><a href="https://i.imgur.com/HxbszMW.png"><img src="https://i.imgur.com/HxbszMW.png"/></a></figure><p id="1d2eea58-7b92-4980-9ee7-454031a5f60f" class="">We can now use this shared object file when launching any program our user can run with sudo. In our case, Apache2, find, or almost any of the programs we can run with sudo can be used.</p><p id="6aef8b3b-0182-405b-93ac-00a36d949c16" class="">We need to run the program by specifying the LD_PRELOAD option, as follows;</p><p id="4b12bead-4a8c-45f5-b0f8-a96a64240601" class=""><code>sudo LD_PRELOAD=/home/user/ldpreload/shell.so find</code></p><p id="8e956c88-d8da-4fc8-9991-1f2f9995626c" class="">This will result in a shell spawn with root privileges.</p><figure id="7d18d75b-dbb3-4893-8cda-6dbf86290ce6" class="image"><a href="https://i.imgur.com/1YwARyZ.png"><img src="https://i.imgur.com/1YwARyZ.png"/></a></figure></details></li></ul><ul id="13ca5f84-0e76-467d-8d38-4f8e512bc7a9" class="toggle"><li><details open=""><summary>Privilege Escalation: SUID</summary><p id="fb36b6f2-0816-4ab6-8d60-636d780a5bed" class="">Much of Linux privilege controls rely on controlling the users and files interactions. This is done with permissions. By now, you know that files can have read, write, and execute permissions. These are given to users within their privilege levels. This changes with SUID (Set-user Identification) and SGID (Set-group Identification). These allow files to be executed with the permission level of the file owner or the group owner, respectively.</p><p id="d79d10bb-6a05-496a-be64-db343ecd5ac4" class="">You will notice these files have an “s” bit set showing their special permission level.</p><p id="0bfc6f4e-e76f-450a-a9c9-34071c00b00f" class=""><code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code> will list files that have SUID or SGID bits set.</p><figure id="47b08818-ef9b-4e00-8e1a-85e8d812e85e" class="image"><a href="https://i.imgur.com/fJEeZ4m.png"><img src="https://i.imgur.com/fJEeZ4m.png"/></a></figure><p id="ba02ec73-24b0-437f-b1fb-e23ab9ef3166" class="">A good practice would be to compare executables on this list with GTFOBins (<a href="https://gtfobins.github.io/">https://gtfobins.github.io</a>). Clicking on the SUID button will filter binaries known to be exploitable when the SUID bit is set (you can also use this link for a pre-filtered list <a href="https://gtfobins.github.io/#+suid">https://gtfobins.github.io/#+suid</a>).</p><p id="f41bc0af-6e6f-4fe8-af54-37f8d0f8eea8" class="">The list above shows that nano has the SUID bit set. Unfortunately, GTFObins does not provide us with an easy win. Typical to real-life privilege escalation scenarios, we will need to find intermediate steps that will help us leverage whatever minuscule finding we have.</p><figure id="8c6f272f-de81-413a-acac-418161cb3d25" class="image"><a href="https://i.imgur.com/rSRTn5v.png"><img src="https://i.imgur.com/rSRTn5v.png"/></a></figure><p id="0a335bda-0db6-4ef3-8e40-b697603c945c" class="">The SUID bit set for the nano text editor allows us to create, edit and read files using the file owner’s privilege. Nano is owned by root, which probably means that we can read and edit files at a higher privilege level than our current user has. At this stage, we have two basic options for privilege escalation: reading the <code>/etc/shadow</code> file or adding our user to <code>/etc/passwd</code>.</p><p id="f5987c0e-ad26-4cb8-a74f-caa6dc31a4b2" class="">Below are simple steps using both vectors.</p><p id="007f79f6-917c-4808-aa40-2f6968c3cfb1" class="">reading the <code>/etc/shadow</code> file</p><p id="7dc37c3e-9613-4194-b6d1-d8de69aa8a73" class="">We see that the nano text editor has the SUID bit set by running the <code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code> command.</p><p id="9a5c3a07-4f6f-4a4d-b5d4-e508290f1e03" class=""><code>nano /etc/shadow</code> will print the contents of the <code>/etc/shadow</code> file. We can now use the unshadow tool to create a file crackable by John the Ripper. To achieve this, unshadow needs both the <code>/etc/shadow</code> and <code>/etc/passwd</code> files.</p><figure id="cd3a409b-e623-446f-a470-becb176e79e3" class="image"><a href="https://i.imgur.com/DAWxbJD.png"><img src="https://i.imgur.com/DAWxbJD.png"/></a></figure><p id="c10dbc2d-2306-4a11-b18e-a8bd4f16c719" class="">The unshadow tool’s usage can be seen below;</p><p id="1c9755e3-1860-46cb-b088-a6b8c19356ab" class=""><code>unshadow passwd.txt shadow.txt &gt; passwords.txt</code></p><figure id="c8f71483-8896-4e5b-9493-50bfc12e900b" class="image"><a href="https://i.imgur.com/6cHBAr1.png"><img src="https://i.imgur.com/6cHBAr1.png"/></a></figure><p id="1ba1c87e-883d-48bd-86b2-c2eea973b48a" class="">With the correct wordlist and a little luck, John the Ripper can return one or several passwords in cleartext. For a more detailed room on John the Ripper, you can visit <a href="https://tryhackme.com/room/johntheripper0">https://tryhackme.com/room/johntheripper0</a></p><p id="65a327e9-7066-4f90-ba86-7e21ee165e34" class="">The other option would be to add a new user that has root privileges. This would help us circumvent the tedious process of password cracking. Below is an easy way to do it:</p><p id="98a84e39-8b25-481e-8b6a-38347112811e" class="">We will need the hash value of the password we want the new user to have. This can be done quickly using the openssl tool on Kali Linux.</p><figure id="5a3464e1-2c5b-457c-8cd9-f549f2013bd2" class="image"><a href="https://i.imgur.com/bkOGaHY.png"><img src="https://i.imgur.com/bkOGaHY.png"/></a></figure><p id="568a3744-0f0a-457e-ae9f-9b385c744407" class="">We will then add this password with a username to the <code>/etc/passwd</code> file.</p><figure id="f6ff9608-3011-4631-a90c-500330977d11" class="image"><a href="https://i.imgur.com/huGoEtj.png"><img src="https://i.imgur.com/huGoEtj.png"/></a></figure><p id="084b05c4-8d6a-49c2-a323-cac7b2aa27e6" class="">Once our user is added (please note how <code>root:/bin/bash</code> was used to provide a root shell) we will need to switch to this user and hopefully should have root privileges.</p><figure id="e08c4485-31cb-447b-81b0-6f816dda24d9" class="image"><a href="https://i.imgur.com/HZcWGhi.png"><img src="https://i.imgur.com/HZcWGhi.png"/></a></figure></details></li></ul><ul id="367c98c4-8606-43c3-995d-349d2e733925" class="toggle"><li><details open=""><summary>Privilege Escalation: Capabilities</summary><p id="4af42b20-2adf-47a6-8d73-97853c261c3c" class="">Another method system administrators can use to increase the privilege level of a process or binary is “Capabilities”. Capabilities help manage privileges at a more granular level. For example, if the SOC analyst needs to use a tool that needs to initiate socket connections, a regular user would not be able to do that. If the system administrator does not want to give this user higher privileges, they can change the capabilities of the binary. As a result, the binary would get through its task without needing a higher privilege user.</p><p id="b7500beb-ec26-4e2c-a13e-53174008673e" class="">The capabilities man page provides detailed information on its usage and options.</p><p id="9c2519cf-aef7-4736-b936-7adc8c4db28b" class="">We can use the <code>getcap</code> tool to list enabled capabilities.</p><figure id="9a5b0c90-2451-4207-9205-82aaf1f68ae8" class="image"><a href="https://i.imgur.com/Q6XYr0p.png"><img src="https://i.imgur.com/Q6XYr0p.png"/></a></figure><p id="96521de9-a7df-4555-8cfd-8c74d2840ea8" class="">When run as an unprivileged user, <code>getcap -r /</code> will generate a huge amount of errors, so it is good practice to redirect the error messages to /dev/null.</p><p id="30ea31a7-64b4-44b5-a990-06fe9643eb99" class="">Please note that neither vim nor its copy has the SUID bit set. This privilege escalation vector is therefore not discoverable when enumerating files looking for SUID.</p><figure id="6bc59c4b-96a2-4b37-b2fd-1593e6916f07" class="image"><a href="https://i.imgur.com/6csoabB.png"><img src="https://i.imgur.com/6csoabB.png"/></a></figure><p id="ee4e3f7a-f26e-44cb-8fbc-7827225f0fc2" class="">GTFObins has a good list of binaries that can be leveraged for privilege escalation if we find any set capabilities.</p><p id="d7e7dccb-c28b-4f59-afc4-d8e313cda7e6" class="">We notice that vim can be used with the following command and payload:</p><figure id="aa4098e8-0882-4af0-a38f-3209c5f88f23" class="image"><a href="https://i.imgur.com/nlpCMWj.png"><img src="https://i.imgur.com/nlpCMWj.png"/></a></figure><p id="b61415c9-8942-4784-9e28-5dfced135e5c" class="">This will launch a root shell as seen below;</p><figure id="96d1c0ed-58df-4cc0-ae77-aba3b094b07b" class="image"><a href="https://i.imgur.com/jCjvgo3.png"><img src="https://i.imgur.com/jCjvgo3.png"/></a></figure></details></li></ul><ul id="5881c807-2024-40bb-bdbb-79d4eb52e9a8" class="toggle"><li><details open=""><summary>Privilege Escalation: Cron Jobs</summary><p id="bd0552ed-fe34-4e55-a554-834b6310428c" class="">Cron jobs are used to run scripts or binaries at specific times. By default, they run with the privilege of their owners and not the current user. While properly configured cron jobs are not inherently vulnerable, they can provide a privilege escalation vector under some conditions.</p><p id="8f8b73f2-7970-4daa-a6a2-ca2b018d34bf" class="">The idea is quite simple; if there is a scheduled task that runs with root privileges and we can change the script that will be run, then our script will run with root privileges.</p><p id="faa9b8a8-bf34-4a69-a287-04b5f54a5696" class="">Cron job configurations are stored as crontabs (cron tables) to see the next time and date the task will run.</p><p id="fb6b593f-dd49-499b-9baa-1634a793b1e0" class="">Each user on the system have their crontab file and can run specific tasks whether they are logged in or not. As you can expect, our goal will be to find a cron job set by root and have it run our script, ideally a shell.</p><p id="22ba59a6-8abe-4f86-b614-d97c7872572a" class="">Any user can read the file keeping system-wide cron jobs under <code>/etc/crontab</code></p><p id="a5f1cb5b-eccc-45d3-919d-0ad9722e3fb7" class="">While CTF machines can have cron jobs running every minute or every 5 minutes, you will more often see tasks that run daily, weekly or monthly in penetration test engagements.</p><figure id="7c6624a9-b67c-4b87-bce0-118877699220" class="image"><a href="https://i.imgur.com/fwqPuHN.png"><img src="https://i.imgur.com/fwqPuHN.png"/></a></figure><p id="8cf19a31-2de1-498a-a9ae-90ef17f31fd5" class="">You can see the <code>backup.sh</code> script was configured to run every minute. The content of the file shows a simple script that creates a backup of the prices.xls file.</p><figure id="19042b5b-b6b8-4f0c-9aed-d0c3f7512422" class="image"><a href="https://i.imgur.com/qlDj93R.png"><img src="https://i.imgur.com/qlDj93R.png"/></a></figure><p id="162673c7-b179-48b2-b385-1f210715656c" class="">As our current user can access this script, we can easily modify it to create a reverse shell, hopefully with root privileges.</p><p id="35f214e1-a1c4-4603-92b2-08a8cd09d3a4" class="">The script will use the tools available on the target system to launch a reverse shell.</p><p id="55553c90-dccd-4892-8107-219ba63b0e79" class="">Two points to note;</p><ol type="1" id="3ffeed1f-a4c1-4469-9dd6-3f68bdaee64b" class="numbered-list" start="1"><li>The command syntax will vary depending on the available tools. (e.g. <code>nc</code> will probably not support the <code>e</code> option you may have seen used in other cases)</li></ol><ol type="1" id="bacd6633-e395-48a7-a47d-d22095d4c938" class="numbered-list" start="2"><li>We should always prefer to start reverse shells, as we not want to compromise the system integrity during a real penetration testing engagement.</li></ol><p id="53e2b3c7-1376-4daa-b5e3-00e29f7bd46d" class="">The file should look like this;</p><figure id="efcb90d6-ecc6-4f2b-9f61-04dded7fa7fe" class="image"><a href="https://i.imgur.com/579yg6H.png"><img src="https://i.imgur.com/579yg6H.png"/></a></figure><p id="c1267b9e-c7d6-47c9-b9d7-17391f35325e" class="">We will now run a listener on our attacking machine to receive the incoming connection.</p><figure id="de143fb9-9b61-4518-983c-c9f1f954361b" class="image"><a href="https://i.imgur.com/xwYXfY1.png"><img src="https://i.imgur.com/xwYXfY1.png"/></a></figure><p id="d58c83ea-2737-4a13-b0f4-1f2b4a730b70" class="">Crontab is always worth checking as it can sometimes lead to easy privilege escalation vectors. The following scenario is not uncommon in companies that do not have a certain cyber security maturity level:</p><ol type="1" id="b755f411-1b77-4141-8809-eb6b83ed2203" class="numbered-list" start="1"><li>System administrators need to run a script at regular intervals.</li></ol><ol type="1" id="4dee2c10-b811-4774-b334-cd683f8b2592" class="numbered-list" start="2"><li>They create a cron job to do this</li></ol><ol type="1" id="b3997afa-b0cd-4fd2-81dc-a421f25582c7" class="numbered-list" start="3"><li>After a while, the script becomes useless, and they delete it</li></ol><ol type="1" id="b2846269-357d-4b25-9068-d8d8100ac9ee" class="numbered-list" start="4"><li>They do not clean the relevant cron job</li></ol><p id="307b8234-0f13-4ce6-8ec4-b9aef6b43e6c" class="">This change management issue leads to a potential exploit leveraging cron jobs.</p><figure id="82016cf9-98dd-4a14-840a-d950b80e02dd" class="image"><a href="https://i.imgur.com/SovymJL.png"><img src="https://i.imgur.com/SovymJL.png"/></a></figure><p id="114f5caa-afbe-4e0a-af0c-6f2ffc7887fd" class="">The example above shows a similar situation where the antivirus.sh script was deleted, but the cron job still exists.</p><p id="3f3910a2-c7ed-4c09-80ca-b09ca5b30437" class="">If the full path of the script is not defined (as it was done for the backup.sh script), cron will refer to the paths listed under the PATH variable in the /etc/crontab file. In this case, we should be able to create a script named “antivirus.sh” under our user’s home folder and it should be run by the cron job.</p><p id="93b13476-be6c-47ed-9af7-43d7f2d92c11" class="">The file on the target system should look familiar:</p><figure id="3dbd115c-1200-43bf-bace-d256490be7a3" class="image"><a href="https://i.imgur.com/SHknR87.png"><img src="https://i.imgur.com/SHknR87.png"/></a></figure><p id="90424264-cb1d-4e21-a381-9d58a28a4f2f" class="">The incoming reverse shell connection has root privileges:</p><figure id="6ff57297-cd92-4bb6-9044-109c61bd0e58" class="image"><a href="https://i.imgur.com/EBCue17.png"><img src="https://i.imgur.com/EBCue17.png"/></a></figure><p id="77d41a4f-d3e3-4cc5-aaac-f64780d19422" class="">In the odd event you find an existing script or task attached to a cron job, it is always worth spending time to understand the function of the script and how any tool is used within the context. For example, tar, 7z, rsync, etc., can be exploited using their wildcard feature.</p></details></li></ul><ul id="3e7b9046-cda0-49f6-bf12-47dd0a74fc79" class="toggle"><li><details open=""><summary>Privilege Escalation: PATH</summary><p id="2792b7b0-6149-4c80-87de-1d93c9ffe318" class="">If a folder for which your user has write permission is located in the path, you could potentially hijack an application to run a script. PATH in Linux is an environmental variable that tells the operating system where to search for executables. For any command that is not built into the shell or that is not defined with an absolute path, Linux will start searching in folders defined under PATH. (PATH is the environmental variable we&#x27;re talking about here, path is the location of a file).</p><p id="02e4e79c-a441-451b-8e5d-6a163728c4dd" class="">Typically the PATH will look like this:</p><figure id="8e3d5b98-7ff7-4ca0-8772-ca76b2d362bd" class="image"><a href="https://i.imgur.com/ch2Z4zp.png"><img src="https://i.imgur.com/ch2Z4zp.png"/></a></figure><p id="bb52594f-538c-455a-86b6-b0b6419a4c6c" class="">If we type “thm” to the command line, these are the locations Linux will look in for an executable called thm. The scenario below will give you a better idea of how this can be leveraged to increase our privilege level. As you will see, this depends entirely on the existing configuration of the target system, so be sure you can answer the questions below before trying this.</p><ol type="1" id="4534309e-83cd-465e-a62a-cdb7f8c1b17c" class="numbered-list" start="1"><li>What folders are located under $PATH</li></ol><ol type="1" id="318ac6c6-7a74-417b-9c32-d6fbe5f35869" class="numbered-list" start="2"><li>Does your current user have write privileges for any of these folders?</li></ol><ol type="1" id="64dcc0d1-a819-4172-b017-f64577889108" class="numbered-list" start="3"><li>Can you modify $PATH?</li></ol><ol type="1" id="0919380d-ef78-4148-8d13-8787119bae60" class="numbered-list" start="4"><li>Is there a script/application you can start that will be affected by this vulnerability?</li></ol><p id="d71d9808-388a-4bdc-8f28-c62e786c9cc3" class="">For demo purposes, we will use the script below:</p><figure id="32bd0090-8334-4aad-b7cb-5725fa3198ea" class="image"><a href="https://i.imgur.com/qX7m2Jq.png"><img src="https://i.imgur.com/qX7m2Jq.png"/></a></figure><p id="0e5db320-7eac-46e5-b073-639a9346e0b7" class="">This script tries to launch a system binary called “thm” but the example can easily be replicated with any binary.</p><p id="e563f303-8575-4783-896b-18298d38edc9" class="">We compile this into an executable and set the SUID bit.</p><figure id="4e496182-c201-4bba-9512-3e797411e2dd" class="image"><a href="https://i.imgur.com/A6QQ65I.png"><img src="https://i.imgur.com/A6QQ65I.png"/></a></figure><p id="8a562b13-e512-4e5a-a0b0-469fa328e6ed" class="">Our user now has access to the “path” script with SUID bit set.</p><figure id="744babf5-65c8-475a-9dbe-b6553c556470" class="image"><a href="https://i.imgur.com/Af1RpuY.png"><img src="https://i.imgur.com/Af1RpuY.png"/></a></figure><p id="06050fac-82ee-479e-956b-1ba821f27537" class="">Once executed “path” will look for an executable named “thm” inside folders listed under PATH.</p><p id="05ccd42d-3f83-4864-9ce3-fefde2a86d32" class="">If any writable folder is listed under PATH we could create a binary named thm under that directory and have our “path” script run it. As the SUID bit is set, this binary will run with root privilege</p><p id="5e6994f2-4924-4050-8fac-2280ad3ffc57" class="">A simple search for writable folders can done using the “<code>find / -writable 2&gt;/dev/null</code>” command. The output of this command can be cleaned using a simple cut and sort sequence.</p><figure id="37025276-77fb-4671-beb0-a474351e8a0b" class="image"><a href="https://i.imgur.com/7UekB3t.png"><img src="https://i.imgur.com/7UekB3t.png"/></a></figure><p id="490b7010-c558-4f94-b879-690de8120a6b" class="">Some CTF scenarios can present different folders but a regular system would output something like we see above.</p><p id="dfe9ff72-fb36-4937-bce5-2c4ae5587c33" class="">Comparing this with PATH will help us find folders we could use.</p><figure id="e8896a42-c17a-410c-8a3e-28481750a3e8" class="image"><a href="https://i.imgur.com/67mdmmG.png"><img src="https://i.imgur.com/67mdmmG.png"/></a></figure><p id="0e84831a-ecbf-4461-9d01-0a500c681c6f" class="">We see a number of folders under /usr, thus it could be easier to run our writable folder search once more to cover subfolders.</p><figure id="b8f2ea6f-8497-4d14-aaf7-c0f4b7f51450" class="image"><a href="https://i.imgur.com/Y3pDsrL.png"><img src="https://i.imgur.com/Y3pDsrL.png"/></a></figure><p id="2073e0d8-a178-4b52-8918-1256fc29ddac" class="">An alternative could be the command below.</p><p id="3de93a69-d182-414d-8ad1-390d7dbca32f" class=""><code>find / -writable 2&gt;/dev/null | cut -d &quot;/&quot; -f 2,3 | grep -v proc | sort -u</code></p><p id="7143da70-8b0e-4244-b8d4-45a3c9c7d77d" class="">We have added “grep -v proc” to get rid of the many results related to running processes.</p><p id="4a76b6b7-7f6c-41d0-9777-7be776251dd5" class="">Unfortunately, subfolders under /usr are not writable</p><p id="80c2cf6e-c04b-41b3-b12e-2057d9d07c7a" class="">The folder that will be easier to write to is probably /tmp. At this point because /tmp is not present in PATH so we will need to add it. As we can see below, the “<code>export PATH=/tmp:$PATH</code>” command accomplishes this.</p><figure id="256522b2-b8e4-4577-9536-683a2d8881af" class="image"><a href="https://i.imgur.com/u1PM8ZD.png"><img src="https://i.imgur.com/u1PM8ZD.png"/></a></figure><p id="a549f778-9c11-4fbb-a6bd-d28616d66fda" class="">At this point the path script will also look under the /tmp folder for an executable named “thm”.</p><p id="0306989c-ae08-42bf-a6d6-0978b5979cbc" class="">Creating this command is fairly easy by copying /bin/bash as “thm” under the /tmp folder.</p><figure id="b5444e8c-b311-4eda-ba70-d214004994e0" class="image"><a href="https://i.imgur.com/7UdrEnd.png"><img src="https://i.imgur.com/7UdrEnd.png"/></a></figure><p id="f49abd83-3ea8-4f80-80ec-bba027b19c2f" class="">We have given executable rights to our copy of /bin/bash, please note that at this point it will run with our user’s right. What makes a privilege escalation possible within this context is that the path script runs with root privileges.</p><figure id="46384661-7f62-482e-bfe1-3173cd549330" class="image"><a href="https://i.imgur.com/MlBJ8kb.png"><img src="https://i.imgur.com/MlBJ8kb.png"/></a></figure></details></li></ul><ul id="071889d3-10ca-4632-ae46-c5b4f23d491b" class="toggle"><li><details open=""><summary>Privilege Escalation: NFS</summary><p id="c11e99d2-45d0-43f7-9846-7d9894ad7bfc" class="">Privilege escalation vectors are not confined to internal access. Shared folders and remote management interfaces such as SSH and Telnet can also help you gain root access on the target system. Some cases will also require using both vectors, e.g. finding a root SSH private key on the target system and connecting via SSH with root privileges instead of trying to increase your current user’s privilege level.</p><p id="caa5356d-0c71-49c8-aad7-637d092dbed9" class="">Another vector that is more relevant to CTFs and exams is a misconfigured network shell. This vector can sometimes be seen during penetration testing engagements when a network backup system is present.</p><p id="e17d57fb-1842-4d9b-9be5-4af5e5013aa1" class="">NFS (Network File Sharing) configuration is kept in the /etc/exports file. This file is created during the NFS server installation and can usually be read by users.</p><figure id="788f1717-518d-4ab9-a20e-c5b629a3c78e" class="image"><a href="https://i.imgur.com/irDQTze.png"><img src="https://i.imgur.com/irDQTze.png"/></a></figure><p id="63223bad-3a9a-4518-89b6-b8e122518c2f" class="">The critical element for this privilege escalation vector is the “no_root_squash” option you can see above. By default, NFS will change the root user to nfsnobody and strip any file from operating with root privileges. If the “no_root_squash” option is present on a writable share, we can create an executable with SUID bit set and run it on the target system.</p><p id="1c1fab20-68ea-4b07-8ea2-7e7ab301bfac" class="">We will start by enumerating mountable shares from our attacking machine.</p><figure id="b25f064a-bb05-4b7e-9610-4724bfc3dea6" class="image"><a href="https://i.imgur.com/CmXPDcv.png"><img src="https://i.imgur.com/CmXPDcv.png"/></a></figure><p id="600489f9-eecf-4837-9cb0-03dcde7a3f36" class="">We will mount one of the “no_root_squash” shares to our attacking machine and start building our executable.</p><figure id="b4963cf4-7406-4c55-ad0e-0007e3069e36" class="image"><a href="https://i.imgur.com/DwAB1qs.png"><img src="https://i.imgur.com/DwAB1qs.png"/></a></figure><p id="10c0f744-1e6c-42ea-ab2c-09db47164b92" class="">As we can set SUID bits, a simple executable that will run /bin/bash on the target system will do the job.</p><figure id="52ebe866-f500-40da-9241-a0750dace80d" class="image"><a href="https://i.imgur.com/nWKpFkK.png"><img src="https://i.imgur.com/nWKpFkK.png"/></a></figure><p id="5ab8319b-329f-4dab-858f-87443ff44dbd" class="">Once we compile the code we will set the SUID bit.</p><figure id="f13419e0-70d6-4ad2-aaad-ba2c9f7a6800" class="image"><a href="https://i.imgur.com/rkZOOjZ.png"><img src="https://i.imgur.com/rkZOOjZ.png"/></a></figure><p id="56cec940-199f-4ab4-8f24-cca2affa44bd" class="">You will see below that both files (nfs.c and nfs are present on the target system. We have worked on the mounted share so there was no need to transfer them).</p><figure id="2f319a0b-22a6-4048-ad37-bdef360cfb21" class="image"><a href="https://i.imgur.com/U7IjT38.png"><img src="https://i.imgur.com/U7IjT38.png"/></a></figure><p id="1289e83a-7c33-4260-8f61-1aa622a9b813" class="">Notice the nfs executable has the SUID bit set on the target system and runs with root privileges.</p></details></li></ul><ul id="da5615fe-026e-48a8-84a5-6d6dadeda5b7" class="toggle"><li><details open=""><summary></summary></details></li></ul><p id="b4e279ce-6ff9-4acf-b1f4-281f63aadd10" class="">
</p></div></article></body></html>

        
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Study Guide</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="d9438285-9d65-4e92-8147-77f38b83b894" class="page sans"><header><img class="page-cover-image" src="https://images.unsplash.com/photo-1573767291321-c0af2eaf5266?ixlib=rb-4.0.3&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb" style="object-position:center 100%"/><h1 class="page-title">Study Guide</h1></header><div class="page-body"><h3 id="06e806b1-96b2-4adc-bbb4-2ffee634d7fc" class="block-color-purple_background">Introductory Research</h3><p id="31ec33b9-3c97-4ca8-bb97-7f64dbe5aed3" class="">To exploit specific software, use <a href="https://www.exploit-db.com/">ExploitDB, </a><a href="https://nvd.nist.gov/vuln/search">NVD, </a><a href="https://cve.mitre.org/">CVE Mitre</a>. (<strong>C</strong>ommon <strong>V</strong>ulnerabilities and <strong>E</strong>xposures) <mark class="highlight-pink"><code>CVE-YEAR-NUMBER</code></mark></p><h3 id="609aa9ff-c6bf-4491-9170-ca3646e429c1" class="block-color-purple_background"><strong>Linux Fundamentals Part 1</strong></h3><div id="7a126144-582d-43b4-9fed-a4bfcba1bbaa" class="column-list"><div id="d897b1da-2a9c-4dc7-872a-e7df3d160631" style="width:81.25%" class="column"><p id="50e8cbc7-b0d0-484b-a358-70be0f238358" class=""><strong>Where is Linux Used?</strong></p><p id="b6193974-84d6-491e-bce9-8b7f5a3418c0" class="">Linux is more lightweight than other Operating Systems; it <strong>powers:</strong> websites, car entertainment/control panels, Point of Sale (PoS) systems: checkout tills and registers, infrastructures: traffic light controllers/industrial sensors. Often there is no <strong>GUI</strong> (Graphical User Interface) - a desktop environment to interact with the machine. &quot;Linux&quot; is an <strong>umbrella term </strong>for multiple OS&#x27;s based on the OS UNIX. <em>Ubuntu Server can run on systems with only 512MB of RAM</em></p></div><div id="79c70397-5f7b-4fd9-8cb9-40503b41a77f" style="width:93.74999999999999%" class="column"><table id="979c4233-9719-41d7-b250-684ceacb407a" class="simple-table"><tbody><tr id="fca62dbe-659e-49ec-a429-69cd84a90130"><td id="{UCl" class="block-color-pink" style="width:82px"><strong>Operator</strong></td><td id="yn[C" class="block-color-pink" style="width:403px"><strong>Description</strong></td></tr><tr id="f95b70e6-d9f5-4db6-b4c8-c155aa8f132f"><td id="{UCl" class="" style="width:82px">&amp;</td><td id="yn[C" class="" style="width:403px">Runs commands in the background of your terminal</td></tr><tr id="ee7b2850-536e-42ec-8309-61cb8ef0c21b"><td id="{UCl" class="" style="width:82px">&amp;&amp;</td><td id="yn[C" class="" style="width:403px">Combines multiple commands in one line, only if firsts work</td></tr><tr id="1bdcfec6-a727-40cf-b7a3-c7a542992e84"><td id="{UCl" class="" style="width:82px">&gt;</td><td id="yn[C" class="" style="width:403px">Output redirector; directs output from command elsewhere</td></tr><tr id="f7cedad4-37f1-4b1c-86d6-5a90443234d2"><td id="{UCl" class="" style="width:82px">&gt;&gt;</td><td id="yn[C" class="" style="width:403px">Same as <mark class="highlight-pink"><code>&gt;</code></mark>  but appends output no replacing/overwriting</td></tr></tbody></table></div></div><h3 id="1bae73b3-6219-4faa-827b-5dc4fdcda1e0" class="block-color-purple_background"><strong>Linux Fundamentals Part 2</strong></h3><div id="9e4e5e42-5e7f-4215-adb6-57944d2bf3d8" class="column-list"><div id="cf106b4e-09f6-4643-8ac3-f66d74e73c28" style="width:31.25%" class="column"><table id="25228a70-b484-4b4a-a161-06cbc22d45f1" class="simple-table"><tbody><tr id="bde7c9dd-17f6-46ee-b4d3-7745c8b5cb91"><td id="dRDD" class="" style="width:94px"><strong><mark class="highlight-pink">Command</mark></strong></td><td id="`ZE:" class="" style="width:163px"><strong><mark class="highlight-pink">Purpose</mark></strong></td></tr><tr id="64e67552-8d34-424a-87b2-b48b8dd757e6"><td id="dRDD" class="" style="width:94px">touch</td><td id="`ZE:" class="" style="width:163px">Create file</td></tr><tr id="7dc0333c-5dc0-453b-9da5-d5846f6890d6"><td id="dRDD" class="" style="width:94px">mkdir</td><td id="`ZE:" class="" style="width:163px">Create folder</td></tr><tr id="da8b5366-9dbe-4512-8d48-c433cbacbc25"><td id="dRDD" class="" style="width:94px">cp</td><td id="`ZE:" class="" style="width:163px">Copy file or folder</td></tr><tr id="cab5700d-876b-41c2-a8c7-270e846baa2f"><td id="dRDD" class="" style="width:94px">mv</td><td id="`ZE:" class="" style="width:163px">Move file or folder</td></tr><tr id="cf7cebe2-7b4f-40e8-a7ae-ba6cb682fdfa"><td id="dRDD" class="" style="width:94px">rm</td><td id="`ZE:" class="" style="width:163px">Remove file, -r folder</td></tr><tr id="a5f1fc2e-7e5d-4a03-bec0-ac977442eeb0"><td id="dRDD" class="" style="width:94px">file</td><td id="`ZE:" class="" style="width:163px">Determine file type</td></tr></tbody></table></div><div id="a2784393-596a-411a-a729-271eebdb4e3f" style="width:68.75%" class="column"><p id="cf968cf4-dbf6-4f8f-93ae-d96fa72465f9" class=""><strong>Common Directories</strong></p><p id="07468fc7-658d-489d-9446-d2c815ac9e91" class=""><span style="border-bottom:0.05em solid"><strong>/etc - </strong></span>of the most important root dirs on system; common location to store system files used by the OS <mark class="highlight-pink"><code>lsshadow passwd sudoers sudoers.d</code></mark></p><p id="ea2a8c9a-16db-43ac-b104-9e97a5f0e7fe" class=""><span style="border-bottom:0.05em solid"><strong>/var - </strong></span>variable data; one main root folders on Linux install; stores data frequently accessed/written by services/applications systems; run <mark class="highlight-pink"><code>ls backups log opt tmp</code></mark></p><p id="110cb41b-82d2-4802-81a2-b2bbcaeb8c70" class="">/<span style="border-bottom:0.05em solid"><strong>root -</strong></span> home &quot;root&quot; system user; the logical presumption is the user would have data in a default directory like &quot;<strong>/home/root</strong>&quot; <mark class="highlight-pink"><code>ls myfile myfolder passwords.xlsx</code></mark></p><p id="8840d0be-b860-4823-9526-396592276526" class=""><span style="border-bottom:0.05em solid"><strong>/tmp - </strong></span>temporary; unique root directory on Linux; volatile and used to store data that only needs to be accessed once or twice  <mark class="highlight-pink"><code>lstodelete trash.txt rubbish.bin</code></mark></p></div></div><h3 id="72d53b5d-84df-4b88-af40-205ffba042c4" class="block-color-purple_background"><strong>Linux Fundamentals Part 3</strong></h3><p id="91afa17f-9381-46b5-845a-2ef6ceff1176" class=""><strong>Terminal Text Editors</strong><div class="indented"><p id="4bb11ef1-b904-48c4-b616-25a2b2e3fcb0" class=""><span style="border-bottom:0.05em solid">Nano</span><span style="border-bottom:0.05em solid"><strong> </strong></span><mark class="highlight-pink"><code>nano filename</code></mark> create and edit a file; Press the &quot;<strong>Ctrl</strong>&quot; key (<mark class="highlight-pink"><code>^</code></mark>)  and corresponding letter for commands</p><p id="0d2c2c35-4f31-4ba1-aee5-ad3bbbb11a75" class=""><span style="border-bottom:0.05em solid">VIM</span><span style="border-bottom:0.05em solid"><strong> - </strong></span>more advanced text editor; Syntax Highlighting for writing or maintaining code, popular for software devs </p></div></p><ul id="36a62536-2d3e-46ac-85ac-50b57f4983c8" class="toggle"><li><details open=""><summary><strong>General/Useful Utilities</strong></summary><p id="1051e44c-ed5e-48c1-bfc8-63e30e38b1c3" class="">Serving Files From Your Host - WEB:<strong> </strong>Ubuntu machines are pre-packaged with python3. Python module called &quot;HTTPServer” - turns your computer into a web server that can serve your files and then download another computing. Run <mark class="highlight-pink"><code>python3 -m  http.server</code></mark> </p><p id="b8025512-6de9-434e-a987-1c76ad922e75" class="">Downloading Files: <code><mark class="highlight-pink">wget link</mark></code> - download files from the web via HTTP</p><p id="efcb1424-a916-4adc-9a4e-e8605979e426" class="">Transferring Files From Your Host - SCP (SSH): Secure copy securely copies files with SSH protocol that provides authentication and encryption using the SOURCE and DESTINATION model to copy files &amp; directories from current system &lt;—&gt; remote system, given usernames/passwords for both users</p><div id="39611fdf-4e7d-4f49-8aa1-08a03593dcd7" class="column-list"><div id="bb0a31f9-d437-4a43-b964-b0a9f04d9d22" style="width:50%" class="column"><table id="4ba9b6c2-c218-4e2a-8a0f-c78e62ddf8d5" class="simple-table"><tbody><tr id="035c265a-60ad-4534-9dcd-3f5872e6ecce"><td id="b?L{" class="" style="width:300.9921875px"><strong><mark class="highlight-pink">Variable</mark></strong></td><td id="ZOOv" class="" style="width:129.99288940429688px"><strong><mark class="highlight-pink">Value</mark></strong></td></tr><tr id="68d10850-611a-44c0-9776-9a0416128d72"><td id="b?L{" class="" style="width:300.9921875px">IP address of the remote system</td><td id="ZOOv" class="" style="width:129.99288940429688px">192.168.1.30</td></tr><tr id="d09cbbba-4c4f-4f4f-ba3c-dbe8cf4c417a"><td id="b?L{" class="" style="width:300.9921875px">User on the remote system</td><td id="ZOOv" class="" style="width:129.99288940429688px">ubuntu</td></tr><tr id="cadf565b-11e9-4cd2-bd3d-810ad30d9fde"><td id="b?L{" class="" style="width:300.9921875px">Name of file on local system</td><td id="ZOOv" class="" style="width:129.99288940429688px">important.txt</td></tr><tr id="ea726e15-415b-45c5-9c87-e32591732442"><td id="b?L{" class="" style="width:300.9921875px">Name to store the file as on remote system</td><td id="ZOOv" class="" style="width:129.99288940429688px">transferred.txt</td></tr></tbody></table><p id="cb015883-9030-435a-a578-08826ff849a4" class=""><mark class="highlight-pink"><code>scp important.txt ubuntu@192.168.1.30:/home/ubuntu/transferred.txt</code></mark></p></div><div id="2017dfd9-86ee-455c-9c8c-e8162128f52c" style="width:50%" class="column"><table id="5bdd16ff-7996-493b-88d2-ef16a81884cf" class="simple-table"><tbody><tr id="75326400-7ff9-4070-8d8b-545b6980d6d9"><td id="&lt;y:?" class="" style="width:286px"><strong><mark class="highlight-pink">Variable</mark></strong></td><td id="FIa|" class=""><strong><mark class="highlight-pink">Value</mark></strong></td></tr><tr id="ef42e5ec-33b7-4bfe-b799-585a68a7af91"><td id="&lt;y:?" class="" style="width:286px">IP address of the remote system</td><td id="FIa|" class="">192.168.1.30</td></tr><tr id="7dd492be-ecd1-4bc0-9ab0-5141ca4f65d8"><td id="&lt;y:?" class="" style="width:286px">User on the remote system</td><td id="FIa|" class="">ubuntu</td></tr><tr id="abb70a95-bcb6-4863-be00-aa9ad0b3bddb"><td id="&lt;y:?" class="" style="width:286px">Name of the file on the remote system</td><td id="FIa|" class="">documents.txt</td></tr><tr id="1ef28390-217a-4d6e-bb3c-4abbd987a95e"><td id="&lt;y:?" class="" style="width:286px">Name  to store the file as on our system</td><td id="FIa|" class="">notes.txt</td></tr></tbody></table><p id="bc700902-f3c7-4104-9595-f4df506a0768" class=""><mark class="highlight-pink"><code>scp ubuntu@192.168.1.30:/home/ubuntu/documents.txt notes.txt</code></mark></p></div></div></details></li></ul><ul id="9698b9f2-0cf0-4ccd-a0be-40687d01eb5e" class="toggle"><li><details open=""><summary><strong>Processes 101</strong></summary><p id="0e5c8e57-e37b-466d-afee-c90ca8639a2b" class="">Processes are programs running on the machine, managed by the kernel, where each process will have an ID associated with it, known as its PID. The PID increments in the order the process starts.</p><p id="4cf4824f-07d7-4f2d-92aa-ece5f5fa61e2" class=""><span style="border-bottom:0.05em solid"><strong>Viewing Processes</strong></span></p><p id="697bd7b6-e009-4e9c-88ba-c5e1a4764220" class=""><mark class="highlight-pink"><code>ps</code></mark> provides a list of running processes on the user&#x27;s session and additional info. To see processes run by other users and those that don&#x27;t run from a session (i.e. system processes), use <mark class="highlight-pink"><code>ps aux</code></mark><mark class="highlight-pink">. </mark>The <mark class="highlight-pink"><code>top</code></mark> command gives real-time statistics about the processes running on your system instead of a one-time view and refreshes every 10 seconds or when you use the arrow keys to browse the rows.</p><p id="08042ff7-b4db-4356-8d09-1ab45551f985" class=""><span style="border-bottom:0.05em solid"><strong>Managing Processes</strong></span></p><p id="b6361435-42f0-4a09-a08a-38f795eb3543" class="">To send signals to terminate processes; a variety of types of signals correlate to how &quot;cleanly&quot; the process is dealt with by the kernel. To kill a command, use the <mark class="highlight-pink"><code>kill</code></mark> command and the PID that we wish to kill; to kill PID 1337 - <mark class="highlight-pink"><code>kill 1337</code></mark><mark class="highlight-pink">. </mark>Signals to send to a process when it is killed: SIGTERM - Kill the process, but allow it to do some cleanup tasks beforehand, SIGKILL - Kill the process, doesn&#x27;t do any cleanup after, SIGSTOP - Stop/suspend a process</p><p id="daf496dd-6ff8-428a-9620-6e4f68ab8c0b" class=""><span style="border-bottom:0.05em solid"><strong>How do Processes Start?</strong></span></p><p id="bfe3cecf-1aa0-4ae8-b890-5dc0a868800f" class="">The OS uses namespaces to divide available computer resources (CPU, RAM, priority) to processes. Processes have access to a certain amount of computing power; a small portion of what is actually available to every process overall. Namespaces are great for security when isolating processes - only those in the same namespace can see each other. The process of ID 0 is a process started when the system boots. This process is the system&#x27;s init on Ubuntu, eg. <strong>systemd</strong>, used to provide a way of managing a user&#x27;s processes and sits between the operating system and the user. eg, once a system boots and initializes, <strong>systemd </strong>is one of the first processes started. Any program or piece of software we want to start will start as a child process of <strong>systems, </strong>meaning it is controlled by <strong>systemd</strong>, but will run as its own process (although sharing resources from <strong>systemd</strong>) to make it easier to identify etc.</p><figure id="b39a9533-816c-4c0a-a6a3-825fc7f153b1" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/process1.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/process1.png"/></a></figure><p id="7f849e9b-7065-4f82-8e2e-2c6d63f8212b" class=""><span style="border-bottom:0.05em solid"><strong>Getting Processes/Services to Start on Boot</strong></span></p><p id="422389fe-72e1-4223-a5a2-f5e4a5cb6bca" class="">Some applications can be started on the boot of the system that we own. eg, web servers, database servers or file transfer servers. The software is often critical and told to start during the boot-up of the system by administrators.</p><p id="80f25674-7800-40b4-8914-59ce2e213080" class="">eg: tell apache web server to start apache manually and then tell the system to launch apache2 on boot, <mark class="highlight-pink"><code>systemctl</code></mark> - allows interaction with the <strong>systemd</strong> process/daemon, formatting: <mark class="highlight-pink"><code>systemctl [option] [service]</code></mark><mark class="highlight-pink"> eg </mark>to tell apache to start up, use <mark class="highlight-pink"><code>systemctl start apache2</code></mark>. To stop apache, replace <mark class="highlight-pink"><code>[option]</code></mark> with stop; Four options of <mark class="highlight-pink"><code>systemctl</code></mark>: Start, Stop, Enable, Disable</p><div id="050c145e-a17b-47cd-961e-603323079a77" class="column-list"><div id="7ced2917-b3ee-4ee5-a17c-77d718c4b400" style="width:106.25%" class="column"><p id="ef12089e-27d9-42ce-a6e2-0fa0227ac94e" class=""><span style="border-bottom:0.05em solid"><strong>An Introduction to Backgrounding and </strong></span><span style="border-bottom:0.05em solid"><strong>Foregrounding</strong></span><span style="border-bottom:0.05em solid"> </span><span style="border-bottom:0.05em solid"><strong>in </strong></span><span style="border-bottom:0.05em solid"><strong>Linux</strong></span></p><p id="078e2840-8c97-43e8-8436-d5a0d347bdd8" class="">Processes can run in two states: the background and the foreground. eg, commands that run in the terminal such as &quot;echo&quot; run in the foreground of your terminal as it is the only command provided that hasn&#x27;t been told to run in the background. The output of echo will return in the foreground, but not in the background. After adding the <mark class="highlight-pink"><code>&amp;</code></mark> operator, it just gives the ID of the echo process -- as it is running in the background. Same when executing things like scripts -- rather than using <code>&amp;</code>, use <mark class="highlight-pink"><code>Ctrl + Z</code></mark> to background a process. It is also an effective way of &quot;pausing&quot; the execution of a script or command.</p><p id="55c41509-070c-4309-ab80-2212da0c4866" class=""><span style="border-bottom:0.05em solid"><strong>Foregrounding a process</strong></span></p><p id="430d1655-432f-4eb3-9f46-1fb4b4203575" class="">Now we have a process in the background, our script &quot;background.sh&quot; can be confirmed by using the <mark class="highlight-pink"><code>ps aux</code></mark> command. Use <mark class="highlight-pink"><code>fg</code></mark> to bring this back to focus and return the output of the script</p><figure id="a01a7ecb-22db-4f0a-9a78-d5b0123bebd7" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg3.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg3.png"/></a></figure><figure id="c5cc3a50-214f-400a-b270-e2c75c028c69" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg4.png"><img style="width:240px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg4.png"/></a></figure></div><div id="09f7ee01-5c75-4888-80d3-5091dd64bc79" style="width:49.999999999999986%" class="column"><figure id="f01328d8-0af1-4ef2-a591-aa897960ceb6" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg1.png"><img style="width:528px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg1.png"/></a></figure><figure id="13e1caf6-fdb0-4dcf-851b-0298f2d99e66" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg2.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg2.png"/></a></figure><figure id="1e003043-7087-4014-89ef-51037755c001" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg5.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/bg5.png"/></a></figure></div></div></details></li></ul><ul id="8a3aed85-6435-430e-b3f0-9803d6788bf3" class="toggle"><li><details open=""><summary><strong>Maintaining Your System: Automation</strong></summary><div id="0427cbf8-c279-4195-b80d-6b3f9ea74b82" class="column-list"><div id="e208085f-fef0-45eb-bb2d-bc7070934e16" style="width:106.25%" class="column"><p id="2d64a8ff-aaba-4cde-9a7a-14809f6fe83b" class="">To schedule a certain action or task to take place after the system has booted. eg, running commands, backing up files, or launching programs. Crontab is one of the processes that is started during boot and is responsible for facilitating and managing cron jobs. A crontab is a special file with formatting that is recognized by the <mark class="highlight-pink"><code>cron</code></mark> process to execute each line step-by-step. Crontabs require 6 specific values:</p><div id="e20ce653-887c-4cec-89ab-449a99217bcb" class="column-list"><div id="de8f45ee-12aa-43c7-8ed2-4f19c8a04497" style="width:56.25%" class="column"><table id="9cd08695-dc3f-4901-9523-1e0a0f957920" class="simple-table"><tbody><tr id="d8acb41e-c9ba-4b33-bf28-73c6cf5d37c2"><td id="hYc&gt;" class="" style="width:67px"><mark class="highlight-pink"><strong>Value</strong></mark></td><td id="`DKM" class="" style="width:266px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="19d71d17-8e73-4d98-b0b3-5951c5dcf39c"><td id="hYc&gt;" class="" style="width:67px">MIN</td><td id="`DKM" class="" style="width:266px">What minute to execute at</td></tr><tr id="da6a882d-7a18-48e4-8b2f-d380bd3b966d"><td id="hYc&gt;" class="" style="width:67px">HOUR</td><td id="`DKM" class="" style="width:266px">What hour to execute at</td></tr><tr id="3213b82f-944c-4a75-9fc3-0e9588a879ca"><td id="hYc&gt;" class="" style="width:67px">DOM</td><td id="`DKM" class="" style="width:266px">What day of the month to execute at</td></tr><tr id="eb89ba04-f499-46af-82ed-b20eb32bc5cf"><td id="hYc&gt;" class="" style="width:67px">MON</td><td id="`DKM" class="" style="width:266px">What month of the year to execute at</td></tr><tr id="c7be6a57-584c-45db-9989-fbc24555ddb8"><td id="hYc&gt;" class="" style="width:67px">DOW</td><td id="`DKM" class="" style="width:266px">What day of the week to execute at</td></tr><tr id="e296c492-d451-4d1d-94b0-59be5e8d4c98"><td id="hYc&gt;" class="" style="width:67px">CMD</td><td id="`DKM" class="" style="width:266px">The actual command to be executed</td></tr></tbody></table></div><div id="a543b58e-8ebb-43bc-b6bb-52eb826a1940" style="width:43.75%" class="column"><p id="0bef2e1c-efa9-48ec-ae31-b8096186bed4" class="">eg, to backup &quot;cmnatic&quot;&#x27;s  &quot;Documents&quot; every 12 hours, use <mark class="highlight-pink"><code>0 *12 * * * cp -R /home/cmnatic/Documents/var/backups/</code></mark></p></div></div><p id="99d2f9cb-d666-4ca0-8fb9-7e45e6dfc075" class="">Crontabs supports the wildcard or asterisk (<mark class="highlight-pink"><code>*</code></mark>). If we do not wish to provide a value for that specific field, i.e. we don&#x27;t care what month, day, or year it is executed -- only that it is executed every 12 hours, just place an asterisk. Crontabs can be edited using <mark class="highlight-pink"><code>crontab -e</code></mark>, which selects an editor (such as Nano) to edit your crontab.</p></div><div id="1d0c43c8-4c03-44be-aea9-495ffb01b93a" style="width:43.750000000000014%" class="column"><figure id="b363328e-004d-46a4-a289-db448d39a5f2" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron1.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron1.png"/></a></figure><figure id="3eef63eb-7823-41ec-9813-898ff4a5496e" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron3.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron3.png"/></a></figure><figure id="3354b2c5-c4aa-45ba-82e5-af0c7487450a" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron2.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/cron2.png"/></a></figure></div></div></details></li></ul><ul id="397625a1-0bc8-4370-9b6b-e89c0a2ff0c6" class="toggle"><li><details open=""><summary><strong>Maintaining Your System: Package Management</strong></summary><p id="b4f21c15-19a7-46c2-936b-a0ce33c4a793" class=""><span style="border-bottom:0.05em solid"><strong>Introducing Packages &amp; Software Repos</strong></span></p><div id="209f6853-4e9a-41bc-a5ef-df22b54486bb" class="column-list"><div id="bc09bf69-a29a-42b5-b9f5-212a38393813" style="width:112.5%" class="column"><p id="e6193efa-96c5-4af6-98ea-fb28d5c25379" class="">For developers to submit software to the community, they submit it to an  &quot;apt&quot; repository. If approved, their programs and tools will be released. Two of the most redeeming features of Linux here: User accessibility and the merit of open source tools. When using the <mark class="highlight-pink"><code>ls</code></mark> command on a Ubuntu 20.04 Linux machine, these files serve as the gateway/registry. OS vendors maintain their own repositories and add community repositories to your list, allowing you to extend the capabilities of your OS. </p></div><div id="c21a8e17-4e8f-46af-b535-291638bb07d7" style="width:62.499999999999986%" class="column"><figure id="bd19d0ed-a0d7-4b40-82e8-13cf196f51ae" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt1.png"><img style="width:672px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt1.png"/></a></figure><figure id="c206323a-a05f-49ec-8a75-488ce825c9a4" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt2.png"><img style="width:672px" src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/apt2.png"/></a></figure></div></div><p id="354abb7e-48e9-4a47-911c-8f39c9b1d4fc" class=""><span style="border-bottom:0.05em solid"><strong>Managing Your Repositories (Adding and Removing)</strong></span></p><p id="505914c3-090e-4e2e-b515-5a7ad0d121b7" class="">The <mark class="highlight-pink"><code>apt</code></mark> command is part of the package management software also named apt which contains a suite of tools to manage, install, or remove packages and sources of our software. Additional repositories can be added using <mark class="highlight-pink"><code>add-apt-repository</code></mark> command or by listing another provider, eg. , some vendors have a repository closer to their geographical location so you can install software through package installers such as <code><mark class="highlight-pink">dpkg</mark></code>. The benefit of apt is that whenever you update the system, the repository containing the software added also gets checked for updates. When adding software, the integrity is guaranteed by the use of GPG (Gnu Privacy Guard) keys, which are essentially a safety check from the developers. If the keys do not match what your system trusts and the developers used, then the software will not be downloaded.</p><p id="5e1dbecf-a3c4-4861-9f6f-8e19f244a811" class="">Add the text editor Sublime Text to our Ubuntu machine as a repository: add the GPG key for the developers of Sublime Text 3. <mark class="highlight-pink"><code>wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</code></mark><mark class="highlight-pink"> </mark>Add Sublime Text 3&#x27;s repository to our apt sources list. A good practice is to have a separate file for every different community/3rd party repository that we add: create a file named <strong>sublime-text.list </strong>in <strong>/etc/apt/sources.list.d</strong> and enter the repository information: Use a text editor to add &amp; save the Sublime Text 3 repository into this newly created file: /etc/apt/sources.lit.d# touch sublime-text.list &gt;&gt;&gt;&gt;&gt; deb <a href="https://download.sublimetext.com"><mark class="highlight-pink"><code>https://download.sublimetext.com</code></mark></a><code><mark class="highlight-pink">/ apt/stable/</mark></code><mark class="highlight-pink"> </mark>Update apt to recognize the new entry using the <mark class="highlight-pink"><code>apt update</code></mark> command. Install the software using <mark class="highlight-pink"><code>apt install sublime-text</code></mark>Removing packages - <mark class="highlight-pink"><code>add-apt-repository --remove ppa:PPA_Name/ppa</code></mark> or manually delete the file then <mark class="highlight-pink"><code>apt remove [software-name-here]</code></mark> i.e. <mark class="highlight-pink"><code>apt remove sublime-text</code></mark></p></details></li></ul><ul id="28cacb0c-ee49-49b6-a81c-c9746e3ff3ee" class="toggle"><li><details open=""><summary><strong>Maintaining Your System: Logs</strong></summary><div id="c2ef3a9f-5f77-4b18-84cf-a78880a01d39" class="column-list"><div id="0b78e1e1-d182-4539-bbd7-682c4211fe84" style="width:106.25%" class="column"><p id="e55d8ab1-2483-4cb0-a581-83bff84ac459" class="">Located in the /var/log directory, these files and folders contain logging information for applications and services running on your system. The OS automatically manages logs in a process known as &quot;rotating&quot;. Logs from three services running on a Ubuntu machine: Apache2 web server, Logs for the fail2ban service used to monitor attempted brute forces, eg. the UFW service used as a firewall</p><p id="387e3b91-8337-409b-82eb-48f4eb011343" class="">Services and logs are a great way to monitor and protect your system health. Service logs like a web server contain information about every single request - allowing developers or administrators to diagnose performance issues or investigate an intruder&#x27;s activity. Two types of log files of interest: access log, and error log. There are also logs that store information about how the OS runs itself and actions performed by users like authentication attempts.</p></div><div id="becd1f03-f407-404c-892c-ad59e8fdae99" style="width:43.75%" class="column"><figure id="f0cfe799-e8bc-406c-8ce6-064351f89226" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log1.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log1.png"/></a></figure><figure id="3673dae8-8d8b-4b2a-a2b2-b96d9258f0f5" class="image"><a href="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log2.png"><img src="https://assets.tryhackme.com/additional/linux-fundamentals/part3/log2.png"/></a></figure></div></div></details></li></ul><h3 id="01f3f738-69cc-4fc8-ae2b-1647c476c51b" class="block-color-purple_background"><strong>Linux Modules</strong></h3><ul id="a27df1a4-9eda-4a88-a2d2-c749ddd307c1" class="toggle"><li><details open=""><summary><strong>du (disk usage)</strong></summary><p id="e962d1fb-551e-45f6-8f54-02752f1f742a" class=""><mark class="highlight-pink"><code>du</code></mark> - a linux command that helps identify what files/directories are consuming how much space; du can alternate <code><mark class="highlight-pink">ls</mark></code><mark class="highlight-pink">, i</mark>t won&#x27;t specify user ownership, so use <mark class="highlight-pink"><code>stat</code></mark>command on the file you want to know who is the owner of that particular file</p><table id="c630e537-be30-4cfa-b4f9-8e727dabb5ef" class="simple-table"><tbody><tr id="96c6b09b-8d23-49f3-b3fb-b25f0677829d"><td id="h[|A" class="block-color-default" style="width:74px"><mark class="highlight-pink"><strong>Flag</strong></mark></td><td id="T?[^" class="block-color-default" style="width:744px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="87265d4e-94e8-4d31-bcc2-c3193fb7adce"><td id="h[|A" class="block-color-default" style="width:74px">-a</td><td id="T?[^" class="block-color-default" style="width:744px">Lists files with the folder <mark class="highlight-pink"><code>du -a /home/ | grep user</code></mark> lists any file/directory with name containing string &quot;<em>user</em>&quot; </td></tr><tr id="eeddad74-07f1-4978-90ec-97c8e44c2eed"><td id="h[|A" class="block-color-default" style="width:74px">-h</td><td id="T?[^" class="block-color-default" style="width:744px">Lists the file sizes in human-readable format (B, MB, KB, GB)</td></tr><tr id="7e20c0ba-1836-448c-a1db-c5062404cd58"><td id="h[|A" class="block-color-default" style="width:74px">-c</td><td id="T?[^" class="block-color-default" style="width:744px">Prints the total size at the end</td></tr><tr id="ee85c5e6-70c2-40aa-af37-e89f2f18d13f"><td id="h[|A" class="block-color-default" style="width:74px">-d &lt;#&gt;</td><td id="T?[^" class="block-color-default" style="width:744px">Specifies the depth-ness of a dir <mark class="highlight-pink"><code>du --time -d 1 .</code></mark><mark class="highlight-pink"> </mark></td></tr><tr id="906ca65d-b9eb-4161-b8a2-5bbe87748396"><td id="h[|A" class="block-color-default" style="width:74px">--time</td><td id="T?[^" class="block-color-default" style="width:744px">Returns the results with the time stamp of the last modified</td></tr></tbody></table></details></li></ul><ul id="deaec814-5695-41ef-917f-d0ea7a16a142" class="toggle"><li><details open=""><summary><strong>Grep, Egrep, Fgrep</strong></summary><p id="9bb24525-79ec-47ab-9e92-21eba62f253c" class=""><mark class="highlight-pink"><code>grep</code></mark> - filters output we need; searches a file for a particular pattern of chars; The pattern is searched in regular expression. </p><p id="f87a06fd-ba82-46c5-93e3-3e577f8fb487" class=""><span style="border-bottom:0.05em solid"><strong>The Family Tree</strong></span></p><p id="f4139d86-7c7b-41b7-b89c-9571cb6cb64b" class="">egrep and fgrep are no different from grep (other than 2 flags that can be used with grep to function as both); egrep matches the regular expressions in a string; fgrep searches for a fixed string inside text; grep can do both their jobs by using -E and -F flag, respectively; <mark class="highlight-pink"><code>grep -E</code></mark> functions same as <mark class="highlight-pink"><code>egrep</code></mark> ; <mark class="highlight-pink"><code>grep -F</code></mark> functions same as <mark class="highlight-pink"><code>fgrep</code></mark>.</p><table id="e1b27ad4-a067-4563-9578-a40ad55b11cb" class="simple-table"><tbody><tr id="c997f1ac-379c-4ccb-805d-096cd6a78166"><td id="IB:a" class="block-color-pink" style="width:58px"><strong>Flags</strong></td><td id="}?v`" class="block-color-pink" style="width:670px"><strong>Description</strong></td></tr><tr id="c360f212-da60-4abd-8323-36ebbf1c2700"><td id="IB:a" class="" style="width:58px">-R</td><td id="}?v`" class="" style="width:670px">Does a recursive grep search for the files inside the folders</td></tr><tr id="1711561a-05e5-4516-b04d-e216dbd15af7"><td id="IB:a" class="" style="width:58px">-h</td><td id="}?v`" class="" style="width:670px">If you&#x27;re grepping recursively in a directory, this flag disables the prefixing of filenames in the results</td></tr><tr id="3ccf5988-ce9a-448f-9d46-a8314f597883"><td id="IB:a" class="" style="width:58px">-c</td><td id="}?v`" class="" style="width:670px">Only lists an integer value of how many times the pattern was found in the file/folder //count</td></tr><tr id="882c32d7-7f26-4837-b085-a40862f6a096"><td id="IB:a" class="" style="width:58px">-i</td><td id="}?v`" class="" style="width:670px">Specifies grep to search for the PATTERN while IGNORING the case //prefer</td></tr><tr id="26a6e636-b1eb-4a8b-8162-32eb59a1c65e"><td id="IB:a" class="" style="width:58px">-l</td><td id="}?v`" class="" style="width:670px">Only lists the filename instead of the pattern found in it</td></tr><tr id="c2b235d1-d5a2-4a30-bf7c-35ebbeb5aa29"><td id="IB:a" class="" style="width:58px">-n</td><td id="}?v`" class="" style="width:670px">Lists the lines with their line number in the file containing the pattern</td></tr><tr id="3e9fc548-929b-4d5b-b9d6-df78a45b699e"><td id="IB:a" class="" style="width:58px">-v</td><td id="}?v`" class="" style="width:670px">Prints all the lines that are NOT containing the pattern</td></tr><tr id="3b63d2fa-ebe4-47be-9fdd-34bc0617106d"><td id="IB:a" class="" style="width:58px">-E</td><td id="}?v`" class="" style="width:670px"><mark class="highlight-pink"><code>egrep</code></mark><mark class="highlight-pink"> </mark>Considers the PATTERN as a regular expression to find the matching strings; can specify one single pattern; works on EREs (Extended Regular Expressions); EREs tend to mathc 2+ patterns in a file</td></tr><tr id="66e82068-1ca2-438b-a1e9-ad84cdcde14d"><td id="IB:a" class="" style="width:58px">-e</td><td id="}?v`" class="" style="width:670px">Can be used to specify multiple patterns and lists any string that matches the pattern(s); works on the BREs (Basic Regular Expressions); BREs tend to match a single pattern in a file</td></tr></tbody></table></details></li></ul><ul id="6b617983-5339-4e36-9c1a-5671a2f22d13" class="toggle"><li><details open=""><summary><span style="border-bottom:0.05em solid"><strong>String Manipulations (STRing OPerationS)</strong></span></summary><p id="e8e69f58-9fdf-4d8d-8de6-83e8c180713a" class="">Indexing in arrays, slicing in python, and grepping in terminal are a means of string manipulations. The following tools should be kept for STROPS: tr, ark, sed, xargs, sort, uniq</p><ul id="d08f5c6d-4a81-4aad-8a4e-3d6c512d2f45" class="toggle"><li><details open=""><summary><strong>tr (Translate command)</strong></summary><p id="1fed40a3-dd4f-4bfc-abfd-dab8f22fd02c" class=""><code><mark class="highlight-pink">tr</mark></code><mark class="highlight-pink"> </mark>can help you from changing character cases in a string to replacing characters in a string; Desktop app: emojis use :keyword: so tr can select set with same output <code><mark class="highlight-pink">cat file.txt | tr -s &#x27;[:lower:]&#x27; &#x27;[:upper:]&#x27; </mark></code></p><table id="ee879f85-1c25-4407-b2f6-9fe97ba66f51" class="simple-table"><tbody><tr id="0a01a19e-d87a-4b2a-b506-b032ca6b4b24"><td id="E_~r" class="" style="width:60px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="zbu;" class="" style="width:823px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="48feb4ad-5ea9-4246-8a6e-1b9af8280387"><td id="E_~r" class="" style="width:60px">-d</td><td id="zbu;" class="" style="width:823px">Deletes a given set of characters <code><mark class="highlight-pink">cat file.txt | tr -d &#x27;[a-zA-Z: ]&#x27;</mark></code><mark class="highlight-pink"> </mark>View user creds which are in digits</td></tr><tr id="c0d3e711-4a8a-4dfa-9ebf-6d6a562d2a9d"><td id="E_~r" class="" style="width:60px">-t</td><td id="zbu;" class="" style="width:823px">Concats source set with destination set (destination set comes first; t stands for truncate)</td></tr><tr id="0e0c03e6-2ea5-44d4-864a-fa36514c385f"><td id="E_~r" class="" style="width:60px">-s</td><td id="zbu;" class="" style="width:823px">Replaces source with destination set (squeeze) <code><mark class="highlight-pink">cat file.txt | tr -s &#x27;[a-z]&#x27; &#x27;[A-Z]&#x27;</mark></code><mark class="highlight-pink"> </mark>Convert every letter to upper case</td></tr><tr id="a3793448-899a-47c9-84d0-51bcbfaf9887"><td id="E_~r" class="" style="width:60px">-c</td><td id="zbu;" class="" style="width:823px">REVERSE card; eg. specify -c with -d to delete  the rest of the characters leaving the source set we specified; - complement</td></tr></tbody></table></details></li></ul><ul id="cef16da4-76ef-4d85-80b7-0a5cfa624518" class="toggle"><li><details open=""><summary><strong>awk</strong></summary><p id="7ca6faab-8f74-4c93-8587-73629635c9c3" class=""><em>&quot;Awk is a scripting language used for manipulating data and generating reports. The awk command programming language requires no compiling, and allows the user to use variables, numeric functions, string functions, and logical operators.&quot; </em><strong>Fun fact:</strong> AWK is abbreviated after its creators (Aho, Weinberger, and Kernighan). Syntax: <mark class="highlight-pink"><code>awk [flags] [select pattern/find(sort)/commands] [input file]</code></mark></p><p id="501f5e10-48fa-48a6-a556-cfcaa0f74731" class="">Note: awk does support getting output via piping; you can execute the script commands by using the <mark class="highlight-pink"><code>f</code></mark> flag and specifying the name of the script file; (<mark class="highlight-pink"><code>awk -f script.awk input.txt</code></mark>)</p><p id="bb335e86-f5d9-47d1-9e48-7583ad9ce480" class=""><span style="border-bottom:0.05em solid"><strong>Using AWK - </strong></span>To search for pattern inside file, enclose pattern in forward slashes <mark class="highlight-pink"><code>/pattern/</code></mark>. eg. to know who all plays CTF competitions: <mark class="highlight-pink"><code>awk &#x27;/ctf/&#x27; file.txt</code></mark></p><div id="dc88fd43-6749-4098-a04c-f76beadafb39" class="column-list"><div id="6fdbfec1-6017-42bf-8dba-54c7cd1ba406" style="width:112.5%" class="column"><p id="4070f32c-0759-4571-9bd4-6042a1e8e42e" class=""><span style="border-bottom:0.05em solid"><strong>Built-In variables in AWK</strong></span></p><p id="6ab61d68-1a60-4f43-82d7-8bfc3736149b" class="">Built-in variables include field variables ($1, $2, $3 .. $n). These field variables are used to specify a piece of data (data separated by a delimiter defaulting to space). <mark class="highlight-pink"><code>awk &#x27;{print $1 $3}&#x27; file.txt</code></mark> will list words at 1st and 3rd fields.</p><p id="79212963-b20d-4938-87bb-c374af8fce5d" class="">Let&#x27;s just use a &quot;,&quot; (comma) to bring the space. Note: You may notice the use of {} around the print statement, that&#x27;s where we used a function. To use commands in awk scripts, you need to mention them inside a function.</p></div><div id="b1b00c66-45fb-4a53-9fdf-68bfa0066ffb" style="width:68.74999999999999%" class="column"><figure id="19588ea9-3869-4a8f-a2a3-0d0a899de7cf" class="image"><a href="https://i.imgur.com/v08VQpx.png"><img style="width:624px" src="https://i.imgur.com/v08VQpx.png"/></a></figure><figure id="dc222e8f-7cfd-4229-9890-969bdd855798" class="image"><a href="https://i.imgur.com/j9ap6zd.png"><img style="width:528px" src="https://i.imgur.com/j9ap6zd.png"/></a></figure></div></div><p id="aff6fd85-58e8-42d8-bcf2-088f90b83f11" class="">Note: The $0 variable points to the whole line.  S<em>ingle quotes(&#x27;&#x27;) to specify patterns, awk treats double quotes(&quot;&quot;) as a raw string. To use double quotes make sure that you escape the ($) sign(s) with a backslash (\) each, to make it work properly.</em></p><div id="82665a72-52c2-4e97-935b-c04ca17224ae" class="column-list"><div id="08ac8097-24a4-4213-9a5a-4f65afd93a50" style="width:106.25%" class="column"><p id="99ac8328-bf5a-49e5-9906-8989374dd8bf" class=""><span style="border-bottom:0.05em solid"><strong>More on variables</strong></span></p><p id="70d4db35-b66b-4f8c-b950-05b73ceb0002" class=""><strong>NR </strong>(Number Record): the variable that keeps count of the rows after each line&#x27;s execution. You can use NR command to number the lines (<mark class="highlight-pink"><code>awk &#x27;{print NR,$0}&#x27; file.txt</code></mark>). Note that awk considers rows as records.</p><p id="ad506541-3111-46b1-b56b-1c3be7fa64cb" class=""><strong>FS (</strong>Field Separator): the variable to set in case you want to define the field for input stream. The field separation (default to space) can be altered to whatever you want while specifying the pattern. FS can be defined to another character(s) at the BEGIN{command}.</p><p id="38ad2807-155c-43c6-8c62-d0fbcfff4f74" class=""><strong>BEGIN</strong> is a pattern that we specify and the following is the action on that pattern to be performed at the start</p><p id="a63d48f3-6e0f-43ef-b6d1-c3f12c81851d" class=""><strong>END</strong> is also a pattern that we specify following the action to perform on that pattern used to define<em> actions </em>like Field Separator, Record Separator, etc. that are to be performed at the end of the script, respectively.</p><p id="385f9392-a2c5-4e6c-a682-f4c8e9f61677" class=""><strong>RS </strong>(Record Separator): By default it separate rows with &#x27;\n&#x27;, you can specify something else too. Notice that there has been a new line created wherever &#x27;o&#x27; was used. It also interpreted &#x27;\n&#x27; used in the text file, so there are new lines after end of every number too.</p><p id="ec299a0f-cbcb-406d-9854-c2e2398aa06b" class=""><strong>OFS: </strong>(Output Field Separator): specifies a delimeter while outputing</p><p id="73aea4c4-a456-4b6f-b7a6-89ac7cc86034" class="">I used OFS in both commands, you can see that only in 2nd one the delimiter was used. Note that the output field separator will separate fields using (:) only when the fields are defined with the print statement. With $0 I didn&#x27;t had anything else, if it were to be $0,$0 then the lines would be joining their reflection(non-laterally) with a colon(:).</p><figure id="431fbb48-9437-4410-99a0-3ee3f38413e7" class="image"><a href="https://i.imgur.com/q3Aglyq.png"><img style="width:432px" src="https://i.imgur.com/q3Aglyq.png"/></a></figure><p id="c43ea7a4-86f1-4d80-b389-2fde9553cc11" class=""><strong>ORS:</strong> (Output Record Separator) ; My delimiter was a double new-line character.</p><table id="a4fff576-6d5f-459e-a402-c72f14cb4276" class="simple-table"><tbody><tr id="71289b87-7add-408f-8101-529259046937"><td id="kR?o" class="" style="width:58px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="eSfp" class="" style="width:363px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="310a5afd-2369-4223-8ceb-82662e3ed66e"><td id="kR?o" class="" style="width:58px">-F</td><td id="eSfp" class="" style="width:363px">Specify FIELD SEPARATOR instead of using BEGIN</td></tr><tr id="c4ed4adc-5162-4a07-851a-7125dfe269e5"><td id="kR?o" class="" style="width:58px">-v</td><td id="eSfp" class="" style="width:363px">Specify variables (like in BEGIN{OFS=&quot;:&quot;}</td></tr><tr id="b28e3e28-0120-4ebc-82ea-778aac7e2237"><td id="kR?o" class="" style="width:58px">-D</td><td id="eSfp" class="" style="width:363px">Debug your .awk scripts specifying this flag</td></tr><tr id="8c7933ef-198c-4269-878b-6f9be8a5f890"><td id="kR?o" class="" style="width:58px">-o</td><td id="eSfp" class="" style="width:363px">Specify output file; no name&gt;defaults to awkprof.out</td></tr></tbody></table><p id="3df7a3eb-e4ec-4c2a-b990-8f77dd4bbc54" class="">
</p></div><div id="49c6700c-38d9-4957-93c8-d434e99ea9f4" style="width:68.75000000000001%" class="column"><figure id="425467f6-36c3-49b5-99c9-232c96d0af9d" class="image" style="text-align:right"><a href="https://i.imgur.com/5OhnYAB.png"><img style="width:528px" src="https://i.imgur.com/5OhnYAB.png"/></a></figure><figure id="b45be54d-c9ce-4420-9a1b-bf0b1ca3c4cc" class="image"><a href="https://i.imgur.com/uw9hWVM.png"><img style="width:528px" src="https://i.imgur.com/uw9hWVM.png"/></a></figure><figure id="6056546d-ca84-499c-899f-9e8692c0a70b" class="image"><a href="https://i.imgur.com/npmICXD.png"><img style="width:816px" src="https://i.imgur.com/npmICXD.png"/></a></figure><p id="793c19ce-43ba-46dc-873a-2670aa7a513b" class=""><mark class="highlight-pink"><code>awk &quot;BEGIN {FS=&#x27;o&#x27;} {print $1,$3} END{print &#x27;Total Rows=&#x27;,NR}&quot;</code></mark></p><figure id="2dbc4908-90da-42b4-8ab6-6cf4f8fe39f6" class="image" style="text-align:right"><a href="https://i.imgur.com/dsn9utX.png"><img style="width:480px" src="https://i.imgur.com/dsn9utX.png"/></a></figure><figure id="62039ec0-ae59-4d0d-8d2d-58aeb9b235c0" class="image"><a href="https://i.imgur.com/hwIjE8p.png"><img style="width:432px" src="https://i.imgur.com/hwIjE8p.png"/></a></figure><figure id="1ad6274e-0686-4965-8fb5-afd3dc1ec4f1" class="image"><a href="https://i.imgur.com/5j2f5zy.png"><img src="https://i.imgur.com/5j2f5zy.png"/></a></figure></div></div></details></li></ul><ul id="025b349a-9739-4c44-91d8-e909914ce242" class="toggle"><li><details open=""><summary><strong>sed (Stream EDitor)</strong></summary><p id="ea9b34bc-29c2-4da0-928b-0df7668e4778" class="">sed - a tool to perform a number of string operations: FIND AND REPLACE, searching, insertion, deletion; easily perform operations with sed command by piping input or redirecting (&lt;) input from a file. Syntax: <mark class="highlight-pink"><code>sed [flags] [pattern/script] [input file]</code></mark></p><table id="d70c5580-7858-42cf-a005-d6ef3e83d34a" class="simple-table"><tbody><tr id="c4b8367e-e677-446d-bb29-a683fa825d40"><td id="]^w}" class="block-color-pink"><strong>Flags</strong></td><td id=":NVl" class="block-color-pink" style="width:694px"><strong>Description</strong></td></tr><tr id="3c3205e7-f680-4dd8-893a-2d89a78d8173"><td id="]^w}" class="">-e</td><td id=":NVl" class="" style="width:694px">Add a script/command that needs to be executed with the pattern/script (on searching for pattern)</td></tr><tr id="6bae23dc-f0b6-421c-a4b2-2d3cc473c9c9"><td id="]^w}" class="">-f</td><td id=":NVl" class="" style="width:694px">Specify the file containing the string pattern</td></tr><tr id="18862d60-3eb6-4553-ac60-52fc79c9ba95"><td id="]^w}" class="">-E</td><td id=":NVl" class="" style="width:694px">Use extended regular expressions</td></tr><tr id="4c4dfc41-57bc-403c-8d22-fe378eaaa74e"><td id="]^w}" class="">-n</td><td id=":NVl" class="" style="width:694px">Suppress the automatic printing or pattern spacing</td></tr></tbody></table><p id="8f0ad806-e546-4380-954e-7925bfbb001c" class=""><span style="border-bottom:0.05em solid"><strong>The sed command</strong></span></p><p id="2ec13c2c-ae31-47e8-b805-82d5c2ccd43d" class="">&#x27;[condition(s)(optional)] [command/mode(optional)]/[source/to-be-searched pattern(mandatory)]/[to-be-replaced pattern(depends on command/mode you use)]/[args/flags to operate on the pattern searched(optional)]&#x27;</p><table id="3dc2f006-9053-44ca-a997-4eb2838fd299" class="simple-table"><tbody><tr id="b00a2760-e0c1-4b88-8f71-ad87206b0972"><td id="YgDo" class="" style="width:96px"><strong><mark class="highlight-pink">Commands</mark></strong></td><td id="xjO;" class="" style="width:658px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="cf8adb71-204d-4f42-8fa4-c6de5cf0a91e"><td id="YgDo" class="" style="width:96px">s</td><td id="xjO;" class="" style="width:658px">(Most used)Substitute mode (find and replace mode)</td></tr><tr id="71e377e9-f491-417d-b530-b0c46e247c2a"><td id="YgDo" class="" style="width:96px">y</td><td id="xjO;" class="" style="width:658px">Works same as s; except it works on individual bytes in string; takes no arguments/conditions</td></tr></tbody></table><p id="4d4eb1be-6e02-494b-8c3b-6eadfc534048" class=""><strong>[Update] ﻿I used the word &quot;mode&quot; in the rest of the task just to avoid the confusion of using a command(s/y) within the command(sed). But just to be clear, official documentation list them as commands used in sed.</strong></p><p id="fd2a9ee2-b33c-4d35-b338-fd214247be24" class=""><span style="border-bottom:0.05em solid"><strong>Args</strong></span></p><table id="167da6ac-b0ef-4874-b1f8-147ab934514d" class="simple-table"><tbody><tr id="5ac65fab-7527-4b8d-a64a-d1beb235acf2"><td id="wi}r" class=""><strong><mark class="highlight-pink">Flags/Args</mark></strong></td><td id="LB|t" class="" style="width:771px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="ff512216-d8cb-4e13-8452-2a867baefd3f"><td id="wi}r" class="">/g</td><td id="LB|t" class="" style="width:771px">globally(any pattern change will be affected globally, i.e. throughout the text; generally works with s mode)</td></tr><tr id="e8408620-ddb4-4443-bfdd-82b8d82a74ff"><td id="wi}r" class="">/i</td><td id="LB|t" class="" style="width:771px">Make the pattern search case-insensitive (can be combined with other flags)</td></tr><tr id="edd76f06-80a1-4c25-9132-921d7ccac3fe"><td id="wi}r" class="">/d</td><td id="LB|t" class="" style="width:771px">Delete the pattern found (Deletes the whole line; takes no parameter like conditions/modes/to-be-replaced string)</td></tr><tr id="1ea00763-462f-49f5-a419-b5c2a75bed1d"><td id="wi}r" class="">/p</td><td id="LB|t" class="" style="width:771px">Prints the matching pattern (a duplicate will occur in output if not suppressed with -n flag.)</td></tr><tr id="d40c16dd-2db9-482b-b1ab-6e0561a5dd17"><td id="wi}r" class="">/1,/2,/3../n</td><td id="LB|t" class="" style="width:771px">Perform an operation on an nth occurrence in a line (works with s mode)</td></tr></tbody></table><p id="edf4006e-24b7-4890-96ce-190afd72361c" class=""><span style="border-bottom:0.05em solid"><strong>Explanation</strong></span></p><p id="2675eb07-91a8-473f-a597-bef3ae4c9619" class="">sed &#x27;s/\(<mark class="highlight-red">^\b</mark><mark class="highlight-pink">[[:alpha:] ]*\</mark><mark class="highlight-yellow">)\</mark><mark class="highlight-pink">([[:digit:]]</mark><mark class="highlight-yellow">*\)</mark>/\=\&gt; \1\[\2\]/g&#x27; file.txt</p><ul id="5595c6ff-f040-48ec-a0a4-1d61e1a7ad39" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-red">Opening a group with escape character, ^ to put the cursor at the starting of the line, and then \b represents to search for beginning of a word, </mark><mark class="highlight-pink">and then defines a set of characters to include, following a &quot;*&quot; to specify &#x27;n&#x27; number of characters.</mark> <mark class="highlight-yellow">Then closes the group by escaping the closing brackets. Creating another regex group, using escape sequence, we then initialized another set </mark><mark class="highlight-pink">and specified * at the end of the set to take n characters of that set,</mark> <mark class="highlight-yellow">at last group is closed using escape sequence.</mark></li></ul><ul id="6942002d-706c-4a10-8ad2-fec12c529369" class="bulleted-list"><li style="list-style-type:disc">At the replaced end, we are using escape sequences to make a bullet(it&#x27;s just a good practice to use escape sequence with every symbolic character; even if the output is same), then we have escape characters for the square brackets enclosing a sed variable /2 (after /1 which is coming up).</li></ul><ul id="bb6611f7-3360-4a9b-bb94-f706adc04cc4" class="bulleted-list"><li style="list-style-type:disc">Now its turn for the sed&#x27;s keyword part. We used [:alpha:] in the set defined by regex, which is nothing but another representation of using <mark class="highlight-pink"><code>a-zA-Z</code></mark> in regex, which means to capture any alphabetic characters. sed offers such keywords(calling them &quot;bracket expressions&quot;), which we can use to make the input code look cleaner. Similarly we used the bracket expression for specifying digit as well which we specified using [:digit:].</li></ul><p id="d0cc967f-617c-40de-a39d-a6ead61c0467" class="">Note: There&#x27;s a space after the first bracket expression inside the regex set ([[:alpha:]{space}]). As you see, this space was to indicate the regex set <em>so that * could take multiple words until the digits start occurring in the text(regex logic)</em>.</p><ul id="194e29be-a64b-4109-bf93-d7cf69bf6c7a" class="bulleted-list"><li style="list-style-type:disc">Then there are some in-built variables as we saw in <del>awp</del> awk, that we used in the to-be-replace part of sed. \1 depicted the first group which selected everything until the first character occurred. The second group comprised of a set consisting decimal characters, which were enclosed with [\2] with the use of escseq.</li></ul></details></li></ul><ul id="8080678c-82bd-4b56-a950-686d71ec0026" class="toggle"><li><details open=""><summary><strong>xargs</strong></summary><p id="7d7cc541-d75b-44a5-8228-4e6709e4fe4a" class="">xargs makes passed string a command&#x27;s argument, technically, positional argument; a command line tool used to build and execute command from the standard input</p><table id="2f038ec8-67ed-4d3e-a01f-a3c9b68654f3" class="simple-table"><tbody><tr id="cebacbfc-6c54-4bfa-895c-a0f3e2fff60a"><td id="MMAG" class="block-color-pink" style="width:94px"><strong><mark class="highlight-gray_background">Flags</mark></strong></td><td id="JJhB" class="block-color-pink" style="width:816px"><strong><mark class="highlight-gray_background">Description</mark></strong></td></tr><tr id="79dfca63-b62a-4664-b49d-0c04c4d62b55"><td id="MMAG" class="" style="width:94px">-0</td><td id="JJhB" class="" style="width:816px">Terminate the arguments with null character (helps to handle spaces in the argument)</td></tr><tr id="8fdf1b01-b0df-4461-a3e4-5fe45c3132e6"><td id="MMAG" class="" style="width:94px">-a file</td><td id="JJhB" class="" style="width:816px">Allows xargs to read item from a file</td></tr><tr id="1a38a175-a7ae-46d5-a681-5e0778d4e1f9"><td id="MMAG" class="" style="width:94px">-d delimiter</td><td id="JJhB" class="" style="width:816px">Specifies the delimiter to be used when differentiating arguments in stdin</td></tr><tr id="8be14b41-4623-46fc-88d1-3e2317c16c00"><td id="MMAG" class="" style="width:94px">-L int</td><td id="JJhB" class="" style="width:816px">Specifies the max number of non-blank inputs per command line</td></tr><tr id="3e78f6d7-dd50-4e7d-a611-f59298a04843"><td id="MMAG" class="" style="width:94px">-s int</td><td id="JJhB" class="" style="width:816px">Buffer size you allocate, sets max-chars for command, includes initial args and terminating nulls Default: 128kB </td></tr><tr id="043616e3-6418-40b5-8743-be7d8a270048"><td id="MMAG" class="" style="width:94px">-x</td><td id="JJhB" class="" style="width:816px">Exits the command execution if the size specified is exceeded (For security purposes)</td></tr><tr id="00b1ea55-980b-4ad4-8988-14a81d83639b"><td id="MMAG" class="" style="width:94px">-E str</td><td id="JJhB" class="" style="width:816px">Specifies the end-of-file string (in case you are reading arguments from a file)</td></tr><tr id="fa20b975-633c-4f67-b266-7f2f3d7b01bf"><td id="MMAG" class="" style="width:94px">-I str</td><td id="JJhB" class="" style="width:816px">(Capital i) Replaces str occurrence in arguments with the one passed via stdin (like creating a variable to use later)</td></tr><tr id="7c6d061f-78d7-454c-9df8-f9b1414904f4"><td id="MMAG" class="" style="width:94px">-p</td><td id="JJhB" class="" style="width:816px">Prompt the user before running any command as a token of confirmation</td></tr><tr id="c494cbf8-5690-4558-b30c-19e3dabe5c1e"><td id="MMAG" class="" style="width:94px">-r</td><td id="JJhB" class="" style="width:816px">If the standard input is blank (i.e. no arguments passed) then it won&#x27;t run the command</td></tr><tr id="fceb8f85-7e78-4290-ad0e-65d0fbcea9b1"><td id="MMAG" class="" style="width:94px">-n int</td><td id="JJhB" class="" style="width:816px">Sets max args from command input, after max args limit is reached, loops rest args into new command line with same flags</td></tr><tr id="b8dc509e-6749-4bce-bfed-b5a677cb66ad"><td id="MMAG" class="" style="width:94px">-t</td><td id="JJhB" class="" style="width:816px">verbose; (Print the command before running it), Note: This won&#x27;t ask for a prompt</td></tr></tbody></table><div id="b331f35c-213d-4d1d-9ea7-9fb1dc9c3dc8" class="column-list"><div id="0c3ec275-9a1e-4a70-bdd0-627942ea03c7" style="width:25%" class="column"><ul id="7353b459-cc3a-4674-953d-96bc77364af7" class="bulleted-list"><li style="list-style-type:disc">To run multiple commands with xargs in one line?</li></ul></div><div id="4dfa4964-b598-49af-b46d-71afc60607d6" style="width:100%" class="column"><figure id="dbb8b7aa-da05-44d1-b408-5eb5d948f071" class="image"><a href="https://i.imgur.com/xPuPvIa.png"><img style="width:768px" src="https://i.imgur.com/xPuPvIa.png"/></a></figure></div></div><p id="8466b32a-f21a-4cd9-9bfa-27a1bce362f5" class="">define a variable <em>argVar</em> to use later in the 2 commands I ran with <mark class="highlight-pink"><code>bash -c</code></mark></p><div id="33c94313-7183-4ac9-acec-62e63732c8b1" class="column-list"><div id="9448d1d8-14d5-4c32-a72f-33bc983b4348" style="width:31.25%" class="column"><ul id="daa8a3ed-ab29-495b-918f-2690f784f770" class="bulleted-list"><li style="list-style-type:disc">Use xargs with conjunction to find a command to enhance the search results </li></ul></div><div id="3cba17bc-04d1-4e48-b5e1-e43ad07fa3ae" style="width:93.75%" class="column"><figure id="2aecf50a-7fdb-4e37-aac3-9a90dcb679b7" class="image"><a href="https://i.imgur.com/uHTexik.png"><img style="width:768px" src="https://i.imgur.com/uHTexik.png"/></a></figure></div></div><p id="1ce80e4e-fba9-467e-a269-b19012c0b4de" class="">Note: The find command prints results to standard output by default, so the <mark class="highlight-pink"><code>-print</code></mark> option is normally not needed, but <code>-</code><mark class="highlight-pink"><code>print0</code></mark> separates the filenames with a \0 (NULL) byte so that names containing spaces or newlines can be interpreted correctly</p><div id="e063d462-94d2-4482-bd52-59130b967435" class="column-list"><div id="fbdf6287-6cfd-447e-bb3d-2fdd0b570d2c" style="width:68.75%" class="column"><ul id="65f5fd2f-e8f3-4c31-bbc2-ca13cb25c2f0" class="bulleted-list"><li style="list-style-type:disc">You can use xargs command to grep a text from any file in any directory meeting a specific pattern/criteria.</li></ul><p id="e4ce4790-5d3a-4ffd-b918-50a4d8a0a703" class="">You can see that xargs is used to grep a pattern matching anything starting with r with any bunch of characters [:alnum:] and ending with 0. Which returned me this string. </p></div><div id="b94ac948-0a6f-46a3-955a-ee3efc019339" style="width:68.75%" class="column"><figure id="9ac6e795-4615-47b4-a5f8-5f0e6127fd11" class="image"><a href="https://i.imgur.com/MSx79lO.png"><img src="https://i.imgur.com/MSx79lO.png"/></a></figure></div></div><p id="13b78652-7c0f-401d-ba12-926ab52949ca" class="">Note: If the xargs is having the same flags, that can also be interpreted by the following module, in that case you need not worry, because the flags used after the command are the one&#x27;s that are interpreted. </p><p id="3dfb60f9-c568-4e07-b5f7-66127abb0a1a" class=""><span style="border-bottom:0.05em solid"><strong>A note on XARGS (and almost every command line module in linux/unix system)</strong></span></p><p id="e0588cbf-0553-4ef7-8ba7-54f74cac85b4" class="">Room: <a href="https://tryhackme.com/room/linuxprivesc">Linux PrivEsc | Task 10</a>; Gtfobins said, &quot;tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh&quot;</p><p id="bf792763-2588-44d1-9395-db1d11a7c3ee" class="">The catch in the challenge was, sudo was not given to tar, SUID permissions were given to a file not allowed to be edited by any other user (owner: root). So that script has to run with root privileges. We could make the files in that directory in flag format, which tar could interpret as a flag. In our case, tar would start scanning the directory to get the overview of the files to compress and combine them, it will interpret those flags and give us root shell. The point is, I found difficulty in creating those files (via command line) with -- appended to them. I tried xargs but didn&#x27;t work. I then found an article <a href="https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/">here</a>, which helped me and I solved the challenge. Then when I started with the 5th phase of hacking(Covering Tracks). I couldn&#x27;t seem to delete those earlier created <mark class="highlight-pink"><code>--checkpoint</code></mark> files with <mark class="highlight-pink"><code>rm</code></mark>. I tried for an hour or so, but couldn&#x27;t and left. Well, I didn&#x27;t knew this, until I started reading documentations and man pages. Call it an instinct or just luck that I found a way to <em>escape command line flags as a positional argument</em>. Why all this theory, when I can simply get to this point? Well, I believe that it&#x27;s just a better way of learning, when you can append your learnings with an event that had previously occurred. So later, I was able to remove the files using the following command. <mark class="highlight-pink"><code>rm -- --checkpoint=1</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>rm -- --checkpoint-action=exec=sh</code></mark></p><div id="cc0d4870-1d72-4289-8769-ffb601f41465" class="column-list"><div id="87888c88-6be1-49f2-bee2-18bb1b562b99" style="width:112.5%" class="column"><p id="b88c6444-b077-4e6c-a841-9255c6c4eb9d" class="">Notice something different? I was able to escape the following flags using an empty flag notation. This padding technique works in ALMOST EVERY command line module available for linux, unix systems. </p><p id="4a32afa8-2765-4727-9d5c-10ce93b4a4ab" class="">rm didn&#x27;t interpret the files inside dir as a flag bc of -- padding. </p></div><div id="6f510af5-7c30-4375-979b-4399641bb889" style="width:87.5%" class="column"><figure id="0a944488-f15b-4aba-85c9-2607cc2a6142" class="image"><a href="https://i.imgur.com/EXzCCKT.png"><img src="https://i.imgur.com/EXzCCKT.png"/></a></figure></div></div><figure id="cf8bdaa0-f813-42e1-acaf-0f425a846c06" class="image"><a href="https://i.imgur.com/3ZpKZJi.png"><img src="https://i.imgur.com/3ZpKZJi.png"/></a></figure><p id="722fd62f-1ab4-43a3-930c-a8fe84184232" class="">I gave the padding it still showed me an error. Well even if you specify that padding to escape the flags there are &#x27;/&#x27;s inside this string, which makes <mark class="highlight-pink"><code>touch</code></mark> interpret them as create the file <em>bash</em>, inside <em>bin</em> directory that is inside, some <em>--checkpoint-action=exec=</em> directory. You may try using \/bin\/bash to escape the slashes, but that won&#x27;t work either, because files can&#x27;t contain slashes in their name. We can easily bypass this by just using bash or sh instead of specifying the whole path, but make sure that your path is set to normal. Moving forward...</p><figure id="1fb06653-da18-40e0-99b5-acc160058f66" class="image"><a href="https://i.imgur.com/DiR4uSM.png"><img src="https://i.imgur.com/DiR4uSM.png"/></a></figure><div id="19f98d18-8140-43f5-8e88-b81b6980486e" class="column-list"><div id="cf5adde1-d8d3-48a4-b641-b71596302a88" style="width:118.75%" class="column"><p id="523c0e33-5f7a-47f0-8568-e7ae88099ec1" class="">Focus on -n2 used after xargs. 2 arguments at once, in first loop <mark class="highlight-pink"><code>touch -- --checkpoint=1</code></mark>, then <mark class="highlight-pink"><code>touch -- --checkpoint-action=exec=sh</code></mark>. try running tar.</p><p id="a17a16e9-c146-41be-9721-baf82ce3148a" class="">The 2 flag files created were interpreted as flags and then tar had nothing to compress so let&#x27;s create a testfile...</p><p id="c25e44fa-ac11-4c8a-8c4b-4107c9a9aa55" class="">Bingo, we got a shell (not as root, because that was executed as my user. Could give us root, if ran as it).</p></div><div id="d40ff4c4-25a2-466f-bdcc-dd6edcbb272a" style="width:50%" class="column"><figure id="79371ef5-737b-4c96-978e-3ab678a68854" class="image"><a href="https://i.imgur.com/x4N7au9.png"><img src="https://i.imgur.com/x4N7au9.png"/></a></figure><figure id="75f6c620-a824-470b-b995-ba241a7b566a" class="image"><a href="https://i.imgur.com/lx38MfJ.png"><img src="https://i.imgur.com/lx38MfJ.png"/></a></figure></div></div></details></li></ul><ul id="564b5efb-cd32-4c5a-afc3-48df72847eaa" class="toggle"><li><details open=""><summary><strong>sort and uniq</strong></summary><p id="214b29a1-0075-4ea8-9785-91a0dbb36574" class=""><strong><span style="border-bottom:0.05em solid">uniq command</span></strong></p><div id="16d802d8-60ff-43be-b00a-74ce3f0b7214" class="column-list"><div id="d0e45b9b-4c26-462a-bad4-3929f1e09609" style="width:87.5%" class="column"><p id="c1014936-604a-451f-b824-ac7a56b8244d" class="">Unique command filters the output (from either a file or stdin) to remove any duplicates, returning all unique lines and shorter output to focus on, greatly reducing stress on searching through files with repeated line outputs. <strong><strong><strong><strong><strong><strong><strong><strong><strong>However, </strong></strong></strong></strong></strong></strong></strong></strong></strong>uniq ONLY identifies duplicate lines if they are adjacent to each other. So we need to <mark class="highlight-pink"><code>sort</code></mark> lines first.</p><table id="e2f3ab94-8e96-4dcc-91ff-53e6e5607a9f" class="simple-table"><tbody><tr id="a542508f-662b-4db4-aed1-a02e2c86520d"><td id="&lt;nwi" class="block-color-pink" style="width:57px"><strong>Flags</strong></td><td id="X]IX" class="block-color-pink" style="width:353px"><strong>Description</strong></td></tr><tr id="2e14ac02-3b96-4621-9a83-a9fb10ed9bd6"><td id="&lt;nwi" class="" style="width:57px">-c</td><td id="X]IX" class="" style="width:353px">Counts the occurrences of every line in file or stdin</td></tr><tr id="d75d162d-7902-431d-8e56-9967c8aa10dc"><td id="&lt;nwi" class="" style="width:57px">-d</td><td id="X]IX" class="" style="width:353px">Only prints the lines that are repeated, not unique</td></tr><tr id="482dd207-d119-46a0-a276-188c71803f31"><td id="&lt;nwi" class="" style="width:57px">-u</td><td id="X]IX" class="" style="width:353px">Only prints lines that are already uniq</td></tr><tr id="2815e3f5-6f6b-4561-a937-66409bfc2869"><td id="&lt;nwi" class="" style="width:57px">-i</td><td id="X]IX" class="" style="width:353px">Ignores case (Default is case-sensitive)</td></tr></tbody></table><p id="8969cba0-700e-4123-8ef5-d82de70d8f63" class=""><span style="border-bottom:0.05em solid"><strong>sort command</strong></span></p><p id="24ebb47f-5aa8-4117-800c-70bfd5e7864b" class="">sort command sorts the lines alphabetically and numerically, automatically, only needing you to pipe the stdin into sort command.</p><p id="fe490397-a8f0-435e-87dd-b845e75762d4" class="">To remove any duplicate lines, <mark class="highlight-pink"><code>sort</code></mark> the lines and then use <mark class="highlight-pink"><code>uniq</code></mark> on the output. <mark class="highlight-pink"><code>sort file.txt | uniq</code></mark></p></div><div id="7208eb43-7808-484b-be58-241e8b00399c" style="width:87.49999999999999%" class="column"><figure id="f3c7fda5-779a-411c-8e41-1a55cfaa1775" class="image"><a href="https://i.imgur.com/1qv9dGO.png"><img style="width:624px" src="https://i.imgur.com/1qv9dGO.png"/></a></figure><table id="804ab027-76bc-489f-9c80-685dfe52a8ac" class="simple-table"><tbody><tr id="7441f9a4-9204-4856-8aec-c5ed6169255f"><td id="~Zee" class="block-color-pink" style="width:70px"><strong>Flags</strong></td><td id="~ks{" class="block-color-pink" style="width:340px"><strong>Description</strong></td></tr><tr id="fffd25db-1ec8-4d75-8103-98e7f3231989"><td id="~Zee" class="" style="width:70px">-r</td><td id="~ks{" class="" style="width:340px">Sorts in reverse order</td></tr><tr id="5f57264e-967e-45b1-b661-46a989c9c38f"><td id="~Zee" class="" style="width:70px">-c</td><td id="~ks{" class="" style="width:340px">Checks if file is sorted, else, lists start of disorder</td></tr><tr id="ea3912ab-b469-44eb-b7a8-9c25766fe408"><td id="~Zee" class="" style="width:70px">-u</td><td id="~ks{" class="" style="width:340px">Sorts and removes duplicate lines</td></tr><tr id="4ba1a6b5-9090-40a3-9005-d53cde550874"><td id="~Zee" class="" style="width:70px">-o file</td><td id="~ks{" class="" style="width:340px">Saves into a output file</td></tr></tbody></table></div></div></details></li></ul></details></li></ul><ul id="093d9cba-39bc-41f0-8204-37a8eae7589d" class="toggle"><li><details open=""><summary><strong>cURL (crawl URL)</strong></summary><p id="b606c77c-2ffe-4e96-bc3a-b5e897bd354e" class="">cURL outputs data of URLs webpage in raw format; download pictures from a direct google search with grep and pattern matching iframes; get an offline copy of a webpage/download large files/activate webshells (for a reverse connection) Syntax: <code><mark class="highlight-pink">curl https... </mark></code>curl works on HTTP/HTTPS/FTP protocol <strong>AND</strong> Telnet, POP, IMAP, +. ; use curl as an alternative wget, while transferring privesc scripts from attack box to the host system</p><table id="443fc93a-f1f0-44b2-b586-7638a73ddedd" class="simple-table"><tbody><tr id="260895eb-f8f6-4e56-bc0b-03130540a2c9"><td id="Rm{o" class="" style="width:98px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="`A&gt;z" class="" style="width:836px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="6a2113b5-7212-4524-b3e1-2caee9e5b589"><td id="Rm{o" class="" style="width:98px">-#</td><td id="`A&gt;z" class="" style="width:836px">Displays a progress meter for you to know how much the download has progressed or use --silent flag for a silent crawl</td></tr><tr id="da3a1555-566c-4138-abc4-4ef6409224d7"><td id="Rm{o" class="" style="width:98px">-o</td><td id="`A&gt;z" class="" style="width:836px">Saves the file downloaded with the name given following the flag</td></tr><tr id="ca481438-458d-4c39-b6d1-b1bbfb155546"><td id="Rm{o" class="" style="width:98px">-O</td><td id="`A&gt;z" class="" style="width:836px">Saves the file with the name it was saved on the server</td></tr><tr id="6ba588d7-b704-4284-935b-c5e83a9b2597"><td id="Rm{o" class="" style="width:98px">-C -</td><td id="`A&gt;z" class="" style="width:836px">Resumes your broken download without specifying an offset</td></tr><tr id="1d439a74-f236-43d1-b5e9-1b330371b190"><td id="Rm{o" class="" style="width:98px">--limit-rate</td><td id="`A&gt;z" class="" style="width:836px">Limits the download/upload rate to somewhere near the specified range (Units in 100K,100M,100G)</td></tr><tr id="6839cd67-d7a5-40ed-8cb5-d65ce853d8d7"><td id="Rm{o" class="" style="width:98px">-u</td><td id="`A&gt;z" class="" style="width:836px">Provides user authentication (Format: -u user:password)</td></tr><tr id="ee93f315-48a4-4fe3-8c7d-3e2983a0b34c"><td id="Rm{o" class="" style="width:98px">-T</td><td id="`A&gt;z" class="" style="width:836px">Helps in uploading the file to some server (In our case php-reverse-shell)</td></tr><tr id="812a0c1a-79c3-43d4-b577-fb8e5ceb4013"><td id="Rm{o" class="" style="width:98px">-x</td><td id="`A&gt;z" class="" style="width:836px">Specifies proxy server if you have to view the page through a PROXY (-x <a href="http://proxy.server.com">proxy.server.com</a> user:password (Authentication ))</td></tr><tr id="15995171-7955-40a3-b335-6be1b91699b6"><td id="Rm{o" class="" style="width:98px">-I</td><td id="`A&gt;z" class="" style="width:836px">(Caps i) Queries the header and not the webpage</td></tr><tr id="7e8d4687-7282-4a98-b2b6-302761c8fabc"><td id="Rm{o" class="" style="width:98px">-A</td><td id="`A&gt;z" class="" style="width:836px">Specifies user agent to make request to the server</td></tr><tr id="8949086b-e8d1-42c9-9d75-6f8b6005e169"><td id="Rm{o" class="" style="width:98px">-L</td><td id="`A&gt;z" class="" style="width:836px">Tells curl to follow redirects</td></tr><tr id="9fb4428d-b818-4fc2-8dfa-3fd416412b79"><td id="Rm{o" class="" style="width:98px">-b</td><td id="`A&gt;z" class="" style="width:836px">Allows you to specify cookies while making a curl request (Cookie should be in the format &quot;NAME1=VALUE1;NAME2=VALUE2&quot;)</td></tr><tr id="4419301c-1d37-4990-b362-902fdd88062c"><td id="Rm{o" class="" style="width:98px">-d</td><td id="`A&gt;z" class="" style="width:836px">Used to POST data to the server (generally used for posting form data)</td></tr><tr id="3abaf626-84bb-4de3-8dbe-d7ce4a8fed71"><td id="Rm{o" class="" style="width:98px">-X</td><td id="`A&gt;z" class="" style="width:836px">Specifies the HTTP method on the URL (GET,POST,TRACE,OPTIONS)</td></tr></tbody></table><div id="1a2dc5cb-e37c-4896-95f8-1a750b3167fc" class="column-list"><div id="bd2049f4-dc70-44e1-90a0-2968afd01fba" style="width:25%" class="column"><p id="de45bb0b-a2b2-4b92-a322-3d6796e13b2b" class="">Continuing a download: set the --continue-at &lt;offset&gt; to a - (hyphen; to continue download by automatically identifying the offset)</p><p id="cb507289-69e2-4079-965c-9d4de64ab7eb" class="">Saving the file with the name it was saved on the server.</p></div><div id="4018e5bb-d3dd-4206-a480-d8ac01968093" style="width:100%" class="column"><figure id="5820c7dc-916b-4640-bd6b-82127e24347f" class="image"><a href="https://i.imgur.com/P7mYzir.png"><img style="width:768px" src="https://i.imgur.com/P7mYzir.png"/></a></figure><figure id="14cf0264-5abe-49ed-b97d-f93bf541ec05" class="image"><a href="https://i.imgur.com/msy0Li2.png"><img src="https://i.imgur.com/msy0Li2.png"/></a></figure></div></div></details></li></ul><ul id="daedb31b-79e2-4762-8401-73d602819971" class="toggle"><li><details open=""><summary><strong>wget</strong></summary><p id="32e13b6a-cfb7-4efc-8428-e927e9859b92" class="">the command line way of downloading stuff; Note: wget supports ftp, http and https; Syntax: <mark class="highlight-pink"><code>wget protocol://url.com/</code></mark></p><table id="c53d7e91-f320-4e68-aca7-4e00491033c3" class="simple-table"><tbody><tr id="da290d6e-f246-42eb-bfe7-98b46d0db596"><td id="TjCi" class="" style="width:166px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="Bb`O" class="" style="width:723px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="00dde755-de5b-4a41-882d-2f9c07d8686d"><td id="TjCi" class="" style="width:166px">-b</td><td id="Bb`O" class="" style="width:723px">Background the downloading process</td></tr><tr id="97be1341-c733-4824-a537-1e5adf15a77c"><td id="TjCi" class="" style="width:166px">-c</td><td id="Bb`O" class="" style="width:723px">Continues to/looks for partially downloaded file in the dir and starts appending; takes no argument</td></tr><tr id="4b113dc6-af50-4b37-a7c2-09a90e7d6670"><td id="TjCi" class="" style="width:166px">-t int</td><td id="Bb`O" class="" style="width:723px">Specifies retries to the URL</td></tr><tr id="9ec48c8b-2831-4a56-9e36-26a935180dd0"><td id="TjCi" class="" style="width:166px">-O download.txt</td><td id="Bb`O" class="" style="width:723px">Specifies the output name of downloaded file</td></tr><tr id="5fafef55-8af0-4d32-a8bf-ccc096f52c0b"><td id="TjCi" class="" style="width:166px">-o file</td><td id="Bb`O" class="" style="width:723px">Overwrites the logs into another file</td></tr><tr id="c51c288d-06f5-4cf2-b9d2-870c9dd9703f"><td id="TjCi" class="" style="width:166px">-a file</td><td id="Bb`O" class="" style="width:723px">Append the logs into already existing file without deleting previous contents</td></tr><tr id="6fe215ac-f46a-4684-809a-6e8556e335b3"><td id="TjCi" class="" style="width:166px">-i file</td><td id="Bb`O" class="" style="width:723px">Read the list of URLs from a file</td></tr><tr id="4c13429a-cc1a-4a5e-b547-b0c43d835bba"><td id="TjCi" class="" style="width:166px">--user=username</td><td id="Bb`O" class="" style="width:723px">Give a login username (Use --ftp-user and --http-user if doesn&#x27;t work)</td></tr><tr id="300ae252-78de-4831-893e-27017c29a65f"><td id="TjCi" class="" style="width:166px">--password=password</td><td id="Bb`O" class="" style="width:723px">Give a login password ( Use --ftp-password and --http-password if doesn&#x27;t work)</td></tr><tr id="28b4c16d-b495-4015-a110-fa9bbaf0e4c1"><td id="TjCi" class="" style="width:166px">--ask-password</td><td id="Bb`O" class="" style="width:723px">Ask for password prompt if login is necessary</td></tr><tr id="def4e1e5-ea05-4893-87e7-2d2d88a4eba5"><td id="TjCi" class="" style="width:166px">--limit-rate=10k</td><td id="Bb`O" class="" style="width:723px">Similar to curl (supports k and m notation for kB and mB respectively)</td></tr><tr id="84824320-03ec-4164-aec1-927ec4c6dce7"><td id="TjCi" class="" style="width:166px">-w=&lt;int&gt;</td><td id="Bb`O" class="" style="width:723px">Specifies the waiting time before the retrieval from a URL (Takes time in seconds)</td></tr><tr id="68b14505-f60e-43bb-a25e-a62eace7e426"><td id="TjCi" class="" style="width:166px">-T=&lt;int&gt;</td><td id="Bb`O" class="" style="width:723px">Timeout the retrieval after a specified amount of time (Takes time in seconds)</td></tr><tr id="aab16d40-96d0-4bd6-8725-d598e7ea2436"><td id="TjCi" class="" style="width:166px">-N</td><td id="Bb`O" class="" style="width:723px">Enables timestamping</td></tr><tr id="4446550f-4a2e-40c6-8fa7-1751c2402bfe"><td id="TjCi" class="" style="width:166px">-U</td><td id="Bb`O" class="" style="width:723px">Specifies the user-agent while downloading the file</td></tr></tbody></table></details></li></ul><ul id="1a09ecde-23bb-451c-a34c-cf1bcb2525f1" class="toggle"><li><details open=""><summary><strong>xxd</strong></summary><p id="25db2567-6934-400a-bda2-9f318955f6d7" class="">known for hexdumps or reverse; helps handle hex strings and hex digits; takes file input or passes input through piping/redirection</p><table id="eae299bf-d7d9-474e-af26-99d1eeafd185" class="simple-table"><tbody><tr id="6f58d513-c63a-4c4b-938c-988c06b92c43"><td id="fuV:" class="" style="width:78px"><strong><mark class="highlight-pink">Flags</mark></strong></td><td id="DKyd" class="" style="width:858px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="e385a924-c15f-4ffc-b756-6c565493bf96"><td id="fuV:" class="" style="width:78px">-b</td><td id="DKyd" class="" style="width:858px">Gives binary representation instead of hexdump</td></tr><tr id="a585bf74-61f7-4941-9c6d-c64d84639a2a"><td id="fuV:" class="" style="width:78px">-E</td><td id="DKyd" class="" style="width:858px">Changes character encoding in the right-hand column from ASCII to EBCDIC (Extended Binary Coded Decimal Interchange)</td></tr><tr id="b880be1c-6c35-4cc0-b052-5b86393e213c"><td id="fuV:" class="" style="width:78px">-c int</td><td id="DKyd" class="" style="width:858px">Sets the number of bytes to be represented in one row (i.e. setting the column size in bytes; Default to 16)</td></tr><tr id="57c2760e-1476-4d5f-b77d-60e508ab7844"><td id="fuV:" class="" style="width:78px">-g</td><td id="DKyd" class="" style="width:858px">Sets how many bytes/octets should be in group i.e. separated by whitespace (default to 2 bytes; Set -g0 if no space is needed).</td></tr><tr id="69318280-579d-41fc-95f2-f8e432338a86"><td id="fuV:" class="" style="width:78px">-i</td><td id="DKyd" class="" style="width:858px">Output the hexdump in C include format (&#x27;0xff&#x27; integers)</td></tr><tr id="607f8937-8ad8-44f6-badc-39670be7e4ae"><td id="fuV:" class="" style="width:78px">-l</td><td id="DKyd" class="" style="width:858px">Specify the length of output (if the string is bigger than the length specified, hex of the rest of the string will not be printed)</td></tr><tr id="c4a917ca-8d4c-466c-a5aa-b48b684bdf89"><td id="fuV:" class="" style="width:78px">-p</td><td id="DKyd" class="" style="width:858px">Second most used flag; Converts the string passed into plain hexdump style(continuous string of hex bytes)</td></tr><tr id="3015bb1c-581d-4eef-b3e2-f13d2e466178"><td id="fuV:" class="" style="width:78px">-r</td><td id="DKyd" class="" style="width:858px">Most used flag, reverts the hexdump to binary(Interpreted as plain text).</td></tr><tr id="9a796488-ab83-4678-bdeb-156763a39bc5"><td id="fuV:" class="" style="width:78px">-u</td><td id="DKyd" class="" style="width:858px">Uses uppercase hex letters (default is lower case)</td></tr><tr id="767e6961-b436-4fce-9e81-32a001309a52"><td id="fuV:" class="" style="width:78px">-s</td><td id="DKyd" class="" style="width:858px">Seeks at offset </td></tr></tbody></table><div id="afbf5ba1-6366-4ae3-a54b-36f1115b85d6" class="column-list"><div id="158207fb-6321-41c3-9972-6275f2f63372" style="width:100%" class="column"><p id="9f2264fb-0a9e-4259-bd6d-0d7111c373fc" class="">Use of -E flag (For curious minds)</p><p id="9b81d9fd-75ed-4448-b849-646a77392d9e" class="">Seeking at offset from the end of the file.</p><p id="78066698-01f0-49f8-8698-f4b0f449c4cb" class="">By appending the offset&#x27;s value with a hyphen the command starts dumping from the end of the file. There is a difference between <mark class="highlight-pink"><code>-s +offset</code></mark> and <mark class="highlight-pink"><code>-s offset</code></mark> while seeking through stdin. If there is error while seeking offset through stdin, try redirecting stdin to a file and then perform hexdump with xxd </p></div><div id="f43a4bbc-94c3-4b54-b4d5-7748d79a2da2" style="width:100%" class="column"><figure id="f2660906-114a-4eb1-96fb-c1a362da26a7" class="image"><a href="https://i.imgur.com/qHNfVRk.png"><img src="https://i.imgur.com/qHNfVRk.png"/></a></figure><figure id="afc53f27-bce5-4876-94cd-f8acf63ee415" class="image"><a href="https://i.imgur.com/4iDbGqm.png"><img src="https://i.imgur.com/4iDbGqm.png"/></a></figure></div></div></details></li></ul><ul id="56156507-b813-4297-bf69-c2e4683012cc" class="toggle"><li><details open=""><summary><strong>Other Modules</strong></summary><p id="6ae8510b-68d0-41bb-bfc2-c742d4e0f089" class=""><strong>gpg command</strong> - <em>Sidenote: GPG(Gnu Privacy Guard) and PGP(Pretty Good Privacy) are 2 different types of encryption. PGP is based on RSA encryption, whereas GPG(open-source) is a re-write of PGP and by default uses AES encryption.</em></p><p id="aa7a23d7-3a78-4e5c-b22e-05db5266aaa6" class=""><strong>tar command</strong> - Whether it is a gzip archive or a bzip archive, encrypting and decrypting can be easily done by this tool. </p><p id="7b6369c3-7faa-4960-a4ac-479f75d79139" class=""><strong>id/pwd/uname commands</strong> </p><p id="41459715-d77b-4f06-ac0f-bac332c555bd" class=""><strong>ps/kill commands - </strong>List processes, and kill processes with PID. To know more about ps command you can find some help <a href="https://man7.org/linux/man-pages/man1/ps.1.html">here</a>.</p><p id="945f092c-403f-4f0a-9acd-88c11c658ccb" class=""><strong>netstat command - </strong>lists any network activity on the current system. Any ports that are open/listening/not-established, connections alternates to netstat command: i.e. <mark class="highlight-pink"><code>ss</code></mark> (socket statistics) command (lists port activity in real time).</p><p id="00bee60a-1319-470a-ad48-2465db0415b7" class=""><strong>less/more commands - </strong>alternate to open and read the file. more is an old command and less was built to better the more command. More has limited backward scrolling, less has forward and backward navigation including better search options (/); one more command to improve <mark class="highlight-pink"><code>less</code></mark> features, not installed by default on some linux distros, install with <mark class="highlight-pink"><code>sudo apt install most</code></mark></p><p id="9fe2be5d-2e20-40bb-a68d-754ebd59f21e" class=""><strong>diff command - </strong>compares chars byte-by-byte to find the difference between 2 files. Though ONLY 2 files at a time; alternate: comm compares 2 sorted files line by line; more focused on commonalities in between 2 files. </p><p id="fd639645-de46-453f-9b65-6a1cac07f6f0" class=""><strong>base64 command - </strong>encodes binary strings into text representations using the base64 encoding format</p><p id="23461441-edad-4731-a108-36c22f5d57c4" class=""><strong>tee command - </strong>reads from stdin and writes to the stdout and files as well.</p><p id="993341ba-44b0-4f36-ab20-7fb075fa240c" class=""><strong>file/stat commands - </strong>reads the file headers and tells you what the file actually is</p><p id="f10dae17-f4e4-4cbf-a75b-3a05371e500b" class=""><strong>export command - </strong>used to set the environment variables</p><p id="8ae0d6ca-52f9-4b92-8bc8-fa2c2f3e98cb" class=""><strong>reset command - </strong>if your terminal is not working properly but you can&#x27;t close the shell, <mark class="highlight-pink"><code>reset</code></mark> to get your shell back to normal.</p><p id="3a1093c8-8612-40a5-b484-5044b39766e0" class=""><strong>systemctl/service command -</strong><mark class="highlight-pink"><code>service</code></mark> command is a normal command to initialize services present in /etc/init.d, without making an admin worry about permanent system changes, <mark class="highlight-pink"><code>systemctl</code></mark> is a heavy command which can hinder with the default settings. </p></details></li></ul><h3 id="5c3ba8f2-41cc-42b7-8cc8-e8f41bae6295" class="block-color-purple_background"><mark class="highlight-purple_background">Nmap</mark></h3><ul id="610212d5-2857-4a77-be8c-678328cf1287" class="toggle"><li><details open=""><summary><strong>Intro</strong></summary><div id="b2518e4f-6e43-42b7-a4d9-25398cbf01a7" class="column-list"><div id="5c53680a-e74c-4701-9657-6c82445fe269" style="width:100%" class="column"><p id="4fac79fb-f48c-448a-a916-32a717617759" class="">To perform a security audit on an ip address: first, get an idea of the “landscape” we are attacking and establish which services are running on the targets. The first stage in establishing this “map” is called port scanning: A computer runs a network service by opening a networking construct called a “port” to receive the connection. Ports are necessary for making multiple network requests or having multiple services available. -eg when you load several webpages at once in a browser, the program must be able to determine which tab loads which web page. This is done by establishing connections to the remote webservers using different ports on your local machine. If you want a server to be able to run more than one service, you need a way to direct traffic to the appropriate service using ports. Network connections are made between two ports – an open port listening on the server and a randomly selected port on your own computer. The diagram shows when you connect to numerous websites at the same time, your computer opens up a different, high-numbered port (at random) for all its communications with the remote server.</p></div><div id="4ab80a63-687e-445d-8bcb-9ff181dad93d" style="width:100%" class="column"><figure id="7d6c49f8-1b66-4cf8-a709-8abf186c076e" class="image"><a href="https://i.imgur.com/3XAfRpI.png"><img style="width:432px" src="https://i.imgur.com/3XAfRpI.png"/></a></figure></div></div><p id="74d4c46a-ac6d-48e1-8653-00fb9dc61763" class="">Every computer has a total of 65535 available ports; however, many are registered as standard ports. eg, HTTP Webservice - nearly always port 80, HTTPS Webservice - port 443, Windows NetBIOS -port 139, and SMB - port 445. ImpNote: however, especially in a CTF setting, it’s possible for standard ports to be altered. If we do not know which of these ports a server has open, then we do not have hopes of successfully attacking the target; thus, it is crucial that we begin any attack with a port scan. This can be accomplished in a variety of ways – usually using the Nmap tool. Nmap can perform many different kinds of port scans – nmap will connect to each port of the target in turn. Depending on how the port responds, it can be determined as being open, closed, or filtered (usually by a firewall). Once we know which ports are open, we can then look at enumerating which services are running on each port – either manually, or more commonly using nmap. nmap is the industry standard: no other port scanning tool comes close to its functionality, It is extremely powerful – even more powerful with its scripting engine that scans for vulnerabilities, and in some cases performs the exploit directly</p><p id="ca9c98a3-68c3-451c-9213-8e882fd0fa02" class=""><strong>Nmap Switches - </strong>nmap is run from the terminal; can be accessed by typing <mark class="highlight-pink"><code>nmap</code></mark> into the terminal, followed by some &quot;switches&quot; </p></details></li></ul><ul id="82b32b52-b93b-4d00-84ac-d2915f33d1b8" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> Overview</summary><p id="ad153a11-f650-4102-be2d-4f9c53221477" class="">When port scanning with Nmap, three <strong>basic</strong> scan types: TCP Connect Scans (<mark class="highlight-pink"><code>-sT</code></mark>), SYN &quot;Half-open&quot; Scans (<mark class="highlight-pink"><code>-sS</code></mark>), UDP Scans (<mark class="highlight-pink"><code>-sU</code></mark>) <strong>Less common</strong> port scan types: TCP Null Scans (<mark class="highlight-pink"><code>-sN</code></mark>), TCP FIN Scans (<mark class="highlight-pink"><code>-sF</code></mark>), TCP Xmas Scans (<mark class="highlight-pink"><code>-sX</code></mark>)</p></details></li></ul><ul id="c3ca3826-2db7-4096-bea8-e9edd4846c80" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> TCP Connect Scans</summary><div id="02b1cb90-d4e4-4026-8569-44d8623596a5" class="column-list"><div id="5b26bc90-e7d8-4c01-8acf-035250dd7d0a" style="width:118.75%" class="column"><p id="deedf440-cad3-4e88-b1fb-c9c7dc9cc0f5" class="">TCP Connect scans (<mark class="highlight-pink"><code>-sT</code></mark>), be comfortable with the <em>TCP three-way handshake</em>. The three-way handshake consists of three stages. First, the connecting terminal (attacking machine, in this case) sends a TCP request to the target server with the SYN flag set. The server then acknowledges this packet with a TCP response containing the SYN flag, as well as the ACK flag. Finally, our terminal completes the handshake by sending a TCP request with the ACK flag set.</p><p id="e2c4ce00-3275-43d3-b912-8e5c2399702e" class="">A TCP Connect scan performs a three-way handshake with each target port in turn. Nmap tries to connect to each specified TCP port, and determines whether the service is open by the response it receives.</p></div><div id="7af9511d-f368-4e3d-ae17-958c58893117" style="width:81.24999999999999%" class="column"><figure id="a34ae5cb-73c5-45f8-9c27-cdd37c37bfa6" class="image"><a href="https://muirlandoracle.co.uk/wp-content/uploads/2020/03/image-2.png"><img src="https://muirlandoracle.co.uk/wp-content/uploads/2020/03/image-2.png"/></a></figure></div></div><figure id="db0891fb-b8b6-47a6-b001-eea7dbf85a52" class="image"><a href="https://i.imgur.com/ngzBWID.png"><img src="https://i.imgur.com/ngzBWID.png"/></a></figure><div id="7a866bfa-09eb-41e8-a008-baadf8d9d7b2" class="column-list"><div id="a4a997c3-9dcc-423c-8cc0-3ba88c7f1691" style="width:118.75%" class="column"><p id="ee942c1a-94f1-47a6-87c5-8e12a57b13d0" class="">eg, if a port is closed, <a href="https://tools.ietf.org/html/rfc793">RFC 793</a> states that:</p><p id="26e05f70-01f9-43a2-ae61-fc0a77c3004a" class=""><em>&quot;... If the connection does not exist (CLOSED) then a reset is sent in response to any incoming segment except another reset.  In particular, SYNs addressed to a non-existent connection are rejected by this means.&quot; </em>If Nmap sends a TCP request with the <em>SYN</em> flag set to a <em><strong>closed</strong></em> port, the target server will respond with a TCP packet with the <em>RST</em> (Reset) flag set. By this response, Nmap can establish that the port is closed. If the request is sent to an <em>open</em> port, the target will respond with a TCP packet with the SYN/ACK flags set. Nmap marks this port as being <em>open</em> (and completes the handshake by sending back a TCP packet with ACK set).</p><p id="2d62a470-a3b2-4034-a624-45df8dd240b7" class="">What if the port is open, but hidden behind a firewall?</p></div><div id="0bcdc8e5-f15a-4d1c-84ed-01222c221252" style="width:43.75000000000001%" class="column"><figure id="32305993-011d-4443-92d0-fee3cc09326f" class="image"><a href="https://i.imgur.com/vUQL9SK.png"><img src="https://i.imgur.com/vUQL9SK.png"/></a></figure></div></div><p id="63ce066a-fcb6-4559-9efc-bde5d7c7410e" class="">Many firewalls are configured to <strong>drop</strong> incoming packets. Nmap sends a TCP SYN request, and receives nothing back: the port is being protected by a firewall and thus the port is considered to be <em>filtered</em>. That said, it is easy to configure a firewall to respond with a RST TCP packet, making it extremely difficult/impossible to get an accurate reading of the target(s). eg, in IPtables for Linux, a version of the command:<code><mark class="highlight-pink">iptables -I INPUT -p tcp --dport &lt;port&gt; -j REJECT --reject-with tcp-reset </mark></code></p></details></li></ul><ul id="eef93f0f-cc35-44c5-bf94-4666e2a4d849" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> SYN Scans</summary><div id="d521b537-012f-44ea-a174-ffd23ecd1542" class="column-list"><div id="f6b20197-97ce-4a69-afaf-b02b0b87620b" style="width:75%" class="column"><p id="e4628e80-ad66-4fae-905e-4233b1969fa7" class="">Like TCP scans, SYN scans (<mark class="highlight-pink"><code>-sS</code></mark>) are used to scan the TCP port range of a target(s), however, they handle open ports differently. SYN scans are referred to as &quot;<em>Half-open&quot; </em>scans, or <em>&quot;Stealth&quot; </em>scans. Where TCP scans perform a full three-way handshake with the target, SYN scans send back a RST TCP packet after receiving a SYN/ACK from the server (this prevents the server from repeatedly trying to make the request). The sequence for scanning an <strong>open</strong> port looks like this:</p><figure id="a5638eed-58b7-43c7-9700-c74eebbb3ed9" class="image"><a href="https://i.imgur.com/bcgeZmI.png"><img src="https://i.imgur.com/bcgeZmI.png"/></a></figure><p id="b6a85c8d-fb94-47bb-ada8-ce9f3b7d3786" class="">Advantages for hackers: It can bypass old Intrusion Detection systems that look for a full three-way handshake, SYN scans are often not logged by applications listening on open ports; standard practice is to log a connection once it&#x27;s been fully established, Without having to complete (and disconnect from) a three-way handshake for every port, SYN scans are faster than a standard TCP Connect scan</p></div><div id="bbf69faa-1ee0-40fe-aec4-953beda0a465" style="width:56.249999999999986%" class="column"><figure id="71bd25cb-6b1e-4194-80ea-3905b183a901" class="image"><a href="https://i.imgur.com/cPzF0kU.png"><img src="https://i.imgur.com/cPzF0kU.png"/></a></figure></div></div><p id="2e2e91c5-6a25-41f5-a8fc-a367a83c7dff" class="">Disadvantages to SYN scans: require sudo permissions for Linux because SYN scans require creating raw packets only the root user can, Unstable services are sometimes brought down by SYN scans; problematic if a client has a production environment for the test.</p><p id="17807dac-d932-4bdf-8fbd-3a443e660079" class="">pros outweigh cons: Nmap defaults to SYN scans if run with sudo permissions<em>; </em><strong>without</strong> sudo, Nmap defaults to TCP Connect scan. When using a SYN scan to identify closed and filtered ports, the exact same rules as with a TCP Connect scan apply. If a port is closed, the server responds with a RST TCP packet. If the port is filtered by a firewall then the TCP SYN packet is either dropped, or spoofed with a TCP reset. SYN scans can also be made to work by giving Nmap the CAP_NET_RAW, CAP_NET_ADMIN and CAP_NET_BIND_SERVICE capabilities; however, this may not allow many of the NSE scripts to run properly.</p></details></li></ul><ul id="bf6098c7-962c-494d-9fdd-9555f49672de" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> UDP Scans</summary><p id="091e73fe-57dd-4cad-a7f5-f9925bd5a813" class="">Unlike TCP, UDP connections are <em>stateless</em>. Rather than initiating a back-and-forth &quot;handshake&quot; connection, UDP connections rely on sending packets to a target port and hoping that they make it. This makes UDP superb for connections relying on speed over quality, but the lack of acknowledgment makes UDP more difficult and slower to scan. The switch for a Nmap UDP scan is (<mark class="highlight-pink"><code>-sU</code></mark>)</p><p id="9f26bf33-6037-46c0-ae8f-b74fa251f55b" class="">When a packet is sent to an open UDP port, there should be no response. Nmap refers to the port as being <mark class="highlight-pink"><code>open|filtered</code></mark>. It suspects the port is open, but it could be firewalled. If it gets a UDP response (unusual), the port is marked as <em>open</em>. More commonly there is no response, in which case the request is sent a second time as a double-check. If there is still no response the port is marked <mark class="highlight-pink"><code>open|filtered</code></mark> and Nmap moves on. When a packet is sent to a closed UDP port, the target should respond with an ICMP (ping) packet containing a message that the port is unreachable. This identifies closed ports, which Nmap marks as such and moves on.</p><p id="23e279d1-d440-4819-aea9-bb39d11fece8" class="">Due to difficulty in identifying whether a UDP port is actually open, UDP scans tend to be incredibly slow in comparison to the various TCP scans (about 20 minutes to scan the first 1000 ports with a good connection). It&#x27;s a good practice to run an Nmap scan with <mark class="highlight-pink"><code>--top-ports &lt;number&gt;</code></mark> enabled. eg, scanning <code><mark class="highlight-pink">nmap -sU --top-ports 20 &lt;target&gt;</mark></code><mark class="highlight-pink"> </mark>will scan the top 20 most commonly used UDP ports, resulting in a much more acceptable scan time.</p><p id="33e3c592-ee70-4ec0-95c9-4b948672358c" class="">When scanning UDP ports, Nmap usually sends completely empty requests -- just raw UDP packets. That said, for ports which are usually occupied by well-known services, it will instead send a protocol-specific payload which is more likely to elicit a response from which a more accurate result can be drawn.</p></details></li></ul><ul id="83dfdc43-3a2f-4aa3-8aab-01de45d6eca4" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> NULL, FIN and Xmas</summary><p id="a35c4aee-3d2c-42d6-a319-5de369ab8c63" class="">NULL, FIN and Xmas TCP port scans are less commonly used are interlinked and tend to be even stealthier than a SYN scan. All expect the target host to respond with a RST if the port is closed.</p><div id="d6560bc9-922d-444b-8f99-22f71f86fc02" class="column-list"><div id="92576eaa-1748-4ef6-b4d4-e95b1f748e36" style="width:100%" class="column"><p id="309862e9-1b68-4936-8abb-12d27c42d8e0" class="">NULL scans (<mark class="highlight-pink"><code>sN</code></mark>) send TCP requests with no flags set</p><p id="716389d1-4670-4a52-b0e9-4f836519fb9c" class="">FIN scans (<mark class="highlight-pink"><code>sF</code></mark>) work in an almost identically; instead of sending a completely empty packet, a request is sent with the FIN flag (usually to gracefully close an active connection)</p><p id="f83cddac-1446-4287-bef4-4b00b0f45d8a" class="">Xmas scans (<mark class="highlight-pink"><code>sX</code></mark>) send a malformed TCP packet; the flags set (PSH, URG, FIN) give it the appearance of a blinking christmas tree when viewed as a packet capture in Wireshark.</p><figure id="83c9c468-ef36-473d-90eb-2b214376d2e8" class="image"><a href="https://i.imgur.com/gKVkGug.png"><img src="https://i.imgur.com/gKVkGug.png"/></a></figure></div><div id="82a22e8e-b4fc-4743-b2de-d8651d149363" style="width:100%" class="column"><figure id="83031aa3-ef50-4977-9aeb-6d637226c7b7" class="image"><a href="https://i.imgur.com/ABCxAwf.png"><img src="https://i.imgur.com/ABCxAwf.png"/></a></figure><figure id="a3607b26-9923-4e30-abbc-84ad3eadc0ec" class="image"><a href="https://i.imgur.com/gIzKbEk.png"><img src="https://i.imgur.com/gIzKbEk.png"/></a></figure></div></div><p id="f1aecd2f-25d7-4b3a-82af-7fbd6d6e1625" class="">The expected response for <em>open</em> ports with these scans is also identical and similar to a UDP scan. If the port is open, there is no response to the malformed packet. Unfortunately (as with open UDP ports), that is also<em> </em>an expected behavior if the port is protected by a firewall, so NULL, FIN, and Xmas scans will only identify ports as being <em>open|filtered</em>, <em>closed</em>, or <em>filtered</em>. If a port is identified as filtered with one of these scans, usually the target has responded with an ICMP unreachable packet. While RFC 793 mandates network hosts respond to malformed packets with an RST TCP packet for closed ports and don&#x27;t respond for open ports; this is not always the case. In particular, Microsoft Windows (and many Cisco network devices) are known to respond with an RST to any malformed TCP packet regardless of whether the port is open or not, resulting in all ports showing up as closed.</p><p id="8a480370-6400-47aa-a1d0-c9ca68a5d6b5" class="">The goal is firewall evasion. Many firewalls are configured to drop incoming TCP packets to blocked ports that have the SYN flag set thus blocking new connection initiation requests. By sending requests that without the SYN flag, we bypass this kind of firewall. Most IDS solutions are savvy to these scans, so don&#x27;t rely on them to be 100% effective when dealing with modern systems.</p></details></li></ul><ul id="762d4235-1fbc-40bc-b8c5-187e43d64cf5" class="toggle"><li><details open=""><summary><strong>Scan Types</strong> ICMP Network Scanning</summary><p id="cba1de73-dab2-431c-8920-a3b2e6221299" class="">On first connection to a target network in a black box assignment, our first objective is to obtain a map of the network structure; we want to see which IP addresses contain active hosts and which do not. One way to do this is by using Nmap to perform a ping sweep. Nmap sends an ICMP packet to each possible IP address for the specified network. When it receives a response, it marks the IP address that responded as alive. This is not always accurate; however, it can provide something of a baseline. To perform a ping sweep, we use <code><mark class="highlight-pink">-sn</mark></code> in conjunction with IP ranges specified with either a hyphen (<mark class="highlight-pink"><code>-</code></mark>) or CIDR notation. i.e. scan the <mark class="highlight-pink"><code>192.168.0.x</code></mark><mark class="highlight-pink"> </mark>network: <mark class="highlight-pink"><code>nmap -sn 192.168.0.1-254</code></mark><mark class="highlight-pink"> </mark>or <mark class="highlight-pink"><code>nmap -sn 192.168.0.0/24</code></mark><mark class="highlight-pink"> </mark>The <mark class="highlight-pink"><code>-sn</code></mark> tells Nmap not to scan any ports, forcing it to rely primarily on ICMP echo packets (or ARP requests on a local network, if run with sudo or directly as the root user) to identify targets. In addition to the ICMP echo requests, the <mark class="highlight-pink"><code>-sn</code></mark> switch will also cause nmap to send a TCP SYN packet to port 443 of the target, as well as a TCP ACK (or TCP SYN if not run as root) packet to port 80.</p></details></li></ul><ul id="86b9cdcc-3646-4b44-9bc7-7784e09f9629" class="toggle"><li><details open=""><summary><strong>SE Scripts</strong> Overview</summary><p id="785f9d26-f8fb-4f57-a8a4-1abc75ca1b62" class="">The <strong>N</strong>map <strong>S</strong>cripting <strong>E</strong>ngine (NSE) is an incredibly powerful addition to Nmap, extending its functionality quite considerably. NSE Scripts are written in the <em>Lua </em>programming language: scans for vulnerabilities, automates exploits for them. The NSE is particularly useful for reconnaisance, with extensive categories in the script library:<mark class="highlight-pink"><code>safe</code></mark> Won&#x27;t affect the target <mark class="highlight-pink"><code>intrusive</code></mark><mark class="highlight-pink"> </mark>Not safe; likely to affect the target <code><mark class="highlight-pink">vuln</mark></code><mark class="highlight-pink"> </mark>Scan for vulnerabilities <mark class="highlight-pink"><code>exploit</code></mark> Attempt to exploit a vulnerability <mark class="highlight-pink"><code>auth</code></mark> Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously) <mark class="highlight-pink"><code>brute</code></mark> Attempt to bruteforce credentials for running services <mark class="highlight-pink"><code>discovery</code></mark> Attempt to query running services for further information about the network (e.g. query an SNMP server).</p></details></li></ul><ul id="66473a73-7cfd-4fa5-a525-8de55df58274" class="toggle"><li><details open=""><summary><strong>NSE Scripts</strong> Working with the NSE</summary><p id="df1bef33-d110-48d0-8659-147b19d63087" class=""><mark class="highlight-pink"><code>--script</code></mark> activates NSE scripts from the <mark class="highlight-pink"><code>vuln</code></mark> category using <mark class="highlight-pink"><code>--script=vuln</code></mark>. The other categories work the same. If <mark class="highlight-pink"><code>--script=safe</code></mark> is run, any applicable safe scripts will run against the target; only activates scripts that target an active service. To run a specific script, we would use <mark class="highlight-pink"><code>--script=&lt;script-name&gt;</code></mark>, e.g. <mark class="highlight-pink"><code>--script=http-fileupload-exploiter</code></mark>. Multiple scripts can be run simultaneously in this fashion by separating them by a comma. eg, <mark class="highlight-pink"><code>--script=smb-enum-users,smb-enum-shares</code></mark><mark class="highlight-pink">. </mark>Some scripts require arguments; eg, credentials: if they&#x27;re exploiting an authenticated vulnerability. These can be given with <mark class="highlight-pink"><code>--script-args</code></mark>. eg, <mark class="highlight-pink"><code>http-put</code></mark> script (used to upload files using the PUT method): takes two arguments, the URL to upload the file to, and the file&#x27;s location on disk: <code><mark class="highlight-pink">nmap -p 80 --script http-put --script-args http-put.url=&#x27;/dav/shell.php&#x27;,http-put.file=&#x27;./shell.php&#x27; </mark></code>Note that args are separated by commas, and connected to the corresponding script with periods; <mark class="highlight-pink"><code>&lt;script-name&gt;.&lt;argument&gt;</code></mark></p></details></li></ul><ul id="6d64009e-31c2-4471-91d7-7597289fde54" class="toggle"><li><details open=""><summary><strong>NSE Scripts</strong> Searching for Scripts</summary><div id="b0df9164-11ca-4e6d-898d-3dc1e0390125" class="column-list"><div id="136b23a3-961f-4f52-9439-d89f40e527c0" style="width:87.5%" class="column"><p id="8313fea3-f3b8-4eb6-af92-3e738eb82c8e" class="">Two options to find Nmap scripts which should ideally be used in conjunction with each other: The first is the page on the <a href="https://nmap.org/nsedoc/">Nmap website</a> containing a list of all official scripts. The second is the local storage on your attacking machine. Nmap stores its scripts on Linux at <code><mark class="highlight-pink">/usr/share/nmap/scripts</mark></code><mark class="highlight-pink">. </mark>All NSE scripts are stored in this directory by default; this is where Nmap looks for scripts when you specify them. Two ways to search for installed scripts: One is by using the <code><mark class="highlight-pink">/scripts/script.db</mark></code><mark class="highlight-pink"> </mark>file. Despite the extension, this isn&#x27;t actually a database so much as a formatted text file containing filenames and categories for each available script. Nmap uses this file to keep track of and utilize scripts for the scripting engine; however, we can also <em>grep </em>through it to look for scripts. eg, <mark class="highlight-pink"><code>grep &quot;ftp&quot; /usr/share/nmap/scripts/script.db</code></mark>.</p><p id="594b03b0-14dc-4eef-be85-1931519488db" class="">The second way to search for scripts is to use the <mark class="highlight-pink"><code>ls</code></mark> command. eg, we could get the same results as in the previous screenshot by using <mark class="highlight-pink"><code>ls -l /usr/share/nmap/scripts/*ftp*</code></mark>: Note the use of asterisks (<mark class="highlight-pink"><code>*</code></mark>) on either side of the search term. The same techniques can also be used to search for categories of script. eg,<mark class="highlight-pink"><code>grep &quot;safe&quot; /usr/share/nmap/scripts/script.db</code></mark></p></div><div id="91bc7acc-eb76-4c4b-aa22-93c15ad199af" style="width:93.74999999999999%" class="column"><figure id="4c3eb7e3-c228-4260-b102-9ba1aff06048" class="image"><a href="https://i.imgur.com/aJdVSAP.png"><img src="https://i.imgur.com/aJdVSAP.png"/></a></figure><figure id="bc920978-9b2f-4579-a8c5-a0d06dbce1ab" class="image"><a href="https://i.imgur.com/ijAhZsy.png"><img src="https://i.imgur.com/ijAhZsy.png"/></a></figure><figure id="f6daeb04-24dd-45f5-a476-8ceefe609e7a" class="image"><a href="https://i.imgur.com/7GV9Wzi.png"><img src="https://i.imgur.com/7GV9Wzi.png"/></a></figure><figure id="83a84474-1802-46c7-9fc5-77962f97f82d" class="image"><a href="https://i.imgur.com/352GgTj.png"><img src="https://i.imgur.com/352GgTj.png"/></a></figure></div></div><p id="53a9bd75-ed51-44f3-ac40-51c97490adfc" class=""><strong><span style="border-bottom:0.05em solid">Installing New Scripts</span></strong></p><p id="283db68d-533f-4962-94cf-b1d8b8e09800" class="">If a script is missing in the <mark class="highlight-pink"><code>scripts</code></mark> dir locally: a standard <mark class="highlight-pink"><code>sudo apt update &amp;&amp; sudo apt install nmap</code></mark> should fix this; however, it&#x27;s possible to install the scripts manually by downloading the script from Nmap <mark class="highlight-pink"><code>sudo wget -O /usr/share/nmap/scripts/&lt;script-name&gt;.nse https://svn.nmap.org/nmap/scripts/&lt;script-name&gt;.nse</code></mark>. Followed by <mark class="highlight-pink"><code>nmap --script-updatedb</code></mark>, which updates the <mark class="highlight-pink"><code>script.db</code></mark> file to contain the newly downloaded script. Note that you would require the same &quot;updatedb&quot; command if you were to make your own NSE script and add it into Nmap; a more than manageable task with some basic knowledge of Lua.</p></details></li></ul><ul id="0146b156-d527-422e-a7a3-9be6104b276d" class="toggle"><li><details open=""><summary><strong>Firewall Evasion</strong></summary><p id="89c7f512-b381-4cd6-9dd7-f3378afb699c" class="">Another common firewall configuration that is imperative to know how to bypass: A typical Windows host will, with its default firewall, block all ICMP packets. Ping is often used to manually establish the activity of a target and Nmap does the same by default, meaning Nmap registers a host with this firewall configuration as dead and does not bother scanning it at all. We need to get around this configuration. Nmap provides <mark class="highlight-pink"><code>-Pn</code></mark>, which tells Nmap to not bother pinging the host before scanning it, meaning Nmap will always treat the target host(s) as alive, effectively bypassing the ICMP block; however, it can potentially take a long time to complete the scan (if the host really is dead then Nmap will still be checking and double checking every specified port). Note: if already directly on the local network, Nmap can also use ARP requests to determine host activity.</p><ul id="0366692a-44b4-4eaf-9b36-0e5e2277dd5b" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>f</code></mark>: fragments packets (split into smaller pieces) making it less likely for the packets to be detected by a firewall or IDS.</li></ul><ul id="d7ec5945-4781-47b2-9e66-57f3e35fbb1a" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>-mtu &lt;number&gt;</code></mark>: Alternative to <mark class="highlight-pink"><code>f</code></mark>, provides more control over size of packets, accepts a maximum transmission unit size to use for the packets sent, which <em>must</em> be a multiple of 8.</li></ul><ul id="5e832f7d-a339-4cf3-8f40-64747b4543e7" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>-scan-delay &lt;time&gt;ms</code></mark>: adds a delay between packets sent, useful when network is unstable and for evading any time-based firewall/IDS triggers in place.</li></ul><ul id="6dad8e80-7118-4955-a25c-ea523f782b35" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-pink"><code>-badsum</code></mark>: used to generate an invalid checksum for packets; any real TCP/IP stack would drop this packet, but firewalls may potentially respond automatically, without bothering to check the checksum of the packet; this switch can determine the presence of a firewall/IDS.</li></ul></details></li></ul><h3 id="22b5acf5-c637-4368-a04a-05fec7fdb564" class="block-color-purple_background"><mark class="highlight-purple_background"><strong><strong>Extending Your Network</strong></strong></mark></h3><ul id="d0375061-5743-4189-8adc-33458287e34b" class="toggle"><li><details open=""><summary><strong>Introduction to Port Forwarding</strong></summary><div id="efbd6003-817f-4459-906b-0e14f834b867" class="column-list"><div id="1427ead8-47c0-4e46-9aac-da930c05595f" style="width:87.5%" class="column"><p id="e67882f0-b29b-49f2-87e9-636058302eed" class="">Port forwarding is essential in connecting applications and services to the Internet. Without port forwarding, applications and services are only available to devices within the same direct network. Within this network, the server with an IP address of &quot;192.168.1.10&quot; runs a web server on port 80. Only the two other computers on this network will be able to access it (intranet). If the administrator wanted the website to be accessible to the public using the Internet, they would have to implement port forwarding:</p><figure id="9b6bd633-8d12-4a2e-8598-c89b4f2999b2" class="image"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding.png"/></a></figure></div><div id="b4148775-c880-40fd-8502-678e1eb832bb" style="width:56.25%" class="column"><figure id="1cc4c1d9-08c2-404a-9705-da5e73f76416" class="image" style="text-align:right"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding-int.png"><img style="width:240px" src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/portforwarding-int.png"/></a></figure><p id="6aa440cb-31ea-426e-9f9c-ae9173653cb3" class="">Network #2 can access the webserver running on Network #1 using the public IP address of Network #1 (82.62.51.70). Port forwarding opens specific ports. Firewalls determine if traffic can travel across these ports even if these ports are open by port forwarding. Port forwarding is configured at the router of a network.</p></div></div></details></li></ul><ul id="c06e32ae-d6e4-4524-9fba-0255616bb882" class="toggle"><li><details open=""><summary><strong>Firewalls 101</strong></summary><p id="a495b52b-cb2d-4f18-92e9-6c4307fe320d" class="">A firewall is a device within a network responsible for determining what traffic is allowed to enter and exit like border security for a network. An administrator can configure a firewall to <strong>permit</strong> or <strong>deny</strong> traffic from entering or exiting a network based on numerous factors such as: Where the traffic is coming from (has the firewall been told to accept/deny traffic from a specific network?), Where is the traffic going to (has the firewall been told to accept/deny traffic destined for a specific network?), What port is the traffic for (has the firewall been told to accept/deny traffic destined for port 80 only?), What protocol is the traffic using (has the firewall been told to accept/deny traffic that is UDP, TCP or both?)</p><p id="7524f6e9-172c-4478-a011-320e4e4adcd5" class="">Firewalls perform packet inspection to determine the answers to these questions. Firewalls come in all shapes and sizes. From dedicated pieces of hardware often found in large networks like businesses that can handle a magnitude of data to residential routers or software, firewalls can be categorized into 2 to 5 categories. Two primary categories of firewalls in the table below:</p><p id="00b8e0e2-89f4-40e3-b983-040e9ccd0625" class=""><span style="border-bottom:0.05em solid">Stateful</span>: uses the entire information from a connection; rather than inspecting an individual packet, it determines the behavior of a device based on the entire connection; it consumes many resources compared to stateless firewalls as the decision-making is dynamic. eg, a firewall could allow the first parts of a TCP handshake that would later fail. If a connection from a host is bad, it will block the entire device.</p><p id="a5156688-b295-41d2-b2b2-2c25c74a8d6e" class=""><span style="border-bottom:0.05em solid">Stateless</span>: uses a static set of rules to determine whether or not individual packets<strong> </strong>are acceptable. eg, a device sending a bad packet will not necessarily mean the entire device is blocked. These firewalls use fewer resources than alternatives but are much dumber. eg, these firewalls are only effective as the rules that are defined within them. If a rule is not exactly matched, it is effectively useless. However, these firewalls are great when receiving large amounts of traffic from a set of hosts (such as a Distributed Denial-of-Service attack)</p></details></li></ul><ul id="4b886bd9-2acf-43b7-bf74-f1cd6e66b416" class="toggle"><li><details open=""><summary><strong>VPN Basics</strong></summary><div id="5fc7302b-6104-49dd-9614-c513300d91dd" class="column-list"><div id="b7ba5782-841f-4328-9256-9a48fb2df02a" style="width:87.5%" class="column"><p id="f1aeaeb4-0e02-4841-b0de-7bbda372b00c" class="">A <strong>V</strong>irtual <strong>P</strong>rivate <strong>N</strong>etwork (<strong>VPN</strong>) is a technology that allows devices on separate networks to communicate securely by creating a dedicated path between each other over the Internet (tunnel). Devices connected in this tunnel form their own private network. eg, only devices within the same network (such as within a business) can directly communicate. However, a VPN allows two offices to be connected. Let&#x27;s take the diagram below, where there are three networks: Network #1 (Office #1); Network #2 (Office #2); Network #3 (Two devices connected via a VPN); The devices connected on Network #3 are still a part of Network #1 and Network #2 but also form together to create a private network, Network #3, that only devices that are connected via this VPN can communicate over.</p></div><div id="f3181306-2361-4299-99a5-386e620613b9" style="width:112.5%" class="column"><figure id="81cf4a9c-16ff-417c-9daa-71b584f8166b" class="image"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vpn1.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vpn1.png"/></a></figure><p id="ddc31f0c-b425-43c4-a84b-f721511c5bdd" class="">
</p></div></div><p id="448847b5-89c1-478f-aa0d-fe7b7e5cd638" class="">Other benefits: Allows networks in different geographical locations to be connected. eg. a business with multiple offices be benefitted by having access to resources like servers/infrastructure from another office. Offers privacy - VPNs use encryption to protect data meaning it can only be understood between devices it was being sent from and is destined for. Offers anonymity - Journalists and activists depend upon VPNs to safely report on global issues in countries where freedom of speech is controlled. Usually, your traffic can be viewed by your ISP and other intermediaries and can be tracked. The level of anonymity a VPN provides is only as much as how other devices on the network respect privacy. eg, a VPN that logs all of your data/history is essentially the same as not using a VPN in this regard.</p><p id="2a162827-817a-46b6-8d2d-4a258781e437" class="">Existing VPN technologies: <strong>PPP</strong> - used by PPTP to allow authentication and provide encryption of data. VPNs work by using a private key and public certificate like <strong>SSH</strong>. The key &amp; certificate must match for you to connect. This technology is not capable of leaving a network by itself (non-routable). <strong>PPTP</strong> - <strong>P</strong>oint-to-<strong>P</strong>oint <strong>T</strong>unneling <strong>P</strong>rotocol allows data from PPP to travel and leave a network. PPTP is very easy to set up and is supported by most devices, but it is weakly encrypted. <strong>IPSec - </strong>Internet Protocol Security encrypts data using the existing <strong>I</strong>nternet <strong>P</strong>rotocol (<strong>IP</strong>) framework. IPSec is difficult to set up, but if successful, it jas strong encryption and is supported on many devices.</p></details></li></ul><ul id="b6e5b7aa-2575-466e-b739-effcf6d20685" class="toggle"><li><details open=""><summary><strong>LAN Networking Devices</strong></summary><div id="4bdab86d-ee8f-465a-85a0-87d04bcc044b" class="column-list"><div id="4fdece1e-a000-46e9-966c-169d23e4a450" style="width:81.25%" class="column"><p id="eea06b7c-3f37-438b-9ee5-3080dc8819fb" class=""><span style="border-bottom:0.05em solid"><strong>What is a Router?</strong></span><strong> - </strong>A router connects networks and passes data between them using routing. Routing is the label given to the process of data traveling across networks. It involves creating a path between networks so data can be successfully delivered. Routers operate at Layer 3 of the OSI model and often feature an interactive interface like a website or console that allows an administrator to configure various rules such as port forwarding or firewalling. Routing is useful when devices are connected by many paths, like in the diagram, where the most optimal path is taken: Routers are dedicated devices and do not perform the same functions as switches.</p></div><div id="f945efc3-4bb5-4aeb-be1e-49997a6588d3" style="width:106.25%" class="column"><figure id="58465da3-607e-4e15-a30c-da1025df5302" class="image"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/intro-to-networking/what-is-the-internet/routing2.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/intro-to-networking/what-is-the-internet/routing2.png"/></a></figure><p id="8d5e8655-0f70-4841-8975-05bd4fdc1ef8" class="">Computer A&#x27;s network is connected to Computer B’s network by two routers in the middle. The question is: what path will be taken? Different protocols will decide what path should be taken, but factors include: which is the shortest? which is the most reliable? Which has the faster medium (e.g. copper or fibre)?</p></div></div><div id="49d94ee6-f3c0-4a90-becb-4eeeea7b99bd" class="column-list"><div id="d842c147-2c0a-4098-9828-9a8b93b90c30" style="width:93.75%" class="column"><p id="068805ac-1f02-4b97-95c3-8f1258e9894d" class=""><span style="border-bottom:0.05em solid"><strong>What is a Switch?</strong></span></p><p id="18316afc-7b9b-41f6-a8d5-69dda5771fbd" class="">A switch is a dedicated networking device responsible for providing a means of connecting to multiple devices. Switches can facilitate many devices (from 3 to 63) using Ethernet cables. They can operate at both layer 2 and layer 3 of the OSI model. However, these are exclusive in the sense that Layer 2 switches cannot operate at Layer 3. eg, Layer 2 switch in the diagram below: These switches will forward frames, these are no longer packets as the IP protocol has been stripped, onto the connected devices using their MAC address. These switches are solely responsible for sending frames to the correct device.</p><p id="ae982cd0-0756-4f0e-8141-936c5188d58e" class="">Layer 3 switches are more sophisticated than layer 2, as they can perform some responsibilities of a router. These switches will send frames to devices like layer 2 and route packets to other devices using the IP protocol.</p><p id="800aa467-08dd-4e0f-903b-168dce0f03db" class="">The diagram of a layer 3 switch in action has two IP addresses: 192.168.1.1, 192.168.2.1</p><p id="cd9217d4-d228-4189-8911-6532178a4a5a" class="">A technology called <strong>VLAN</strong> (<strong>V</strong>irtual <strong>L</strong>ocal <strong>A</strong>rea <strong>N</strong>etwork) allows specific devices within a network to be virtually split up. This split means they can all benefit from things such as an Internet connection but are treated separately. This network separation provides security because it means the rules in place determine how specific devices communicate with each other.</p><p id="fe181db2-bd34-41ae-852a-43fcb22f3244" class="">The &quot;Sales Department&quot; and &quot;Accounting Department&quot; will be able to access the Internet, but not able to communicate with each other (although they are connected to the same switch).</p></div><div id="c0f3b56f-d1d6-4c1e-90a0-05240ad9fb00" style="width:43.74999999999999%" class="column"><figure id="12da7f06-6a62-458e-8a25-5c36155fc4c4" class="image" style="text-align:right"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/layer2switch.png"><img style="width:240px" src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/layer2switch.png"/></a></figure><figure id="a30f35b8-6a71-479c-b3cd-093abd09eedf" class="image" style="text-align:right"><a href="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vlans.png"><img src="https://assets.tryhackme.com/additional/networking-fundamentals/extending-your-network/vlans.png"/></a></figure></div></div></details></li></ul><h3 id="9e5ce8f3-53c3-4b16-a2d8-f26ea52e8c0d" class="block-color-purple_background"><strong>Web Enumeration</strong></h3><p id="581f194c-c997-42b9-b830-a4aafbc6e6a2" class=""><strong>1. Introduction to Gobuster</strong><div class="indented"><div id="835b356b-e3fd-47d7-8e6d-8b1a85619392" class="column-list"><div id="11d9ceaf-235a-42d7-bcb9-dd35106215e2" style="width:50%" class="column"><p id="4a69f58a-e364-4b86-9e2d-228fa5828ddc" class="">Gobuster is written in <a href="https://golang.org/">Go</a>, an open-source, low-level language developed by a team at Google and other contributors. </p><p id="27d6d19a-a104-4949-b426-d1789b24cab4" class="">Change the number of threads to 64 to increase scan speeds else Gobuster can be a little slow.</p></div><div id="e6805262-5593-4ce4-a810-016ef385b9d6" style="width:118.75%" class="column"><table id="dad2dba8-cd5d-48a3-9cb1-c1eee04c0d83" class="simple-table"><tbody><tr id="680037e7-28a4-4bcb-a7b1-782273092675"><td id="Gse`" class="" style="width:55px"><mark class="highlight-pink"><strong>Flag</strong></mark></td><td id="lqH_" class=""><mark class="highlight-pink"><strong>Long Flag</strong></mark></td><td id="bd^q" class="" style="width:311px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="ed3de388-ff35-40b3-8004-7b140a446dea"><td id="Gse`" class="" style="width:55px">-t</td><td id="lqH_" class="">--threads</td><td id="bd^q" class="" style="width:311px">Number of concurrent threads (default 10)</td></tr><tr id="6059741e-242e-4a7c-a33d-6548476242ce"><td id="Gse`" class="" style="width:55px">-v</td><td id="lqH_" class="">--verbose</td><td id="bd^q" class="" style="width:311px">Verbose output</td></tr><tr id="ebad9a1a-30f1-4702-9279-cea36048c429"><td id="Gse`" class="" style="width:55px">-z</td><td id="lqH_" class="">--no-progress</td><td id="bd^q" class="" style="width:311px">Don&#x27;t display progress</td></tr><tr id="6030ee0f-e2b4-4d9d-9b92-d89d814c9992"><td id="Gse`" class="" style="width:55px">-q</td><td id="lqH_" class="">--quiet</td><td id="bd^q" class="" style="width:311px">Don&#x27;t print the banner and other noise</td></tr><tr id="18c9528b-80db-4bf3-b837-6644dfa31fac"><td id="Gse`" class="" style="width:55px">-o</td><td id="lqH_" class="">--output</td><td id="bd^q" class="" style="width:311px">Output file to write results to</td></tr></tbody></table></div></div></div></p><ul id="1c3f4913-c7b6-4c15-9f45-7202bdb50d5e" class="toggle"><li><details open=""><summary><strong>1.1. Gobuster Modes</strong></summary><p id="fb55050d-be16-4eca-ab66-c8e71852fe4f" class="">Dirbuster has a <strong>dir mode</strong> allowing users to enumerate website directories, useful for penetration tests to see website directory structures. Often, directory structures of websites and web apps follow a certain convention, making them susceptible to bruteforcing using wordlists. <span style="border-bottom:0.05em solid"><strong>Gobuster </strong></span>allows you to scan websites and returns status codes which immediately lets outside users know if they can request the directory or not. Additional functionality of Gobuster is that it lets you search for files with the addition of a simple flag. To use &quot;dir&quot; mode, use <mark class="highlight-pink"><code>gobuster dir</code></mark><mark class="highlight-pink"> </mark>which tells Gobuster to perform a directory search. It has to be written like this else Gobuster will complain. After that, add the URL and wordlist using the <mark class="highlight-pink"><span style="border-bottom:0.05em solid"><code>-u</code></span></mark> and <mark class="highlight-pink"><code>-w</code></mark>: <mark class="highlight-pink"><code>gobuster dir -u http://10.10.10.10 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></mark></p><p id="18beae80-48a6-4faf-8859-eef27756056c" class="">Note: The URL is going to be the base path where Gobuster starts looking from. So the URL uses the root web directory. eg, in a Linux Apache installation, this is<em> /var/www/html</em>. If you have a &quot;<strong>products</strong>&quot; directory and you want to enumerate that directory, you&#x27;d set the URL as <em>http://10.10.10.10/</em><em><strong>products</strong></em>. Or think like <em>http://example.com/path/to/folder</em>. Notice I specified the protocol of HTTP. This is important and required. This is a very common, simple, and straightforward command for Gobuster.</p><div id="003a65be-6d69-42b7-8712-dc1d3a330620" class="column-list"><div id="befd7c27-048f-4dd5-95f5-41d2d3c879ab" style="width:56.25%" class="column"><table id="ec151b5d-68d0-4c95-a919-12dedc6ba7d4" class="simple-table"><tbody><tr id="357ba9c6-63ca-4054-9d18-48e7689947af"><td id="YG`&lt;" class="" style="width:53px"><mark class="highlight-pink"><strong>Flag</strong></mark></td><td id="_JHq" class="" style="width:139.28125px"><mark class="highlight-pink"><strong>Long Flag</strong></mark></td><td id="}ajE" class="" style="width:264.96875px"><mark class="highlight-pink"><strong>Description</strong></mark></td></tr><tr id="8a3461e8-176c-441c-b650-d706455e6e6f"><td id="YG`&lt;" class="" style="width:53px">-c</td><td id="_JHq" class="" style="width:139.28125px">--cookies</td><td id="}ajE" class="" style="width:264.96875px">Cookies to use for requests</td></tr><tr id="b32c9596-75ba-456b-b131-c872b62e69b7"><td id="YG`&lt;" class="" style="width:53px">-x</td><td id="_JHq" class="" style="width:139.28125px">--extensions</td><td id="}ajE" class="" style="width:264.96875px">File extension(s) to search for</td></tr><tr id="bcf3ea72-d865-4109-9c8a-92f0d13e5eb4"><td id="YG`&lt;" class="" style="width:53px">-H</td><td id="_JHq" class="" style="width:139.28125px">--headers</td><td id="}ajE" class="" style="width:264.96875px">Specify HTTP headers, -H &#x27;Header1: val1&#x27; -H &#x27;Header2: val2&#x27;</td></tr><tr id="3f71b30e-130b-41b1-930f-c1732913af59"><td id="YG`&lt;" class="" style="width:53px">-k</td><td id="_JHq" class="" style="width:139.28125px">--no-tls-validation</td><td id="}ajE" class="" style="width:264.96875px">Skip TLS certificate verification</td></tr><tr id="6156af20-c855-47f9-8a33-821aea3db8d8"><td id="YG`&lt;" class="" style="width:53px">-n</td><td id="_JHq" class="" style="width:139.28125px">--no-status</td><td id="}ajE" class="" style="width:264.96875px">Don&#x27;t print status codes</td></tr><tr id="e77d68d2-7e88-437c-a8fb-5263091335fb"><td id="YG`&lt;" class="" style="width:53px">-P</td><td id="_JHq" class="" style="width:139.28125px">--password</td><td id="}ajE" class="" style="width:264.96875px">Password for Basic Auth</td></tr><tr id="c56c6810-86bc-41b8-bf30-6dafa25a610b"><td id="YG`&lt;" class="" style="width:53px">-s</td><td id="_JHq" class="" style="width:139.28125px">--status-codes</td><td id="}ajE" class="" style="width:264.96875px">Positive status codes</td></tr><tr id="e84f014a-8244-4a3a-b6ec-799e84277225"><td id="YG`&lt;" class="" style="width:53px">-b</td><td id="_JHq" class="" style="width:139.28125px">--status-codes-blacklist</td><td id="}ajE" class="" style="width:264.96875px">Negative status codes</td></tr><tr id="96ca0dc5-5a76-4611-8257-9f2f0993fc17"><td id="YG`&lt;" class="" style="width:53px">-U</td><td id="_JHq" class="" style="width:139.28125px">--username</td><td id="}ajE" class="" style="width:264.96875px">Username for Basic Auth</td></tr></tbody></table></div><div id="fd2b1c62-5c3f-432c-aea2-83876ee641e9" style="width:43.75%" class="column"><p id="3cacd352-fc6d-4ac8-9802-442b73684527" class=""><mark class="highlight-pink"><code>-x</code></mark> or <mark class="highlight-pink"><code>--extensions</code></mark> is commonly used to search for the contents of directories that you have already enumerated by providing a list of file extensions. File extensions are generally representative of the data they may contain. eg, <strong>.conf</strong> or <strong>.config</strong> files usually contain configurations for the application, including sensitive info such as database credentials. Other files to search for are .txt files or other web application pages like <strong>.html</strong> or <strong>.php</strong>. To search the &quot;myfolder&quot; directory on a webserver for the following three files: html, js, CSS: <mark class="highlight-pink"><code>gobuster dir -u http://10.10.252.123/myfolder -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x.html,.css,.js</code></mark></p></div></div><div id="de28d9fc-3980-4da3-8a17-4471e5a78df8" class="column-list"><div id="6529e13c-193d-4edb-8374-0bfa4f217c8c" style="width:112.5%" class="column"><p id="01f2c05f-abf5-43e2-a9be-4c42d62bbf06" class=""><mark class="highlight-pink"><code>-k</code></mark> is special and important during penetration tests and capture the flag events. If HTTPS is enabled, you will most likely encounter an invalid cert error. In instances like this, if you try to run Gobuster against this without <mark class="highlight-pink"><code>-k</code></mark>, it won&#x27;t return anything and will most likely error out with something gross and will leave you sad. Just add <code><mark class="highlight-pink">-k</mark></code><mark class="highlight-pink"> </mark>to your scan and it will bypass this invalid certification and continue scanning. Note: This flag can be used with &quot;dir&quot; mode and &quot;vhost&quot; modes</p></div><div id="eab916cb-c085-43f0-86e7-00a9e4769228" style="width:87.5%" class="column"><figure id="c67c67ca-eb5b-4e3c-812c-a6f13484191b" class="image" style="text-align:right"><a href="https://comodosslstore.com/resources/wp-content/uploads/2018/08/NET-ERR_CERT_DATE_INVALID.png"><img style="width:336px" src="https://comodosslstore.com/resources/wp-content/uploads/2018/08/NET-ERR_CERT_DATE_INVALID.png"/></a></figure></div></div><p id="ace54c53-1d40-4ef9-bae3-43e8c82064b6" class=""><span style="border-bottom:0.05em solid"><strong>dns Mode </strong></span>- allows Gobuster to brute-force subdomains. During a penetration test, it&#x27;s important to check the sub-domains of your target&#x27;s top domain. Just because something is patched in the regular domain, does not mean it is patched in the sub-domain. There may be a vulnerability for you to exploit in one of these sub-domains. eg, if State Farm owns statefarm.com and mobile.statefarm.com, there may be a hole in mobile.statefarm.com that is not present in statefarm.com. To use &quot;dns&quot; mode, use <mark class="highlight-pink"><code>gobuster dns</code></mark>. which tells Gobuster to perform a sub-domain brute force, it has to be written like this or else Gobuster will complain. After that, add the domain and wordlist using <code><mark class="highlight-pink">-d</mark></code> and <mark class="highlight-pink">-w</mark>:<mark class="highlight-pink"><code>gobuster dns -d mydomain.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></mark><mark class="highlight-pink"> </mark>This tells Gobuster to do a sub-domain scan on the domain &quot;mydomain.thm&quot;. If there are any sub-domains available, Gobuster will find them and report them to you in the terminal.</p><table id="75c73707-7843-46c3-af9f-699610f2d476" class="simple-table"><tbody><tr id="d72871b4-f9c5-44ea-8e35-15d0a1aa9979"><td id="oC&gt;g" class="" style="width:50px"><strong><mark class="highlight-pink">Flag</mark></strong></td><td id="XKmf" class="" style="width:117px"><strong><mark class="highlight-pink">Long Flag</mark></strong></td><td id="x;^n" class="" style="width:395px"><strong><mark class="highlight-pink">Description</mark></strong></td></tr><tr id="bba02ca3-dd3a-4eca-90ca-ae9f0ca290d5"><td id="oC&gt;g" class="" style="width:50px">-c</td><td id="XKmf" class="" style="width:117px">--show-cname</td><td id="x;^n" class="" style="width:395px">Show CNAME Records (cannot be used with &#x27;-i&#x27; option)</td></tr><tr id="7dd99149-1c5c-432f-820c-01a156e8f238"><td id="oC&gt;g" class="" style="width:50px">-i</td><td id="XKmf" class="" style="width:117px">--show-ips</td><td id="x;^n" class="" style="width:395px">Show IP Addresses</td></tr><tr id="d96135a4-3c4d-48ee-ad15-6baf3fca646a"><td id="oC&gt;g" class="" style="width:50px">-r</td><td id="XKmf" class="" style="width:117px">--resolver</td><td id="x;^n" class="" style="width:395px">Use custom DNS server (format server.com or server.com:port)</td></tr></tbody></table><p id="f11ddecb-81e1-4dbc-ad4c-821f282455ae" class=""><strong>vhost mode</strong> - allows Gobuster to brute-force virtual hosts. Virtual hosts are different websites on the same machine. In some instances, they can appear to look like sub-domains, but they are IP based and run on the same server. This is not usually apparent to the end-user.It may be worthwhile to just run Gobuster in this mode to see if it comes up with anything. To use &quot;vhost&quot; mode, use <mark class="highlight-pink"><code>gobuster vhost</code></mark> which tells Gobuster that you want to perform a virtual host brute force. It has to be written like this or else Gobuster will complain. After that, add the domain and wordlist using <mark class="highlight-pink"><code>-u</code></mark> and <mark class="highlight-pink"><code>-w</code></mark>: <mark class="highlight-pink"><code>gobuster vhost -u http://example.com -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></mark>This will tell Gobuster to do a virtual host scan <a href="http://example.com/">http://example.com</a> using the selected wordlist.</p></details></li></ul><h3 id="0cfe5c78-2a69-4228-8595-b90c455abac2" class="block-color-purple_background"><strong><strong>John The Ripper</strong></strong></h3><ul id="97b89147-c824-42ff-b921-75ff7f40339c" class="toggle"><li><details open=""><summary><strong>John who?</strong></summary><p id="ae3a0263-fbd8-4b5a-87ee-49efb8944e57" class="">John the Ripper combines a fast cracking speed, with an extraordinary range of compatible hash types. </p><p id="418c32ba-88e6-4a8c-92f5-eca4ad85c24e" class=""><span style="border-bottom:0.05em solid"><strong>What are Hashes? </strong></span>- A hash is a way of taking a piece of data of any length and  representing it in another form that is a fixed length to mask the original value of the data. This is done by running the original data through a hashing algorithm.</p><p id="5a919ec1-837f-44fd-bc27-742b328914dd" class=""><span style="border-bottom:0.05em solid"><strong>What makes Hashes secure?</strong></span> - Hashing algorithms are designed so they only operate one way, meaning a calculated hash cannot be reversed using just the output given. This ties back to a fundamental mathematical problem known as the <a href="https://en.wikipedia.org/wiki/P_versus_NP_problem">P vs NP relationship</a>, which abstractly means the algorithm to hash the value will be &quot;NP&quot; and can be calculated reasonably, but an unhashing algorithm would be &quot;P&quot; and intractable to solve, meaning it cannot be computed in a reasonable time using standard computers.</p><p id="b8b79fb2-1390-4652-b44a-23d9c62351f8" class=""><span style="border-bottom:0.05em solid"><strong>Where John Comes in</strong></span> - If you have the hashed version of a password and you know the hashing algorithm, use the hashing algorithm to hash a large number of words, called a dictionary. Then compare the hashes to the one you&#x27;re trying to crack, to see if any of them match. If they do, you now know what word corresponds to that hash. This process is called a <strong>dictionary attack </strong>and John the Ripper, or John, is a tool to allow you to conduct fast brute-force attacks on a large array of different hash types.</p></details></li></ul><ul id="01680c65-56fd-44e7-9891-fa622e5206ec" class="toggle"><li><details open=""><summary><strong>Cracking Basic Hashes</strong></summary><p id="de6c918d-91f3-4cac-8079-2bcb20d00e38" class=""><span style="border-bottom:0.05em solid"><strong>John Basic Syntax</strong></span> - <mark class="highlight-pink"><code>john [options] [path to file]</code></mark><mark class="highlight-pink"> </mark><code>[path to file]</code> contains the hash you&#x27;re trying to crack</p><p id="21229c17-5a26-496c-b7b2-7105d419a59a" class=""><span style="border-bottom:0.05em solid"><strong>Automatic Cracking</strong></span> - John has built-in features to detect what type of hash it&#x27;s being given, and to select appropriate rules and formats to crack it for you, it can be unreliable,  it can be a good option: <mark class="highlight-pink"><code>john --wordlist=[path to wordlist] [path to file]</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>-wordlist=</code></mark> Specifies using wordlist mode, reading from the file that you supply in the<mark class="highlight-pink"><code>[path to wordlist]</code></mark> </p><p id="74a53c3b-a540-4e85-8242-4a7e6719c006" class=""><span style="border-bottom:0.05em solid"><strong>Identifying Hashes</strong></span> - Sometimes John won&#x27;t automatically recognize and load hashes so use other tools to identify the hash, and then set John to use a specific format: use an online hash identifier like <a href="https://hashes.com/en/tools/hash_identifier">this</a> one, or <a href="https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master">hash-identifier</a>, a Python tool that is easy to use and will tell you what different types of hashes the one you enter is likely to be. To use hash-identifier, you can just pull the python file from gitlab using: <mark class="highlight-pink"><code>wget https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py</code></mark>. Then launch it with <mark class="highlight-pink"><code>python3 hash-id.py</code></mark> and enter the hash you&#x27;re trying to identify.</p><p id="bcb9f292-d60a-450a-8568-929935caa070" class=""><span style="border-bottom:0.05em solid"><strong>Format-Specific Cracking</strong></span> - Once you have identified the hash that you&#x27;re dealing with, tell john to use it while cracking the provided hash: <mark class="highlight-pink"><code>john --format=[format] --wordlist=[path to wordlist] [path to file]</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>-format=</code></mark> tells John it is a hash of a specific format, and to use <mark class="highlight-pink"><code>[format]</code></mark> to crack it</p><p id="e0dddb0c-c358-4eb4-9c1e-eee079df2619" class=""><span style="border-bottom:0.05em solid"><strong>A Note on Formats:</strong></span> When telling john to use formats, if you&#x27;re dealing with a standard hash type, e.g. md5, prefix it with<mark class="highlight-pink"><code>raw-</code></mark> to tell John it’s just dealing with a standard hash type. To check if you need to add the prefix or not, list all of John&#x27;s formats using <mark class="highlight-pink"><code>john --list=formats</code></mark> and check manually, or grep for your hash type using something like <mark class="highlight-pink"><code>john --list=formats | grep -iF &quot;md5&quot;</code></mark>.</p></details></li></ul><ul id="865bb63a-a7eb-47e8-9eae-09c441971c80" class="toggle"><li><details open=""><summary><strong>Cracking Windows Authentication Hashes</strong></summary><p id="7f4942c4-3bc1-40df-8408-f84e98267ef5" class=""><span style="border-bottom:0.05em solid"><strong>Cracking Windows Hashes - </strong></span>Authentication hashes are the hashed versions of passwords that are stored by operating systems, it is sometimes possible to crack them using the brute-force methods that we&#x27;re using. To get your hands on these hashes, you must often already be a privileged user.</p><p id="09442249-d5b0-41eb-8842-f1f569c9075d" class=""><span style="border-bottom:0.05em solid"><strong>NTHash / NTLM</strong></span> - NThash is the hash format that modern Windows OS machines will store user and service passwords in. It&#x27;s commonly referred to as &quot;NTLM&quot; which references the previous version of Windows format for hashing passwords &quot;LM&quot;, thus &quot;NT/LM&quot;. The NT designation for Windows products originally meant &quot;New Technology&quot;, and was used, starting with <a href="https://en.wikipedia.org/wiki/Windows_NT">Windows NT</a>, to denote products that were not built up from the MS-DOS Operating System. Eventually, the &quot;NT&quot; line became the standard OS type to be released by Microsoft and the name was dropped, but it still used in some Microsoft technologies. To acquire NTHash/NTLM hashes, dump the SAM database on a Windows machine, by using a tool like Mimikatz or from the Active Directory database: NTDS.dit. </p></details></li></ul><ul id="384a970e-b93a-4eb0-999f-0b3bf34890e5" class="toggle"><li><details open=""><summary><strong>Cracking /etc/shadow Hashes</strong></summary><p id="b0c72282-fd3c-45de-a1b0-4f42c52aba6a" class=""><span style="border-bottom:0.05em solid"><strong>Cracking Hashes from /etc/shadow</strong></span> - The /etc/shadow file is where password hashes are stored on linux. It also stores info like the date of last password change and password expiration information. It contains one entry per line for each user or user account of the system. This file is usually only accessible by the root user-.</p><p id="bfce36a1-885b-4b80-bef2-4130cfc648ec" class=""><span style="border-bottom:0.05em solid"><strong>Unshadowing</strong></span> - John can be very particular about the formats it needs data in to be able to work with it, in order to crack /etc/shadow passwords, you must combine it with the /etc/passwd file in order for John to understand the data it&#x27;s being given. Use a tool built in John suite tool called unshadow: <mark class="highlight-pink"><code>unshadow [path to passed] &gt; [path to shadow]</code></mark><mark class="highlight-pink"> </mark><mark class="highlight-pink"><code>[path to passwd]</code></mark> contains the copy of the /etc/passwd file taken from the target machine <mark class="highlight-pink"><code>[path to shadow]</code></mark> contains the copy of the /etc/shadow file taken from the target machine</p><p id="e73d7179-814d-44cf-a75d-821c7d722e7b" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - Feed the output from unshadow; you should not need to specify a mode if the input is made specifically for John; in some cases you will need to specify the format using: <mark class="highlight-pink"><code>--format=sha512crypt</code></mark><mark class="highlight-pink"> eg. </mark><mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt</code></mark></p></details></li></ul><ul id="e541706f-67e7-4cee-bf82-9a80af89feae" class="toggle"><li><details open=""><summary><strong>Single Crack Mode</strong></summary><p id="262efcbb-cc4e-41dc-9c16-84d3e1a9d4a8" class=""><span style="border-bottom:0.05em solid"><strong>Single Crack Mode</strong></span> - John has a mode, called Single Crack mode, where John uses only the information provided in the username to try and work out possible passwords heuristically, by slightly changing the letters and numbers contained within the username.</p><p id="2a7db9d7-5ff1-4ae2-8293-d6ab39443efe" class=""><span style="border-bottom:0.05em solid"><strong>Word Mangling</strong></span> - eg, username: Markus possible passwords: Markus1, MArkus, Markus!, etc. This technique is called word mangling. John is building its own dictionary based on the information that it has been fed and uses a set of &quot;mangling rules&quot; to define how it mutates the word it started with to generate a wordlist based on relevant factors for the target you&#x27;re trying to crack. This exploits how poor passwords can be based off of information about the username, or the service they&#x27;re logging into.</p><p id="2ca494e2-2192-4add-9e6b-712d07afb5f0" class=""><span style="border-bottom:0.05em solid"><strong>GECOS</strong></span> - John&#x27;s implementation of word mangling features compatibility with the Gecos fields of UNIX OSs. In the last task, we looked at entries of both /etc/shadow and /etc/passwd where each field is separated by a colon. Each of the fields these records are split into are called Gecos fields. John can take information stored in records, like full name and home directory name to add to the generated wordlist when cracking hashes with single crack mode.</p><p id="7fb1caf1-6ceb-47a3-96e9-19b5f7d203f8" class="">To use single crack mode: <mark class="highlight-pink"><code>john --single --format=[format] [path to file]</code></mark> <mark class="highlight-pink"><code>single</code></mark> tells john to use single hash cracking mode</p><p id="d04db53a-a8da-4f77-bbda-ef2b9dce0c28" class=""><strong>A Note on File Formats in Single Crack Mode:</strong></p><p id="c25244fc-c2e8-4ac7-8ae1-ae918699c23c" class="">If you&#x27;re cracking hashes in single crack mode, change the file format you&#x27;re feeding John for it to understand what data to create a wordlist from. You do this by prepending the hash with the username that the hash belongs to. <strong>From: </strong>1efee… <strong>To: </strong>mike:1efee…</p></details></li></ul><ul id="cc46126d-d2f2-4c9b-8e8f-defe2e66403a" class="toggle"><li><details open=""><summary><strong>Custom Rules</strong></summary><p id="3450f4d9-8304-4fa8-a74d-92c8361437ab" class="">You may have ideas about what good mangling patterns or patterns your passwords often use that could be replicated with a certain mangling pattern. You can define your own sets of rules for John to dynamically create passwords. </p><p id="9be86ccd-b873-4334-86a5-c69959a07c7a" class=""><span style="border-bottom:0.05em solid"><strong>Common Custom Rules</strong></span> - Many organizations require a certain level of password complexity to try and combat dictionary attacks. This is good, but we can exploit the fact that most users will be predictable in the location of these symbols. A password with the capital letter first, and a number and symbol at the end. The pattern of the familiar password, appended and prepended by modifiers is a memorable pattern people use, and reuse for passwords. This pattern lets us exploit password complexity predictability as an attacker; we know the likely position of added elements and can create dynamic passwords from our wordlists.</p><p id="6b516a36-9a56-42a9-83a5-d0c16c4ea2be" class=""><span style="border-bottom:0.05em solid"><strong>How to create Custom Rules</strong></span> - Custom rules are defined in the <mark class="highlight-pink"><code>john.conf</code></mark> file, usually located in <mark class="highlight-pink"><code>/etc/john/john.conf</code></mark></p><p id="1c2059c8-a485-4343-934c-7cda93f6adbc" class="">Syntax of these custom rules, Note: there is a massive level of granular control to define in these rules</p><p id="800c94d0-210a-465c-8136-21f892c3e1a6" class="">The first line: <mark class="highlight-pink"><code>[List.Rules:THMRules]</code></mark> is used to define the name of your rule and what you will use to call your custom rule as a John argument. Then use a regex pattern match to define where the word will be modified:</p><p id="07106625-bf18-4af5-81a6-4e7ab33ef748" class=""><mark class="highlight-pink"><code>Az</code></mark> - Appends the word with the characters you define</p><p id="be1055cc-0fdd-4445-838b-c7e6cecca474" class=""><mark class="highlight-pink"><code>A0</code></mark> - Prepends the word with the characters you define</p><p id="5511b876-02e9-420d-a36e-4eea4745f04f" class=""><mark class="highlight-pink"><code>c</code></mark> - Capitalizes the character positionally</p><p id="1afc7e6c-6ac3-41d0-abbf-1ad09db1c8e7" class="">Lastly, define what characters to append, prepend, or include by adding character sets in square brackets <mark class="highlight-pink"><code>[ ]</code></mark> in the order they should be used. These directly follow the modifier patterns inside of double quotes <mark class="highlight-pink"><code>&quot; &quot;</code></mark>:</p><p id="9f0d0876-95f6-4731-aa31-2742f4498f8b" class=""><mark class="highlight-pink"><code>[0-9]</code></mark> - Includes numbers 0-9</p><p id="62a66472-9cd6-49b7-8d87-c87d1040266a" class=""><mark class="highlight-pink"><code>[0]</code></mark> - Only includes number 0</p><p id="31e3832c-cf8c-43c1-a55a-4c38fc54a2d3" class=""><mark class="highlight-pink"><code>[A-z]</code></mark> - Includes both upper and lowercase</p><p id="d32143b6-4b24-4d0f-9c3f-020a9f31a2c2" class=""><mark class="highlight-pink"><code>[A-Z]</code></mark> - Only includes uppercase letters</p><p id="7bc30601-ea9e-4045-b0ab-dc7c2accf866" class=""><mark class="highlight-pink"><code>[a-z]</code></mark> - Only includes lowercase letters</p><p id="7ea6d9c1-2bcd-4ff3-b4f1-7f19b1d8e25f" class=""><mark class="highlight-pink"><code>[a]</code></mark> - Only includes a</p><p id="0233b126-fe11-4061-9482-3ef210a3d293" class=""><mark class="highlight-pink"><code>[!£$%@]</code></mark> - Includes the symbols !£$%@</p><p id="455cc03f-4890-41a2-b02a-d528b84b355c" class="">To generate a wordlist for the example password &quot;Polopassword1!&quot; (assuming it was in our wordlist):<mark class="highlight-pink"><code>[List.Rules:PoloPassword]</code></mark> <mark class="highlight-pink"><code>cAz&quot;[0-9] [!£$%@]&quot;</code></mark></p><p id="0e620de6-6eea-4a38-b839-1116b5fe8c55" class=""><span style="border-bottom:0.05em solid"><strong>To use Custom Rules</strong></span> - call the custom rule as a John argument using <mark class="highlight-pink"><code>--rule=PoloPassword</code></mark>  <mark class="highlight-pink"><code>john --wordlist=[path to wordlist] --rule=PoloPassword [path to file]</code></mark></p></details></li></ul><ul id="9c1787d1-760f-4d82-8323-045cc5306e31" class="toggle"><li><details open=""><summary><strong>Cracking Password-Protected Zip Files, RAR Archives, and SSH Keys with John</strong></summary><p id="1252b9c2-f0d2-418c-baba-027a80bf756f" class="">John can crack passwords on password-protected <strong>ZIP</strong> files using a separate part of the John suite of tools to convert the zip file into a format that John understands.</p><p id="add583b7-86e7-4c98-bbbf-a90c4891efc6" class=""><span style="border-bottom:0.05em solid"><strong>Zip2John</strong></span> - converts zip files into a hash format that John can understand, and hopefully crack: <mark class="highlight-pink"><code>zip2john [options] [zip file] &gt; [output file]</code></mark> <mark class="highlight-pink"><code>[options]</code></mark> - passes specific checksum options to zip2john</p><p id="08b9768e-ebc9-4d37-9b24-5df5dedef493" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - take the file output from zip2john and feed it to John: <mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt</code></mark></p><p id="414f171b-fc65-4092-b7d0-abe79123ddc7" class="">A similar process obtains passwords for <strong>RAR</strong> archives, which like zip files, are compressed files created by the WinRAR archive manager.</p><p id="12054d6c-ebed-4cb4-b7ee-1da7a4f8dd46" class=""><span style="border-bottom:0.05em solid"><strong>Rar2John</strong></span> - Identical to zip2john, rar2john converts RAR files into a hash format John understands: <mark class="highlight-pink"><code>rar2john [rar file] &gt; [output]</code></mark></p><p id="d268afa3-35d1-40c5-8d85-3ae25109bdc1" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - take the file output from rar2john and feed it to John: <mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt</code></mark></p><p id="b310288f-8e2c-4fee-bdbd-1540b729335e" class=""><strong>SSH</strong> private key password of id_rsa files. Unless configured otherwise, you authenticate your SSH login using a password, but you can configure key-based authentication, which lets you use your private key, id_rsa, as an authentication key to log in to a remote machine over SSH, doing so will often require a password; use John to crack this password to allow authentication over SSH using the key.</p><p id="7229230b-ec8c-483c-bd8c-1aafdef84a66" class=""><span style="border-bottom:0.05em solid"><strong>SSH2John</strong></span> - converts the id_rsa private key that you use to login to the SSH session into a hash format that John can work with: </p><p id="a6ccff3f-6e90-4676-ab96-6873a08e3589" class=""><mark class="highlight-pink"><code>ssh2john [id_rsa private key file] &gt; [output file]</code></mark></p><p id="0df4c9dc-db35-4795-9fd4-66718867c8d9" class=""><span style="border-bottom:0.05em solid"><strong>Cracking</strong></span> - feed the file output from ssh2john to John: <mark class="highlight-pink"><code>john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_hash.txt</code></mark></p></details></li></ul><h3 id="71fbec5a-a585-42dd-b6ae-ae6bcef4c6ba" class="block-color-purple_background"><strong><strong>Crack The Hash Level 2</strong></strong></h3><ul id="f1258ba1-25c4-4089-954b-c1adad368ade" class="toggle"><li><details open=""><summary><strong>Walkthrough</strong> Cracking tools, modes &amp; rules</summary><p id="511f631b-ddd8-4002-a09b-a3f6eb76df46" class=""><span style="border-bottom:0.05em solid"><strong>modes of cracking</strong></span>: <strong>Wordlist mode -</strong> try all words in a dictionary. eg, common passwords, usernames, etc. <strong>Incremental mode</strong> <strong>-</strong> try all possible character combinations as passwords <strong>Rule mode</strong> - use wordlist mode by adding pattern or mangling the string. eg, adding current year, appending a common special character.</p><p id="9aeaebae-c4f8-4779-9d7e-2bc4730b3621" class=""><span style="border-bottom:0.05em solid"><strong>performing a rule based bruteforce</strong></span>:</p><ol type="1" id="f594ac72-3046-4ffe-b016-bf789808414c" class="numbered-list" start="1"><li>Generating a custom wordlist and using the classic wordlist mode with it.</li></ol><ol type="1" id="d1331f00-90e7-42eb-81c4-ffe572207e0d" class="numbered-list" start="2"><li>Using a common wordlist and telling the cracking tool to apply some custom mangling rules on it. - more powerful, wont waste gigabytes by storing tons of wordlists and waste time generating ones you will use only one time</li></ol><p id="c2395208-66dc-4f4b-b61c-4857ed51589a" class=""><strong>Border mutation</strong> - commonly used combinations of digits and special symbols added at the end, beginning, or both</p><p id="ef902d2b-8d95-4e9d-ac5e-38b51273bb65" class=""><strong>Freak mutation</strong> - letters replaced with similar looking special symbols</p><p id="3b14d582-485e-402d-80c8-3784eae913db" class=""><strong>Case mutation</strong> - all variations of uppercase/lowercase letters for any character</p><p id="93bf03d8-683d-4544-bc2a-b35a290b5a2c" class=""><strong>Order mutation</strong> - character order reversed</p><p id="356ef051-ac7d-417a-80e8-e1d979c5dd22" class=""><strong>Repetition mutation</strong> - the same group of characters repeated several times</p><p id="0182cc19-4243-49eb-850d-a0af47c450d6" class=""><strong>Vowels mutation</strong> - vowels omitted or capitalized</p><p id="9ead9ac2-3ced-42f1-9c29-1e5453daf635" class=""><strong>Strip mutation</strong> - one or several characters removed</p><p id="c7952a54-5ed5-4b27-89d4-e71a7bced4e1" class=""><strong>Swap mutation</strong> - some characters swapped and change places</p><p id="ad848cd7-4114-47ff-bae8-6000d1a9cc39" class=""><strong>Duplicate mutation</strong> - some characters duplicated</p><p id="5a164f55-fc67-49eb-9b44-2a215b43e53e" class=""><strong>Delimiter mutation</strong> - delimiters added between characters</p></details></li></ul><h3 id="806fa4a8-d452-4d61-94a2-7b253d5f55dd" class="">Hydra</h3><ul id="91092db7-1c40-43ee-b8e8-291031fcbc99" class="toggle"><li><details open=""><summary><strong>What is Hydra?</strong></summary><p id="65e09cce-5059-4495-85ed-f20cea128a96" class="">Hydra is a brute force online password cracking program, a quick system login password “hacking” tool. Hydra supports/has the ability to brute force the following protocols: “Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, TeamSpeak (TS2), Telnet, VMware-Auth, VNC and XMPP.”</p></details></li></ul><ul id="5fbfea1c-f2ec-426e-aeaa-706ec8346101" class="toggle"><li><details open=""><summary><strong>Hydra Commands</strong></summary><p id="05a5b65f-6f46-4b2e-8bcf-4fa80bc6576d" class="">The options we pass into Hydra depend on which service (protocol) we’re attacking. eg, to brute force FTP with the username being <code>user</code> and a password list being <code>passlist.txt</code>, we’d use the following command:</p><p id="bbf0dc41-d895-46b6-a522-1fad64243d7f" class=""><code>hydra -l user -P passlist.txt ftp://MACHINE_IP</code></p><p id="8d6bee33-0d52-4b1d-a408-4a13c660f6e4" class="">For this deployed machine, here are the commands to use Hydra on SSH and a web form (POST method).</p><h3 id="c9cad488-358d-4e6b-a166-9fac9073e5dc" class=""><strong>SSH</strong></h3><p id="e5a7e076-d562-48d7-90ff-7624746a8b5d" class=""><code>hydra -l &lt;username&gt; -P &lt;full path to pass&gt; MACHINE_IP -t 4 ssh</code></p><table id="6663b27c-5b7a-483e-ad99-b91d3fe95eab" class="simple-table"><tbody><tr id="58ba7e75-9c77-420d-8d1e-d3d0133fb8cf"><td id="Y{^Y" class="">Option</td><td id="cpx}" class="">Description</td></tr><tr id="524d796f-5eaf-4ebb-b90c-3276bc112bbd"><td id="Y{^Y" class=""><code>-l</code></td><td id="cpx}" class="">specifies the (SSH) username for login</td></tr><tr id="bfb352c1-9e28-4a10-a6fd-4d22a8e7bfa0"><td id="Y{^Y" class=""><code>-P</code></td><td id="cpx}" class="">indicates a list of passwords</td></tr><tr id="8f51deeb-74d0-41b7-8577-c275b68e04bf"><td id="Y{^Y" class=""><code>-t</code></td><td id="cpx}" class="">sets the number of threads to spawn</td></tr></tbody></table><p id="b115c5ba-98eb-42ee-b51e-cb26153f3ad3" class="">For example, <code>hydra -l root -P passwords.txt MACHINE_IP -t 4 ssh</code> will run with the following arguments:</p><ul id="ab3854b7-f4fe-4bba-966f-a2cd558ec105" class="bulleted-list"><li style="list-style-type:disc">Hydra will use <code>root</code> as the username for <code>ssh</code></li></ul><ul id="18967c3a-78d7-424b-8d77-ead823c43b1a" class="bulleted-list"><li style="list-style-type:disc">It will try the passwords in the <code>passwords.txt</code> file</li></ul><ul id="ba8654d2-db84-41cc-ac4b-9d9fb69e54fb" class="bulleted-list"><li style="list-style-type:disc">There will be four threads running in parallel as indicated by <code>t 4</code></li></ul><h3 id="4eb95a08-d215-4bf7-9387-6c71662166fd" class=""><strong>Post Web Form</strong></h3><p id="5588ace7-2fc3-42a4-8e2e-1518bee019ff" class="">We can use Hydra to brute force web forms too. You must know which type of request it is making; GET or POST methods are commonly used. You can use your browser’s network tab (in developer tools) to see the request types or view the source code.</p><p id="9195f5ca-5e94-4731-8b65-5599a77f0f9e" class=""><code>sudo hydra &lt;username&gt; &lt;wordlist&gt; MACHINE_IP http-post-form &quot;&lt;path&gt;:&lt;login_credentials&gt;:&lt;invalid_response&gt;&quot;</code></p><table id="7943d09d-4a1c-4e49-85b4-2514517a5b3d" class="simple-table"><tbody><tr id="02e1f826-caaf-4a65-a3a0-a3191ed307fa"><td id="_WCJ" class="">Option</td><td id="eZdS" class="">Description</td></tr><tr id="85ca59de-07b1-43ca-b98c-97a259a6a41b"><td id="_WCJ" class=""><code>-l</code></td><td id="eZdS" class="">the username for (web form) login</td></tr><tr id="0b816359-2522-479f-9c59-cd9e765d9f0f"><td id="_WCJ" class=""><code>-P</code></td><td id="eZdS" class="">the password list to use</td></tr><tr id="dcc99fdf-421e-4861-b3d3-433aca119535"><td id="_WCJ" class=""><code>http-post-form</code></td><td id="eZdS" class="">the type of the form is POST</td></tr><tr id="e5ba064a-05b0-42a0-ba42-1d85d0e2fdf9"><td id="_WCJ" class=""><code>&lt;path&gt;</code></td><td id="eZdS" class="">the login page URL, for example, <code>login.php</code></td></tr><tr id="a35070a5-a5f2-4548-b3b9-7a3e35ee4898"><td id="_WCJ" class=""><code>&lt;login_credentials&gt;</code></td><td id="eZdS" class="">the username and password used to log in, for example, <code>username=^USER^&amp;password=^PASS^</code></td></tr><tr id="86c5b28c-cff9-48a0-823e-0ac5a27715d8"><td id="_WCJ" class=""><code>&lt;invalid_response&gt;</code></td><td id="eZdS" class="">part of the response when the login fails</td></tr><tr id="df190367-a2c3-49ce-a818-2b524e317334"><td id="_WCJ" class=""><code>-V</code></td><td id="eZdS" class="">verbose output for every attempt</td></tr></tbody></table><p id="613dd2e3-f0d9-4ab8-8612-dfad1783e5ab" class="">Below is a more concrete example Hydra command to brute force a POST login form:</p><p id="c562acb4-a20c-4efa-993c-29c826f6f86b" class=""><code>hydra -l &lt;username&gt; -P &lt;wordlist&gt; MACHINE_IP http-post-form &quot;/:username=^USER^&amp;password=^PASS^:F=incorrect&quot; -V</code></p><ul id="d9b338ab-2e89-45d2-b6ad-e575f7d821b5" class="bulleted-list"><li style="list-style-type:disc">The login page is only <code>/</code>, i.e., the main IP address.</li></ul><ul id="77eeb5e5-1357-4085-a6ac-e0137f91ae50" class="bulleted-list"><li style="list-style-type:disc">The <code>username</code> is the form field where the username is entered</li></ul><ul id="168d8274-7228-43da-b555-34c8d72d71ba" class="bulleted-list"><li style="list-style-type:disc">The specified username(s) will replace <code>^USER^</code></li></ul><ul id="38a2a963-6711-4af4-b4c1-c6c3c2c9cd94" class="bulleted-list"><li style="list-style-type:disc">The <code>password</code> is the form field where the password is entered</li></ul><ul id="a456549c-58ad-496a-8756-d520b160d611" class="bulleted-list"><li style="list-style-type:disc">The provided passwords will be replacing <code>^PASS^</code></li></ul><ul id="e806d87a-8ff0-4144-bf6f-f291727ca610" class="bulleted-list"><li style="list-style-type:disc">Finally, <code>F=incorrect</code> is a string that appears in the server reply when the login fails</li></ul><p id="07a35f38-a757-470d-a3b0-93301d69d685" class="">You should now have enough information to put this to practice and brute force your credentials to the deployed machine!</p></details></li></ul><h3 id="dc28b302-4773-416e-8aa8-2ee7b72dcd55" class="block-color-purple_background">Tmux</h3><p id="78e70b07-0537-4e37-bb7c-74b6c240ee0d" class=""><a href="https://imgur.com/bL9Dn3U">https://imgur.com/bL9Dn3</a>U</p><figure id="549ad439-8b64-468b-8370-bde5d9410225" class="image"><a href="Study%20Guide%20d94382859d654e92814777f38b83b894/Untitled.png"><img style="width:384px" src="Study%20Guide%20d94382859d654e92814777f38b83b894/Untitled.png"/></a></figure><h3 id="9d084b19-7f55-420c-885f-c24ff4ec6a76" class="block-color-purple_background"><strong><strong>Linux Privilege Escalation</strong></strong></h3><ul id="25fa5fb5-0143-4ff3-a9d4-49d5e8f3c0d7" class="toggle"><li><details open=""><summary>What does &quot;privilege escalation&quot; mean?</summary><p id="a48c52fd-6ab0-411c-82f8-ffefe38cd1c0" class="">At it&#x27;s core, Privilege Escalation usually involves going from a lower permission account to a higher permission one. More technically, it&#x27;s the exploitation of a vulnerability, design flaw, or configuration oversight in an operating system or application to gain unauthorized access to resources that are usually restricted from the users.</p><p id="f466beba-ddfb-4dca-83c0-374f0c58593b" class="">Why is it important?</p><p id="623028f7-46d6-4303-98e3-325ae27b6e3b" class="">It&#x27;s rare when performing a real-world penetration test to be able to gain a foothold (initial access) that gives you direct administrative access. Privilege escalation is crucial because it lets you gain system administrator levels of access, which allows you to perform actions such as:</p><ul id="37f84310-82b8-44f9-b487-fe7b0f1ae165" class="bulleted-list"><li style="list-style-type:disc">Resetting passwords</li></ul><ul id="f4618768-f88d-4096-a58b-2962f1ad0c8c" class="bulleted-list"><li style="list-style-type:disc">Bypassing access controls to compromise protected data</li></ul><ul id="8283d098-10c8-41fc-8f76-ca761d4bdc60" class="bulleted-list"><li style="list-style-type:disc">Editing software configurations</li></ul><ul id="e89bb62a-5061-4a0b-aca8-a62a6b8ee1a4" class="bulleted-list"><li style="list-style-type:disc">Enabling persistence</li></ul><ul id="b8b88598-d50b-46ff-9ce1-00f0f4af6b75" class="bulleted-list"><li style="list-style-type:disc">Changing the privilege of existing (or new) users</li></ul><ul id="c09bc447-6add-4837-994d-c6675dc40bdf" class="bulleted-list"><li style="list-style-type:disc">Execute any administrative command</li></ul></details></li></ul><ul id="e7c89dee-9138-46bc-a4a4-216df291aa20" class="toggle"><li><details open=""><summary>Enumeration</summary><p id="7407b4d9-84de-4c1c-b638-f8796131299a" class="">Enumeration is the first step you have to take once you gain access to any system. You may have accessed the system by exploiting a critical vulnerability that resulted in root-level access or just found a way to send commands using a low privileged account. Penetration testing engagements, unlike CTF machines, don&#x27;t end once you gain access to a specific system or user privilege level. As you will see, enumeration is as important during the post-compromise phase as it is before.</p><h3 id="ac99949a-9cd3-4e0f-a1a6-bb9bf6e94ce7" class="">hostname</h3><p id="4e8897df-135f-48ff-b73b-3728f425aca3" class="">The <code>hostname</code> command will return the hostname of the target machine. Although this value can easily be changed or have a relatively meaningless string (e.g. Ubuntu-3487340239), in some cases, it can provide information about the target system’s role within the corporate network (e.g. SQL-PROD-01 for a production SQL server).</p><h3 id="7b541877-7f38-4064-bdfb-9b14b2a84a69" class="">uname -a</h3><p id="2ea4af93-a09b-44b6-8e0b-d60ff97ba2ae" class="">Will print system information giving us additional detail about the kernel used by the system. This will be useful when searching for any potential kernel vulnerabilities that could lead to privilege escalation.</p><h3 id="6fa769d3-47e9-407c-8958-07a4acd476ed" class="">/proc/version</h3><p id="62aab1c1-84a2-4462-9fce-3af0b79aacf1" class="">The proc filesystem (procfs) provides information about the target system processes. You will find proc on many different Linux flavours, making it an essential tool to have in your arsenal.</p><p id="6d395163-ffcf-4f2c-ae5e-e40c6839db58" class="">Looking at <code>/proc/version</code> may give you information on the kernel version and additional data such as whether a compiler (e.g. GCC) is installed.</p><h3 id="baa6ec60-520e-4fd7-aa7a-7b63c9a8628d" class="">/etc/issue</h3><p id="2de605c7-9d64-4752-b67a-beef3960dc7f" class="">Systems can also be identified by looking at the <code>/etc/issue</code> file. This file usually contains some information about the operating system but can easily be customized or changed. While on the subject, any file containing system information can be customized or changed. For a clearer understanding of the system, it is always good to look at all of these.</p><h3 id="5b1735dd-03f2-452e-9c26-53a7895be13c" class="">ps Command</h3><p id="7508221c-6cba-476b-b3c7-ec83204adaae" class="">The <code>ps</code> command is an effective way to see the running processes on a Linux system. Typing <code>ps</code> on your terminal will show processes for the current shell.</p><p id="a0ada902-5e0a-4583-adc5-da22899ae4ee" class="">The output of the <code>ps</code> (Process Status) will show the following;</p><ul id="9385648d-11e8-429d-8bc2-34968d016a25" class="bulleted-list"><li style="list-style-type:disc">PID: The process ID (unique to the process)</li></ul><ul id="a3804afe-6267-4546-a711-c5641f53d865" class="bulleted-list"><li style="list-style-type:disc">TTY: Terminal type used by the user</li></ul><ul id="c95c9d5c-54c1-44e2-9bf7-ed10d0d42f62" class="bulleted-list"><li style="list-style-type:disc">Time: Amount of CPU time used by the process (this is NOT the time this process has been running for)</li></ul><ul id="4ac94a83-ed6f-4fd0-8f73-b0cdb1c6e787" class="bulleted-list"><li style="list-style-type:disc">CMD: The command or executable running (will NOT display any command line parameter)</li></ul><p id="00524965-4f1a-4fd9-ab93-3009ceb0b7b1" class="">The “ps” command provides a few useful options.</p><ul id="e60619b9-0a62-492c-9558-46a826e6e697" class="bulleted-list"><li style="list-style-type:disc"><code>ps -A</code>: View all running processes</li></ul><ul id="5248d545-3ce8-4386-80c4-058b0c7aef74" class="bulleted-list"><li style="list-style-type:disc"><code>ps axjf</code>: View process tree (see the tree formation until <code>ps axjf</code> is run below)</li></ul><figure id="5c4f21b1-abe1-4de2-a34c-190e8ef37951" class="image"><a href="https://i.imgur.com/xsbohSd.png"><img style="width:1056px" src="https://i.imgur.com/xsbohSd.png"/></a></figure><ul id="1de08fd8-b511-41d2-9ea1-aa5d082adf1f" class="bulleted-list"><li style="list-style-type:disc"><code>ps aux</code>: The <code>aux</code> option will show processes for all users (a), display the user that launched the process (u), and show processes that are not attached to a terminal (x). Looking at the ps aux command output, we can have a better understanding of the system and potential vulnerabilities.</li></ul><h3 id="a95a4c40-2af0-42d9-a157-cc309ee7e470" class="">env</h3><p id="ea3070e6-90f3-49b3-9897-dd6c898aa173" class="">The <code>env</code> command will show environmental variables.</p><figure id="a7648ec6-a45f-491e-ae9e-8e50c77fb9cd" class="image"><a href="https://i.imgur.com/LWdJ8Fw.png"><img style="width:720px" src="https://i.imgur.com/LWdJ8Fw.png"/></a></figure><p id="b97ca368-cd84-4c77-b257-81f5ff3f3cfb" class="">The PATH variable may have a compiler or a scripting language (e.g. Python) that could be used to run code on the target system or leveraged for privilege escalation.</p><h3 id="b9dda5d5-e5d0-4b3b-b9e7-49735767ea3e" class="">sudo -l</h3><p id="0b7c618c-64ca-432a-bc4f-676abbf4ac9c" class="">The target system may be configured to allow users to run some (or all) commands with root privileges. The <code>sudo -l</code> command can be used to list all commands your user can run using <code>sudo</code>.</p><h1 id="025d63c2-08fb-48b6-902b-3bda5b956f7e" class="">ls</h1><p id="53ddf12d-314b-4745-89af-af266cf805d3" class="">One of the common commands used in Linux is probably <code>ls</code>.</p><p id="a485d2ea-1d3b-4fab-a33b-5133e91c5013" class="">While looking for potential privilege escalation vectors, please remember to always use the <code>ls</code> command with the <code>-la</code> parameter. The example below shows how the “secret.txt” file can easily be missed using the <code>ls</code> or <code>ls -l</code> commands.</p><figure id="6bbbae62-21f4-45af-9370-f8e290993692" class="image"><a href="https://i.imgur.com/2jOtOat.png"><img style="width:480px" src="https://i.imgur.com/2jOtOat.png"/></a></figure><h3 id="b02d2a88-7296-48e9-8c5b-0989d12928e2" class="">Id</h3><p id="b38dd0c1-484f-49bd-9a03-3e3e53342cef" class="">The <code>id</code> command will provide a general overview of the user’s privilege level and group memberships.</p><p id="1c94c539-1617-422d-b7e7-ac51c5ba2150" class="">It is worth remembering that the <code>id</code> command can also be used to obtain the same information for another user as seen below.</p><figure id="23f47dad-ea1b-48b1-b935-0937de462645" class="image"><a href="https://i.imgur.com/YzfJliG.png"><img style="width:1056px" src="https://i.imgur.com/YzfJliG.png"/></a></figure><h3 id="c32d6261-400a-4229-9b7d-5615e4c37a86" class="">/etc/passwd</h3><p id="51e8a190-67cb-40fd-ac96-a79359388047" class="">Reading the <code>/etc/passwd</code> file can be an easy way to discover users on the system.</p><figure id="781dc1d2-14d6-43d6-8e03-7db3aa149348" class="image"><a href="https://i.imgur.com/r6oYOEi.png"><img style="width:528px" src="https://i.imgur.com/r6oYOEi.png"/></a></figure><p id="1dcc1945-0e36-42ee-9875-52dbba842dac" class="">While the output can be long and a bit intimidating, it can easily be cut and converted to a useful list for brute-force attacks.</p><figure id="c86d71f1-f0e1-4f86-a1cc-8206d4a0ede8" class="image"><a href="https://i.imgur.com/cpS2U93.png"><img style="width:528px" src="https://i.imgur.com/cpS2U93.png"/></a></figure><p id="1b2d91b2-cbce-48bd-8a0b-6b6f53a6b849" class="">Remember that this will return all users, some of which are system or service users that would not be very useful. Another approach could be to grep for “home” as real users will most likely have their folders under the “home” directory.</p><figure id="6c1bfa3e-0e5b-4440-a106-e3f386a6fbe3" class="image"><a href="https://i.imgur.com/psxE6V4.png"><img style="width:1056px" src="https://i.imgur.com/psxE6V4.png"/></a></figure><h3 id="2585d821-7e73-48e4-9d7c-79c074550fd0" class="">history</h3><p id="d76c44a8-efae-484f-a593-5b8ade1f1a2c" class="">Looking at earlier commands with the <code>history</code> command can give us some idea about the target system and, albeit rarely, have stored information such as passwords or usernames.</p><h3 id="74838bfb-d363-4cad-ba32-3bd57d8598c3" class="">ifconfig</h3><p id="61f1d2ed-de65-4707-94b1-231cc90fc1f6" class="">The target system may be a pivoting point to another network. The <code>ifconfig</code> command will give us information about the network interfaces of the system. The example below shows the target system has three interfaces (eth0, tun0, and tun1). Our attacking machine can reach the eth0 interface but can not directly access the two other networks.</p><figure id="25e33cb0-9a2f-4481-975f-cb0e42a63c70" class="image"><a href="https://i.imgur.com/hcdZnwK.png"><img style="width:672px" src="https://i.imgur.com/hcdZnwK.png"/></a></figure><p id="d0606cd0-6075-4737-865d-f8bfd1f4fc1c" class="">This can be confirmed using the <code>ip route</code> command to see which network routes exist.</p><figure id="9681ae94-8b24-4b98-bc48-da7bbfdb47af" class="image"><a href="https://i.imgur.com/PSrmz5O.png"><img style="width:1056px" src="https://i.imgur.com/PSrmz5O.png"/></a></figure><h3 id="f48ee417-39f2-409d-925f-72ec966898e8" class="">netstat</h3><p id="0e9e9039-b375-47e6-9708-24049138b7fb" class="">Following an initial check for existing interfaces and network routes, it is worth looking into existing communications. The <code>netstat</code> command can be used with several different options to gather information on existing connections.</p><ul id="63464705-1d60-4d85-b92a-0376bdee2c18" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -a</code>: shows all listening ports and established connections.</li></ul><ul id="1d4d2cbc-8ae3-4425-8a7c-69396e5814c4" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -at</code> or <code>netstat -au</code> can also be used to list TCP or UDP protocols respectively.</li></ul><ul id="d28d97ce-2444-4c47-9bfd-60b0ee109315" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -l</code>: list ports in “listening” mode. These ports are open and ready to accept incoming connections. This can be used with the “t” option to list only ports that are listening using the TCP protocol (below)</li></ul><figure id="17f96b1b-e8e3-47ef-bf5c-b95f62533551" class="image"><a href="https://i.imgur.com/BbLdyrr.png"><img style="width:1056px" src="https://i.imgur.com/BbLdyrr.png"/></a></figure><ul id="8ac1bfbf-3144-488d-a2d5-86e3dc99c2fe" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -s</code>: list network usage statistics by protocol (below) This can also be used with the <code>t</code> or <code>u</code> options to limit the output to a specific protocol.</li></ul><figure id="e7310414-fcb8-474b-8e8a-b69926063f43" class="image"><a href="https://i.imgur.com/mc8OWP0.png"><img style="width:480px" src="https://i.imgur.com/mc8OWP0.png"/></a></figure><ul id="34828429-0fb5-41f8-87e4-ef1dd9b490b2" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -tp</code>: list connections with the service name and PID information.</li></ul><figure id="db62364f-c489-463d-bf3f-5d2c7ec4e565" class="image"><a href="https://i.imgur.com/fDYQwbW.png"><img style="width:1056px" src="https://i.imgur.com/fDYQwbW.png"/></a></figure><p id="5395fcfe-d6fe-4199-8d12-52b16557256d" class="">This can also be used with the <code>-l</code> option to list listening ports (below)</p><figure id="ce94eb9e-6398-486e-bd5f-f412cad3e445" class="image"><a href="https://i.imgur.com/JK7DNv0.png"><img style="width:1056px" src="https://i.imgur.com/JK7DNv0.png"/></a></figure><p id="409991fc-62f1-4e22-8368-be9bfa919880" class="">We can see the “PID/Program name” column is empty as this process is owned by another user.</p><p id="a56a0549-e826-4024-a160-5bc633d28e17" class="">Below is the same command run with root privileges and reveals this information as 2641/nc (netcat)</p><figure id="9b36a118-4394-4fa3-bc73-16fc5f9fa04e" class="image"><a href="https://i.imgur.com/FjZHqlY.png"><img style="width:1056px" src="https://i.imgur.com/FjZHqlY.png"/></a></figure><ul id="4b7959fb-8146-4fa7-b4c2-e0b5f7f2dc85" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -i</code>: Shows interface statistics. We see below that “eth0” and “tun0” are more active than “tun1”.</li></ul><figure id="5560e2e1-07b6-4826-bd17-5cb051aa4023" class="image"><a href="https://i.imgur.com/r6IjpmZ.png"><img style="width:1056px" src="https://i.imgur.com/r6IjpmZ.png"/></a></figure><p id="d4435162-7c4b-4cf7-89f4-7661b8809309" class="">The <code>netstat</code> usage you will probably see most often in blog posts, write-ups, and courses is <code>netstat -ano</code> which could be broken down as follows;</p><ul id="5bc59dd3-4c0b-4fc8-ad58-060a2fb7cb58" class="bulleted-list"><li style="list-style-type:disc"><code>a</code>: Display all sockets</li></ul><ul id="7669239f-94f7-4b0b-b4ce-a07c10fc497a" class="bulleted-list"><li style="list-style-type:disc"><code>n</code>: Do not resolve names</li></ul><ul id="6790976e-88af-4f11-8d5c-5c3f6f196c96" class="bulleted-list"><li style="list-style-type:disc"><code>o</code>: Display timers</li></ul><figure id="80b99a90-f80e-47dd-96c6-5035cf73a810" class="image"><a href="https://i.imgur.com/UxzLBRw.png"><img style="width:1056px" src="https://i.imgur.com/UxzLBRw.png"/></a></figure><h3 id="5fba708d-c27a-4e77-8e96-9e0e6d26d0d5" class=""><strong>find Command</strong></h3><p id="c2b9ca5a-ab88-472d-8a99-3aa88f2e0c9e" class="">Searching the target system for important information and potential privilege escalation vectors can be fruitful. The built-in “find” command is useful and worth keeping in your arsenal.</p><p id="394d00ba-078d-430c-91b4-5154ff22b263" class="">Below are some useful examples for the “find” command.</p><p id="efdca2f3-5365-489f-b704-d02eabb34e36" class=""><strong>Find files:</strong></p><ul id="1bfb80b0-db38-4914-b8ae-d4a1f4b13b52" class="bulleted-list"><li style="list-style-type:disc"><code>find . -name flag1.txt</code>: find the file named “flag1.txt” in the current directory</li></ul><ul id="0bda4009-d1db-4ca6-8559-1a6c1fd4322f" class="bulleted-list"><li style="list-style-type:disc"><code>find /home -name flag1.txt</code>: find the file names “flag1.txt” in the /home directory</li></ul><ul id="04b14c7b-7596-49aa-aa6c-de4605b68320" class="bulleted-list"><li style="list-style-type:disc"><code>find / -type d -name config</code>: find the directory named config under “/”</li></ul><ul id="4b887b44-cdf3-4de8-8a1c-2613a6f9c000" class="bulleted-list"><li style="list-style-type:disc"><code>find / -type f -perm 0777</code>: find files with the 777 permissions (files readable, writable, and executable by all users)</li></ul><ul id="1b4c1dee-dc88-4528-9461-c5d6060035ca" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm a=x</code>: find executable files</li></ul><ul id="3561ccde-dc2f-4752-8130-45c2f3b11abc" class="bulleted-list"><li style="list-style-type:disc"><code>find /home -user frank</code>: find all files for user “frank” under “/home”</li></ul><ul id="300c88b3-5ba9-4401-831b-08b0f1c8b3bc" class="bulleted-list"><li style="list-style-type:disc"><code>find / -mtime 10</code>: find files that were modified in the last 10 days</li></ul><ul id="7295df80-53c2-4449-b99c-c9beaccb4f45" class="bulleted-list"><li style="list-style-type:disc"><code>find / -atime 10</code>: find files that were accessed in the last 10 day</li></ul><ul id="06b6ea48-d096-4251-9008-7c252ea6990a" class="bulleted-list"><li style="list-style-type:disc"><code>find / -cmin -60</code>: find files changed within the last hour (60 minutes)</li></ul><ul id="b2cecd97-1abf-4863-972f-e427efd58013" class="bulleted-list"><li style="list-style-type:disc"><code>find / -amin -60</code>: find files accesses within the last hour (60 minutes)</li></ul><ul id="9e4f695f-d967-468d-b2c3-5958c94d2bff" class="bulleted-list"><li style="list-style-type:disc"><code>find / -size 50M</code>: find files with a 50 MB size</li></ul><p id="8ee2f392-aedc-4b3e-88f2-e8ad66584978" class="">This command can also be used with (+) and (-) signs to specify a file that is larger or smaller than the given size.</p><figure id="1578960f-d757-40fc-a415-507c76376f09" class="image"><a href="https://i.imgur.com/pSMfoz4.png"><img style="width:1056px" src="https://i.imgur.com/pSMfoz4.png"/></a></figure><p id="9ce03247-5c25-4b8c-9791-529ea15cf1d6" class="">The example above returns files that are larger than 100 MB. It is important to note that the “find” command tends to generate errors which sometimes makes the output hard to read. This is why it would be wise to use the “find” command with “-type f 2&gt;/dev/null” to redirect errors to “/dev/null” and have a cleaner output (below).</p><figure id="574db842-ffe9-4dca-bf3c-2548f0bc532a" class="image"><a href="https://i.imgur.com/UKYSdE3.png"><img style="width:1056px" src="https://i.imgur.com/UKYSdE3.png"/></a></figure><p id="eb6e264f-14eb-4a6c-95aa-4d61e7820101" class="">Folders and files that can be written to or executed from:</p><ul id="3752c15b-dc7e-4b0f-a4ac-56b34cd75872" class="bulleted-list"><li style="list-style-type:disc"><code>find / -writable -type d 2&gt;/dev/null</code> : Find world-writeable folders</li></ul><ul id="21a42c4d-4f4f-413d-9f74-0cd83f3bbde6" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -222 -type d 2&gt;/dev/null</code>: Find world-writeable folders</li></ul><ul id="52441839-9845-4da3-aedc-d4a4da134a8f" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -o w -type d 2&gt;/dev/null</code>: Find world-writeable folders</li></ul><p id="b7e590ff-310a-450d-8194-dd96a97708e0" class="">The reason we see three different “find” commands that could potentially lead to the same result can be seen in the manual document. As you can see below, the perm parameter affects the way “find” works.</p><figure id="c2284188-1b40-4f90-92b7-6777ad613498" class="image"><a href="https://i.imgur.com/qb0klHH.png"><img style="width:1056px" src="https://i.imgur.com/qb0klHH.png"/></a></figure><ul id="42d965b3-a48d-4a34-b745-c0284283f95a" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -o x -type d 2&gt;/dev/null</code> : Find world-executable folders</li></ul><p id="5abab248-ff60-4918-8627-f4d43609999d" class="">Find development tools and supported languages:</p><ul id="f84d080b-b32c-476e-95d4-a50c9b71a79b" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name perl*</code></li></ul><ul id="4b760374-9522-49c6-8b92-ba71f133df6e" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name python*</code></li></ul><ul id="5ba39bfd-7f63-437b-acc8-e37e912a2b1f" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name gcc*</code></li></ul><p id="d9e82ac5-3efc-48be-bb2c-8e993766fffb" class="">Find specific file permissions:</p><p id="46082dd8-598d-46c0-ac4a-9e3b8ceb3c73" class="">Below is a short example used to find files that have the SUID bit set. The SUID bit allows the file to run with the privilege level of the account that owns it, rather than the account which runs it. This allows for an interesting privilege escalation path,we will see in more details on task 6. The example below is given to complete the subject on the “find” command.</p><ul id="38f5da8d-31d2-4841-a89b-28e3482b814d" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -u=s -type f 2&gt;/dev/null</code>: Find files with the SUID bit, which allows us to run the file with a higher privilege level than the current user.</li></ul><h3 id="39598694-488a-431d-9357-b425f2d95cdc" class=""><strong>General Linux Commands</strong></h3><p id="41d85ca1-3188-4d06-a561-8df545691503" class="">As we are in the Linux realm, familiarity with Linux commands, in general, will be very useful. Please spend some time getting comfortable with commands such as <code>find</code>, <code>locate</code>, <code>grep</code>, <code>cut</code>, <code>sort</code>, etc.</p></details></li></ul><ul id="0f5be45a-f4ec-40e7-afe6-a55174b801d9" class="toggle"><li><details open=""><summary>Automated Enumeration Tools</summary><p id="b440b184-fb3d-4133-8f92-4e06baf732c1" class="">Several tools can help you save time during the enumeration process. These tools should only be used to save time knowing they may miss some privilege escalation vectors. Below is a list of popular Linux enumeration tools with links to their respective Github repositories.</p><p id="5a27b362-1e12-43f9-879f-32090c4fdd93" class="">The target system’s environment will influence the tool you will be able to use. For example, you will not be able to run a tool written in Python if it is not installed on the target system. This is why it would be better to be familiar with a few rather than having a single go-to tool.</p><ul id="1ef8e1f6-d8ad-4315-a4d4-36ace6c8eb3c" class="bulleted-list"><li style="list-style-type:disc"><strong>LinPeas</strong>: <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</a></li></ul><ul id="f84a917a-8846-4ecc-a02c-3adc3ce30f72" class="bulleted-list"><li style="list-style-type:disc"><strong>LinEnum: </strong><a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></li></ul><ul id="f200ec9b-db36-44df-b7a1-866d6eae20cc" class="bulleted-list"><li style="list-style-type:disc"><strong>LES (</strong><strong>Linux</strong><strong> Exploit Suggester): </strong><a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a></li></ul><ul id="38560203-20d8-4469-88e3-c1178afa4eee" class="bulleted-list"><li style="list-style-type:disc"><strong>Linux</strong><strong> Smart Enumeration: </strong><a href="https://github.com/diego-treitos/linux-smart-enumeration">https://github.com/diego-treitos/linux-smart-enumeration</a></li></ul><ul id="a0d0ddf5-2260-4220-8266-8860d78bdda2" class="bulleted-list"><li style="list-style-type:disc"><strong>Linux</strong><strong> Priv Checker:</strong> <a href="https://github.com/linted/linuxprivchecker">https://github.com/linted/linuxprivchecker</a></li></ul></details></li></ul><ul id="c9c2e722-6079-4dfe-bfb2-e7d9ad75a197" class="toggle"><li><details open=""><summary>Privilege Escalation: Kernel Exploits</summary><p id="ea916c44-b372-4549-ad17-54e1764cb68f" class="">Privilege escalation ideally leads to root privileges. This can sometimes be achieved simply by exploiting an existing vulnerability, or in some cases by accessing another user account that has more privileges, information, or access.</p><p id="35aa807e-4f0c-4704-beb3-8618407faeda" class="">Unless a single vulnerability leads to a root shell, the privilege escalation process will rely on misconfigurations and lax permissions.</p><p id="0e48525e-485b-463e-a2f8-e7b1de1b8453" class="">The kernel on Linux systems manages the communication between components such as the memory on the system and applications. This critical function requires the kernel to have specific privileges; thus, a successful exploit will potentially lead to root privileges.</p><p id="cd36e766-e80a-40ff-adb4-855bd4540700" class="">The Kernel exploit methodology is simple;</p><ol type="1" id="364a16ab-576f-4d70-b014-253f673da8a4" class="numbered-list" start="1"><li>Identify the kernel version</li></ol><ol type="1" id="b35b24cf-6c34-4944-9374-48dd37c872a8" class="numbered-list" start="2"><li>Search and find an exploit code for the kernel version of the target system</li></ol><ol type="1" id="5ada1064-3f23-42d4-ba0d-4abb07a68203" class="numbered-list" start="3"><li>Run the exploit</li></ol><p id="89a0afaa-241b-4168-84ce-1f29c1e56f68" class="">Although it looks simple, please remember that a failed kernel exploit can lead to a system crash. Make sure this potential outcome is acceptable within the scope of your penetration testing engagement before attempting a kernel exploit.</p><p id="2807d0f1-a2d1-4ed0-ad66-0a887c1d9630" class=""><strong>Research sources:</strong></p><ol type="1" id="4bc0609c-1176-40a5-95da-624718fc4e2b" class="numbered-list" start="1"><li>Based on your findings, you can use Google to search for an existing exploit code.</li></ol><ol type="1" id="4521e2f0-6df2-447b-a5cb-11b371e90a90" class="numbered-list" start="2"><li>Sources such as <a href="https://www.linuxkernelcves.com/cves">https://www.linuxkernelcves.com/cves</a> can also be useful.</li></ol><ol type="1" id="e94fe6ef-eea5-473f-afa4-4ac9877f38f9" class="numbered-list" start="3"><li>Another alternative would be to use a script like LES (Linux Exploit Suggester) but remember that these tools can generate false positives (report a kernel vulnerability that does not affect the target system) or false negatives (not report any kernel vulnerabilities although the kernel is vulnerable).</li></ol><p id="49483bf9-34b8-498f-a98d-1e6a8a6e65c8" class=""><strong>Hints/Notes:</strong></p><ol type="1" id="ea088fc3-3862-436a-a9a6-02aec08e9f50" class="numbered-list" start="1"><li>Being too specific about the kernel version when searching for exploits on Google, Exploit-db, or searchsploit</li></ol><ol type="1" id="adb3b8d4-1f75-4dfd-a3cf-b20b47202a93" class="numbered-list" start="2"><li>Be sure you understand how the exploit code works BEFORE you launch it. Some exploit codes can make changes on the operating system that would make them unsecured in further use or make irreversible changes to the system, creating problems later. Of course, these may not be great concerns within a lab or CTF environment, but these are absolute no-nos during a real penetration testing engagement.</li></ol><ol type="1" id="2334fdca-cde0-48e4-9a27-a0408368300f" class="numbered-list" start="3"><li>Some exploits may require further interaction once they are run. Read all comments and instructions provided with the exploit code.</li></ol><ol type="1" id="b2058e7d-6fa2-43b0-b3cc-7ef3e2f3274b" class="numbered-list" start="4"><li>You can transfer the exploit code from your machine to the target system using the <code>SimpleHTTPServer</code> Python module and <code>wget</code> respectively.</li></ol></details></li></ul><ul id="18f1cead-ce8b-43d6-ab69-2fcdd0cfb7d3" class="toggle"><li><details open=""><summary>Privilege Escalation: Sudo</summary><p id="1fa2c7a2-4e8d-40b0-9d82-f4dd98c5cf5e" class="">The sudo command, by default, allows you to run a program with root privileges. Under some conditions, system administrators may need to give regular users some flexibility on their privileges. For example, a junior SOC analyst may need to use Nmap regularly but would not be cleared for full root access. In this situation, the system administrator can allow this user to only run Nmap with root privileges while keeping its regular privilege level throughout the rest of the system.</p><p id="d107bea5-0fc6-4339-a28e-f3a15dcfea88" class="">Any user can check its current situation related to root privileges using the <code>sudo -l</code> command.</p><p id="7866da11-8b13-4fd1-934f-d50584c2e725" class=""><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a> is a valuable source that provides information on how any program, on which you may have sudo rights, can be used.</p><p id="bcbeb9f4-167f-456a-ad08-cf61e83706a3" class=""><strong>Leverage application functions</strong></p><p id="fed8852c-cd9b-403d-972d-91b004b3047e" class="">Some applications will not have a known exploit within this context. Such an application you may see is the Apache2 server.</p><p id="065e9304-b663-4472-82d4-c2b8095ac05d" class="">In this case, we can use a &quot;hack&quot; to leak information leveraging a function of the application. As you can see below, Apache2 has an option that supports loading alternative configuration files (<code>-f</code> : specify an alternate ServerConfigFile).</p><figure id="ab235dd3-f498-48e0-b693-7fd7b3967998" class="image"><a href="https://i.imgur.com/rNpbbL8.png"><img src="https://i.imgur.com/rNpbbL8.png"/></a></figure><p id="3d3c9752-cd31-4d75-bdb6-c6c920959f58" class="">Loading the <code>/etc/shadow</code> file using this option will result in an error message that includes the first line of the <code>/etc/shadow</code> file.</p><p id="38360294-dfea-4b2b-b60c-6a36eeff77e6" class=""><strong>Leverage LD_PRELOAD</strong></p><p id="9343580b-7ca2-42ea-86f5-299e45ef77fe" class="">On some systems, you may see the LD_PRELOAD environment option.</p><figure id="6f0cb976-c1ca-4344-b17a-19ca09106003" class="image"><a href="https://i.imgur.com/gGstS69.png"><img src="https://i.imgur.com/gGstS69.png"/></a></figure><p id="2c468db9-9568-4117-8795-a98d2624b450" class="">LD_PRELOAD is a function that allows any program to use shared libraries. This <a href="https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/">blog post</a> will give you an idea about the capabilities of LD_PRELOAD. If the &quot;env_keep&quot; option is enabled we can generate a shared library which will be loaded and executed before the program is run. Please note the LD_PRELOAD option will be ignored if the real user ID is different from the effective user ID.</p><p id="bae13daa-7bd4-4200-93ce-1d6d346acd46" class="">The steps of this privilege escalation vector can be summarized as follows;</p><ol type="1" id="159eefbf-dde6-49d3-a448-1a70bc26c987" class="numbered-list" start="1"><li>Check for LD_PRELOAD (with the env_keep option)</li></ol><ol type="1" id="d477f765-4dbc-4af5-ad73-aa838abcb8d6" class="numbered-list" start="2"><li>Write a simple C code compiled as a share object (.so extension) file</li></ol><ol type="1" id="5a7ce8df-6551-47e2-8f3d-8c3a5c644c66" class="numbered-list" start="3"><li>Run the program with sudo rights and the LD_PRELOAD option pointing to our .so file</li></ol><p id="ee808469-7106-4a1f-a7d5-c8cd8ada2d9e" class="">The C code will simply spawn a root shell and can be written as follows;</p><p id="1c3e3abf-d9fd-4bb2-94f3-2ae75557e83b" class="">#include &lt;stdio.h&gt;</p><p id="a8bc67cc-6443-48b4-858e-2a20171d9a28" class="">#include &lt;sys/types.h&gt;</p><p id="38fb4cd4-797e-4851-99ee-0b996f159746" class="">#include &lt;stdlib.h&gt;</p><p id="f50c5277-ad83-4cfe-a2d4-b6b2428f4edf" class="">void _init() {</p><p id="4dc88a43-f9e1-466c-b7ea-0b83c012e801" class="">unsetenv(&quot;LD_PRELOAD&quot;);</p><p id="aacb073d-8113-4889-9b51-d8b07876dd62" class="">setgid(0);</p><p id="1c805dac-2b12-4e16-a23f-81fe23287248" class="">setuid(0);</p><p id="110adc36-ef94-4de8-8f48-a8348f4a1583" class="">system(&quot;/bin/bash&quot;);</p><p id="511252eb-dfba-456d-905f-99356b5c6878" class="">}</p><p id="47b6a489-7f77-4433-b097-7607c69ac36c" class="">We can save this code as shell.c and compile it using gcc into a shared object file using the following parameters;</p><p id="abc98ebb-bb7d-4b92-a72f-dae061b8ad7e" class=""><code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code></p><figure id="f5799145-a15e-4a2f-8941-52f82bdbd413" class="image"><a href="https://i.imgur.com/HxbszMW.png"><img src="https://i.imgur.com/HxbszMW.png"/></a></figure><p id="1d2eea58-7b92-4980-9ee7-454031a5f60f" class="">We can now use this shared object file when launching any program our user can run with sudo. In our case, Apache2, find, or almost any of the programs we can run with sudo can be used.</p><p id="6aef8b3b-0182-405b-93ac-00a36d949c16" class="">We need to run the program by specifying the LD_PRELOAD option, as follows;</p><p id="4b12bead-4a8c-45f5-b0f8-a96a64240601" class=""><code>sudo LD_PRELOAD=/home/user/ldpreload/shell.so find</code></p><p id="8e956c88-d8da-4fc8-9991-1f2f9995626c" class="">This will result in a shell spawn with root privileges.</p><figure id="7d18d75b-dbb3-4893-8cda-6dbf86290ce6" class="image"><a href="https://i.imgur.com/1YwARyZ.png"><img src="https://i.imgur.com/1YwARyZ.png"/></a></figure></details></li></ul><ul id="13ca5f84-0e76-467d-8d38-4f8e512bc7a9" class="toggle"><li><details open=""><summary>Privilege Escalation: SUID</summary><p id="fb36b6f2-0816-4ab6-8d60-636d780a5bed" class="">Much of Linux privilege controls rely on controlling the users and files interactions. This is done with permissions. By now, you know that files can have read, write, and execute permissions. These are given to users within their privilege levels. This changes with SUID (Set-user Identification) and SGID (Set-group Identification). These allow files to be executed with the permission level of the file owner or the group owner, respectively.</p><p id="d79d10bb-6a05-496a-be64-db343ecd5ac4" class="">You will notice these files have an “s” bit set showing their special permission level.</p><p id="0bfc6f4e-e76f-450a-a9c9-34071c00b00f" class=""><code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code> will list files that have SUID or SGID bits set.</p><figure id="47b08818-ef9b-4e00-8e1a-85e8d812e85e" class="image"><a href="https://i.imgur.com/fJEeZ4m.png"><img src="https://i.imgur.com/fJEeZ4m.png"/></a></figure><p id="ba02ec73-24b0-437f-b1fb-e23ab9ef3166" class="">A good practice would be to compare executables on this list with GTFOBins (<a href="https://gtfobins.github.io/">https://gtfobins.github.io</a>). Clicking on the SUID button will filter binaries known to be exploitable when the SUID bit is set (you can also use this link for a pre-filtered list <a href="https://gtfobins.github.io/#+suid">https://gtfobins.github.io/#+suid</a>).</p><p id="f41bc0af-6e6f-4fe8-af54-37f8d0f8eea8" class="">The list above shows that nano has the SUID bit set. Unfortunately, GTFObins does not provide us with an easy win. Typical to real-life privilege escalation scenarios, we will need to find intermediate steps that will help us leverage whatever minuscule finding we have.</p><figure id="8c6f272f-de81-413a-acac-418161cb3d25" class="image"><a href="https://i.imgur.com/rSRTn5v.png"><img src="https://i.imgur.com/rSRTn5v.png"/></a></figure><p id="0a335bda-0db6-4ef3-8e40-b697603c945c" class="">The SUID bit set for the nano text editor allows us to create, edit and read files using the file owner’s privilege. Nano is owned by root, which probably means that we can read and edit files at a higher privilege level than our current user has. At this stage, we have two basic options for privilege escalation: reading the <code>/etc/shadow</code> file or adding our user to <code>/etc/passwd</code>.</p><p id="f5987c0e-ad26-4cb8-a74f-caa6dc31a4b2" class="">Below are simple steps using both vectors.</p><p id="007f79f6-917c-4808-aa40-2f6968c3cfb1" class="">reading the <code>/etc/shadow</code> file</p><p id="7dc37c3e-9613-4194-b6d1-d8de69aa8a73" class="">We see that the nano text editor has the SUID bit set by running the <code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code> command.</p><p id="9a5c3a07-4f6f-4a4d-b5d4-e508290f1e03" class=""><code>nano /etc/shadow</code> will print the contents of the <code>/etc/shadow</code> file. We can now use the unshadow tool to create a file crackable by John the Ripper. To achieve this, unshadow needs both the <code>/etc/shadow</code> and <code>/etc/passwd</code> files.</p><figure id="cd3a409b-e623-446f-a470-becb176e79e3" class="image"><a href="https://i.imgur.com/DAWxbJD.png"><img src="https://i.imgur.com/DAWxbJD.png"/></a></figure><p id="c10dbc2d-2306-4a11-b18e-a8bd4f16c719" class="">The unshadow tool’s usage can be seen below;</p><p id="1c9755e3-1860-46cb-b088-a6b8c19356ab" class=""><code>unshadow passwd.txt shadow.txt &gt; passwords.txt</code></p><figure id="c8f71483-8896-4e5b-9493-50bfc12e900b" class="image"><a href="https://i.imgur.com/6cHBAr1.png"><img src="https://i.imgur.com/6cHBAr1.png"/></a></figure><p id="1ba1c87e-883d-48bd-86b2-c2eea973b48a" class="">With the correct wordlist and a little luck, John the Ripper can return one or several passwords in cleartext. For a more detailed room on John the Ripper, you can visit <a href="https://tryhackme.com/room/johntheripper0">https://tryhackme.com/room/johntheripper0</a></p><p id="65a327e9-7066-4f90-ba86-7e21ee165e34" class="">The other option would be to add a new user that has root privileges. This would help us circumvent the tedious process of password cracking. Below is an easy way to do it:</p><p id="98a84e39-8b25-481e-8b6a-38347112811e" class="">We will need the hash value of the password we want the new user to have. This can be done quickly using the openssl tool on Kali Linux.</p><figure id="5a3464e1-2c5b-457c-8cd9-f549f2013bd2" class="image"><a href="https://i.imgur.com/bkOGaHY.png"><img src="https://i.imgur.com/bkOGaHY.png"/></a></figure><p id="568a3744-0f0a-457e-ae9f-9b385c744407" class="">We will then add this password with a username to the <code>/etc/passwd</code> file.</p><figure id="f6ff9608-3011-4631-a90c-500330977d11" class="image"><a href="https://i.imgur.com/huGoEtj.png"><img src="https://i.imgur.com/huGoEtj.png"/></a></figure><p id="084b05c4-8d6a-49c2-a323-cac7b2aa27e6" class="">Once our user is added (please note how <code>root:/bin/bash</code> was used to provide a root shell) we will need to switch to this user and hopefully should have root privileges.</p><figure id="e08c4485-31cb-447b-81b0-6f816dda24d9" class="image"><a href="https://i.imgur.com/HZcWGhi.png"><img src="https://i.imgur.com/HZcWGhi.png"/></a></figure></details></li></ul><ul id="367c98c4-8606-43c3-995d-349d2e733925" class="toggle"><li><details open=""><summary>Privilege Escalation: Capabilities</summary><p id="4af42b20-2adf-47a6-8d73-97853c261c3c" class="">Another method system administrators can use to increase the privilege level of a process or binary is “Capabilities”. Capabilities help manage privileges at a more granular level. For example, if the SOC analyst needs to use a tool that needs to initiate socket connections, a regular user would not be able to do that. If the system administrator does not want to give this user higher privileges, they can change the capabilities of the binary. As a result, the binary would get through its task without needing a higher privilege user.</p><p id="b7500beb-ec26-4e2c-a13e-53174008673e" class="">The capabilities man page provides detailed information on its usage and options.</p><p id="9c2519cf-aef7-4736-b936-7adc8c4db28b" class="">We can use the <code>getcap</code> tool to list enabled capabilities.</p><figure id="9a5b0c90-2451-4207-9205-82aaf1f68ae8" class="image"><a href="https://i.imgur.com/Q6XYr0p.png"><img src="https://i.imgur.com/Q6XYr0p.png"/></a></figure><p id="96521de9-a7df-4555-8cfd-8c74d2840ea8" class="">When run as an unprivileged user, <code>getcap -r /</code> will generate a huge amount of errors, so it is good practice to redirect the error messages to /dev/null.</p><p id="30ea31a7-64b4-44b5-a990-06fe9643eb99" class="">Please note that neither vim nor its copy has the SUID bit set. This privilege escalation vector is therefore not discoverable when enumerating files looking for SUID.</p><figure id="6bc59c4b-96a2-4b37-b2fd-1593e6916f07" class="image"><a href="https://i.imgur.com/6csoabB.png"><img src="https://i.imgur.com/6csoabB.png"/></a></figure><p id="ee4e3f7a-f26e-44cb-8fbc-7827225f0fc2" class="">GTFObins has a good list of binaries that can be leveraged for privilege escalation if we find any set capabilities.</p><p id="d7e7dccb-c28b-4f59-afc4-d8e313cda7e6" class="">We notice that vim can be used with the following command and payload:</p><figure id="aa4098e8-0882-4af0-a38f-3209c5f88f23" class="image"><a href="https://i.imgur.com/nlpCMWj.png"><img src="https://i.imgur.com/nlpCMWj.png"/></a></figure><p id="b61415c9-8942-4784-9e28-5dfced135e5c" class="">This will launch a root shell as seen below;</p><figure id="96d1c0ed-58df-4cc0-ae77-aba3b094b07b" class="image"><a href="https://i.imgur.com/jCjvgo3.png"><img src="https://i.imgur.com/jCjvgo3.png"/></a></figure></details></li></ul><ul id="5881c807-2024-40bb-bdbb-79d4eb52e9a8" class="toggle"><li><details open=""><summary>Privilege Escalation: Cron Jobs</summary><p id="bd0552ed-fe34-4e55-a554-834b6310428c" class="">Cron jobs are used to run scripts or binaries at specific times. By default, they run with the privilege of their owners and not the current user. While properly configured cron jobs are not inherently vulnerable, they can provide a privilege escalation vector under some conditions.</p><p id="8f8b73f2-7970-4daa-a6a2-ca2b018d34bf" class="">The idea is quite simple; if there is a scheduled task that runs with root privileges and we can change the script that will be run, then our script will run with root privileges.</p><p id="faa9b8a8-bf34-4a69-a287-04b5f54a5696" class="">Cron job configurations are stored as crontabs (cron tables) to see the next time and date the task will run.</p><p id="fb6b593f-dd49-499b-9baa-1634a793b1e0" class="">Each user on the system have their crontab file and can run specific tasks whether they are logged in or not. As you can expect, our goal will be to find a cron job set by root and have it run our script, ideally a shell.</p><p id="22ba59a6-8abe-4f86-b614-d97c7872572a" class="">Any user can read the file keeping system-wide cron jobs under <code>/etc/crontab</code></p><p id="a5f1cb5b-eccc-45d3-919d-0ad9722e3fb7" class="">While CTF machines can have cron jobs running every minute or every 5 minutes, you will more often see tasks that run daily, weekly or monthly in penetration test engagements.</p><figure id="7c6624a9-b67c-4b87-bce0-118877699220" class="image"><a href="https://i.imgur.com/fwqPuHN.png"><img src="https://i.imgur.com/fwqPuHN.png"/></a></figure><p id="8cf19a31-2de1-498a-a9ae-90ef17f31fd5" class="">You can see the <code>backup.sh</code> script was configured to run every minute. The content of the file shows a simple script that creates a backup of the prices.xls file.</p><figure id="19042b5b-b6b8-4f0c-9aed-d0c3f7512422" class="image"><a href="https://i.imgur.com/qlDj93R.png"><img src="https://i.imgur.com/qlDj93R.png"/></a></figure><p id="162673c7-b179-48b2-b385-1f210715656c" class="">As our current user can access this script, we can easily modify it to create a reverse shell, hopefully with root privileges.</p><p id="35f214e1-a1c4-4603-92b2-08a8cd09d3a4" class="">The script will use the tools available on the target system to launch a reverse shell.</p><p id="55553c90-dccd-4892-8107-219ba63b0e79" class="">Two points to note;</p><ol type="1" id="3ffeed1f-a4c1-4469-9dd6-3f68bdaee64b" class="numbered-list" start="1"><li>The command syntax will vary depending on the available tools. (e.g. <code>nc</code> will probably not support the <code>e</code> option you may have seen used in other cases)</li></ol><ol type="1" id="bacd6633-e395-48a7-a47d-d22095d4c938" class="numbered-list" start="2"><li>We should always prefer to start reverse shells, as we not want to compromise the system integrity during a real penetration testing engagement.</li></ol><p id="53e2b3c7-1376-4daa-b5e3-00e29f7bd46d" class="">The file should look like this;</p><figure id="efcb90d6-ecc6-4f2b-9f61-04dded7fa7fe" class="image"><a href="https://i.imgur.com/579yg6H.png"><img src="https://i.imgur.com/579yg6H.png"/></a></figure><p id="c1267b9e-c7d6-47c9-b9d7-17391f35325e" class="">We will now run a listener on our attacking machine to receive the incoming connection.</p><figure id="de143fb9-9b61-4518-983c-c9f1f954361b" class="image"><a href="https://i.imgur.com/xwYXfY1.png"><img src="https://i.imgur.com/xwYXfY1.png"/></a></figure><p id="d58c83ea-2737-4a13-b0f4-1f2b4a730b70" class="">Crontab is always worth checking as it can sometimes lead to easy privilege escalation vectors. The following scenario is not uncommon in companies that do not have a certain cyber security maturity level:</p><ol type="1" id="b755f411-1b77-4141-8809-eb6b83ed2203" class="numbered-list" start="1"><li>System administrators need to run a script at regular intervals.</li></ol><ol type="1" id="4dee2c10-b811-4774-b334-cd683f8b2592" class="numbered-list" start="2"><li>They create a cron job to do this</li></ol><ol type="1" id="b3997afa-b0cd-4fd2-81dc-a421f25582c7" class="numbered-list" start="3"><li>After a while, the script becomes useless, and they delete it</li></ol><ol type="1" id="b2846269-357d-4b25-9068-d8d8100ac9ee" class="numbered-list" start="4"><li>They do not clean the relevant cron job</li></ol><p id="307b8234-0f13-4ce6-8ec4-b9aef6b43e6c" class="">This change management issue leads to a potential exploit leveraging cron jobs.</p><figure id="82016cf9-98dd-4a14-840a-d950b80e02dd" class="image"><a href="https://i.imgur.com/SovymJL.png"><img src="https://i.imgur.com/SovymJL.png"/></a></figure><p id="114f5caa-afbe-4e0a-af0c-6f2ffc7887fd" class="">The example above shows a similar situation where the antivirus.sh script was deleted, but the cron job still exists.</p><p id="3f3910a2-c7ed-4c09-80ca-b09ca5b30437" class="">If the full path of the script is not defined (as it was done for the backup.sh script), cron will refer to the paths listed under the PATH variable in the /etc/crontab file. In this case, we should be able to create a script named “antivirus.sh” under our user’s home folder and it should be run by the cron job.</p><p id="93b13476-be6c-47ed-9af7-43d7f2d92c11" class="">The file on the target system should look familiar:</p><figure id="3dbd115c-1200-43bf-bace-d256490be7a3" class="image"><a href="https://i.imgur.com/SHknR87.png"><img src="https://i.imgur.com/SHknR87.png"/></a></figure><p id="90424264-cb1d-4e21-a381-9d58a28a4f2f" class="">The incoming reverse shell connection has root privileges:</p><figure id="6ff57297-cd92-4bb6-9044-109c61bd0e58" class="image"><a href="https://i.imgur.com/EBCue17.png"><img src="https://i.imgur.com/EBCue17.png"/></a></figure><p id="77d41a4f-d3e3-4cc5-aaac-f64780d19422" class="">In the odd event you find an existing script or task attached to a cron job, it is always worth spending time to understand the function of the script and how any tool is used within the context. For example, tar, 7z, rsync, etc., can be exploited using their wildcard feature.</p></details></li></ul><ul id="3e7b9046-cda0-49f6-bf12-47dd0a74fc79" class="toggle"><li><details open=""><summary>Privilege Escalation: PATH</summary><p id="2792b7b0-6149-4c80-87de-1d93c9ffe318" class="">If a folder for which your user has write permission is located in the path, you could potentially hijack an application to run a script. PATH in Linux is an environmental variable that tells the operating system where to search for executables. For any command that is not built into the shell or that is not defined with an absolute path, Linux will start searching in folders defined under PATH. (PATH is the environmental variable we&#x27;re talking about here, path is the location of a file).</p><p id="02e4e79c-a441-451b-8e5d-6a163728c4dd" class="">Typically the PATH will look like this:</p><figure id="8e3d5b98-7ff7-4ca0-8772-ca76b2d362bd" class="image"><a href="https://i.imgur.com/ch2Z4zp.png"><img src="https://i.imgur.com/ch2Z4zp.png"/></a></figure><p id="bb52594f-538c-455a-86b6-b0b6419a4c6c" class="">If we type “thm” to the command line, these are the locations Linux will look in for an executable called thm. The scenario below will give you a better idea of how this can be leveraged to increase our privilege level. As you will see, this depends entirely on the existing configuration of the target system, so be sure you can answer the questions below before trying this.</p><ol type="1" id="4534309e-83cd-465e-a62a-cdb7f8c1b17c" class="numbered-list" start="1"><li>What folders are located under $PATH</li></ol><ol type="1" id="318ac6c6-7a74-417b-9c32-d6fbe5f35869" class="numbered-list" start="2"><li>Does your current user have write privileges for any of these folders?</li></ol><ol type="1" id="64dcc0d1-a819-4172-b017-f64577889108" class="numbered-list" start="3"><li>Can you modify $PATH?</li></ol><ol type="1" id="0919380d-ef78-4148-8d13-8787119bae60" class="numbered-list" start="4"><li>Is there a script/application you can start that will be affected by this vulnerability?</li></ol><p id="d71d9808-388a-4bdc-8f28-c62e786c9cc3" class="">For demo purposes, we will use the script below:</p><figure id="32bd0090-8334-4aad-b7cb-5725fa3198ea" class="image"><a href="https://i.imgur.com/qX7m2Jq.png"><img src="https://i.imgur.com/qX7m2Jq.png"/></a></figure><p id="0e5db320-7eac-46e5-b073-639a9346e0b7" class="">This script tries to launch a system binary called “thm” but the example can easily be replicated with any binary.</p><p id="e563f303-8575-4783-896b-18298d38edc9" class="">We compile this into an executable and set the SUID bit.</p><figure id="4e496182-c201-4bba-9512-3e797411e2dd" class="image"><a href="https://i.imgur.com/A6QQ65I.png"><img src="https://i.imgur.com/A6QQ65I.png"/></a></figure><p id="8a562b13-e512-4e5a-a0b0-469fa328e6ed" class="">Our user now has access to the “path” script with SUID bit set.</p><figure id="744babf5-65c8-475a-9dbe-b6553c556470" class="image"><a href="https://i.imgur.com/Af1RpuY.png"><img src="https://i.imgur.com/Af1RpuY.png"/></a></figure><p id="06050fac-82ee-479e-956b-1ba821f27537" class="">Once executed “path” will look for an executable named “thm” inside folders listed under PATH.</p><p id="05ccd42d-3f83-4864-9ce3-fefde2a86d32" class="">If any writable folder is listed under PATH we could create a binary named thm under that directory and have our “path” script run it. As the SUID bit is set, this binary will run with root privilege</p><p id="5e6994f2-4924-4050-8fac-2280ad3ffc57" class="">A simple search for writable folders can done using the “<code>find / -writable 2&gt;/dev/null</code>” command. The output of this command can be cleaned using a simple cut and sort sequence.</p><figure id="37025276-77fb-4671-beb0-a474351e8a0b" class="image"><a href="https://i.imgur.com/7UekB3t.png"><img src="https://i.imgur.com/7UekB3t.png"/></a></figure><p id="490b7010-c558-4f94-b879-690de8120a6b" class="">Some CTF scenarios can present different folders but a regular system would output something like we see above.</p><p id="dfe9ff72-fb36-4937-bce5-2c4ae5587c33" class="">Comparing this with PATH will help us find folders we could use.</p><figure id="e8896a42-c17a-410c-8a3e-28481750a3e8" class="image"><a href="https://i.imgur.com/67mdmmG.png"><img src="https://i.imgur.com/67mdmmG.png"/></a></figure><p id="0e84831a-ecbf-4461-9d01-0a500c681c6f" class="">We see a number of folders under /usr, thus it could be easier to run our writable folder search once more to cover subfolders.</p><figure id="b8f2ea6f-8497-4d14-aaf7-c0f4b7f51450" class="image"><a href="https://i.imgur.com/Y3pDsrL.png"><img src="https://i.imgur.com/Y3pDsrL.png"/></a></figure><p id="2073e0d8-a178-4b52-8918-1256fc29ddac" class="">An alternative could be the command below.</p><p id="3de93a69-d182-414d-8ad1-390d7dbca32f" class=""><code>find / -writable 2&gt;/dev/null | cut -d &quot;/&quot; -f 2,3 | grep -v proc | sort -u</code></p><p id="7143da70-8b0e-4244-b8d4-45a3c9c7d77d" class="">We have added “grep -v proc” to get rid of the many results related to running processes.</p><p id="4a76b6b7-7f6c-41d0-9777-7be776251dd5" class="">Unfortunately, subfolders under /usr are not writable</p><p id="80c2cf6e-c04b-41b3-b12e-2057d9d07c7a" class="">The folder that will be easier to write to is probably /tmp. At this point because /tmp is not present in PATH so we will need to add it. As we can see below, the “<code>export PATH=/tmp:$PATH</code>” command accomplishes this.</p><figure id="256522b2-b8e4-4577-9536-683a2d8881af" class="image"><a href="https://i.imgur.com/u1PM8ZD.png"><img src="https://i.imgur.com/u1PM8ZD.png"/></a></figure><p id="a549f778-9c11-4fbb-a6bd-d28616d66fda" class="">At this point the path script will also look under the /tmp folder for an executable named “thm”.</p><p id="0306989c-ae08-42bf-a6d6-0978b5979cbc" class="">Creating this command is fairly easy by copying /bin/bash as “thm” under the /tmp folder.</p><figure id="b5444e8c-b311-4eda-ba70-d214004994e0" class="image"><a href="https://i.imgur.com/7UdrEnd.png"><img src="https://i.imgur.com/7UdrEnd.png"/></a></figure><p id="f49abd83-3ea8-4f80-80ec-bba027b19c2f" class="">We have given executable rights to our copy of /bin/bash, please note that at this point it will run with our user’s right. What makes a privilege escalation possible within this context is that the path script runs with root privileges.</p><figure id="46384661-7f62-482e-bfe1-3173cd549330" class="image"><a href="https://i.imgur.com/MlBJ8kb.png"><img src="https://i.imgur.com/MlBJ8kb.png"/></a></figure></details></li></ul><ul id="071889d3-10ca-4632-ae46-c5b4f23d491b" class="toggle"><li><details open=""><summary>Privilege Escalation: NFS</summary><p id="c11e99d2-45d0-43f7-9846-7d9894ad7bfc" class="">Privilege escalation vectors are not confined to internal access. Shared folders and remote management interfaces such as SSH and Telnet can also help you gain root access on the target system. Some cases will also require using both vectors, e.g. finding a root SSH private key on the target system and connecting via SSH with root privileges instead of trying to increase your current user’s privilege level.</p><p id="caa5356d-0c71-49c8-aad7-637d092dbed9" class="">Another vector that is more relevant to CTFs and exams is a misconfigured network shell. This vector can sometimes be seen during penetration testing engagements when a network backup system is present.</p><p id="e17d57fb-1842-4d9b-9be5-4af5e5013aa1" class="">NFS (Network File Sharing) configuration is kept in the /etc/exports file. This file is created during the NFS server installation and can usually be read by users.</p><figure id="788f1717-518d-4ab9-a20e-c5b629a3c78e" class="image"><a href="https://i.imgur.com/irDQTze.png"><img src="https://i.imgur.com/irDQTze.png"/></a></figure><p id="63223bad-3a9a-4518-89b6-b8e122518c2f" class="">The critical element for this privilege escalation vector is the “no_root_squash” option you can see above. By default, NFS will change the root user to nfsnobody and strip any file from operating with root privileges. If the “no_root_squash” option is present on a writable share, we can create an executable with SUID bit set and run it on the target system.</p><p id="1c1fab20-68ea-4b07-8ea2-7e7ab301bfac" class="">We will start by enumerating mountable shares from our attacking machine.</p><figure id="b25f064a-bb05-4b7e-9610-4724bfc3dea6" class="image"><a href="https://i.imgur.com/CmXPDcv.png"><img src="https://i.imgur.com/CmXPDcv.png"/></a></figure><p id="600489f9-eecf-4837-9cb0-03dcde7a3f36" class="">We will mount one of the “no_root_squash” shares to our attacking machine and start building our executable.</p><figure id="b4963cf4-7406-4c55-ad0e-0007e3069e36" class="image"><a href="https://i.imgur.com/DwAB1qs.png"><img src="https://i.imgur.com/DwAB1qs.png"/></a></figure><p id="10c0f744-1e6c-42ea-ab2c-09db47164b92" class="">As we can set SUID bits, a simple executable that will run /bin/bash on the target system will do the job.</p><figure id="52ebe866-f500-40da-9241-a0750dace80d" class="image"><a href="https://i.imgur.com/nWKpFkK.png"><img src="https://i.imgur.com/nWKpFkK.png"/></a></figure><p id="5ab8319b-329f-4dab-858f-87443ff44dbd" class="">Once we compile the code we will set the SUID bit.</p><figure id="f13419e0-70d6-4ad2-aaad-ba2c9f7a6800" class="image"><a href="https://i.imgur.com/rkZOOjZ.png"><img src="https://i.imgur.com/rkZOOjZ.png"/></a></figure><p id="56cec940-199f-4ab4-8f24-cca2affa44bd" class="">You will see below that both files (nfs.c and nfs are present on the target system. We have worked on the mounted share so there was no need to transfer them).</p><figure id="2f319a0b-22a6-4048-ad37-bdef360cfb21" class="image"><a href="https://i.imgur.com/U7IjT38.png"><img src="https://i.imgur.com/U7IjT38.png"/></a></figure><p id="1289e83a-7c33-4260-8f61-1aa622a9b813" class="">Notice the nfs executable has the SUID bit set on the target system and runs with root privileges.</p></details></li></ul><ul id="da5615fe-026e-48a8-84a5-6d6dadeda5b7" class="toggle"><li><details open=""><summary></summary></details></li></ul><p id="b4e279ce-6ff9-4acf-b1f4-281f63aadd10" class="">
</p></div></article></body></html>
